# Railway Deployment Environment Variables
# Copy these variables to your Railway project
# Replace placeholder values with your actual values

# =============================================================================
# SUPABASE CONFIGURATION (CRITICAL - REQUIRED FOR ALL SERVICES)
# =============================================================================

# Supabase Project URL
SUPABASE_URL=https://qpqhuqqmkjxsltzshfam.supabase.co

# Supabase Anonymous Key (Public Key)
SUPABASE_ANON_KEY=your_supabase_anon_key_here

# Supabase Service Role Key (Private Key)
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key_here

# Supabase JWT Secret
SUPABASE_JWT_SECRET=your_supabase_jwt_secret_here

# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================

# Environment type
ENV=production
ENVIRONMENT=production

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log level (debug, info, warn, error)
LOG_LEVEL=info

# Log format (json, text)
LOG_FORMAT=json

# =============================================================================
# CORS CONFIGURATION (FOR API GATEWAY)
# =============================================================================

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=*

# CORS allowed methods
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS

# CORS allowed headers
CORS_ALLOWED_HEADERS=*

# CORS allow credentials
CORS_ALLOW_CREDENTIALS=true

# CORS max age
CORS_MAX_AGE=86400

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================

# Enable rate limiting
RATE_LIMIT_ENABLED=true

# Requests per window
RATE_LIMIT_REQUESTS_PER=100

# Window size in seconds
RATE_LIMIT_WINDOW_SIZE=60

# Burst size
RATE_LIMIT_BURST_SIZE=200

# =============================================================================
# SERVICE-SPECIFIC CONFIGURATION
# =============================================================================

# API Gateway Service
PORT=8080
CLASSIFICATION_SERVICE_URL=https://classification-service-production.up.railway.app
MERCHANT_SERVICE_URL=https://merchant-service-production.up.railway.app
FRONTEND_URL=https://frontend-service-production-b225.up.railway.app

# Classification Service
PORT=8081

# Merchant Service
PORT=8082

# Monitoring Service
PORT=8084

# Pipeline Service
PORT=8085

# Frontend Service
PORT=8086

# Service Discovery
PORT=8086

# Business Intelligence Service
PORT=8087

# =============================================================================
# AUTHENTICATION CONFIGURATION
# =============================================================================

# JWT Secret (use a strong secret in production)
JWT_SECRET=your_jwt_secret_here

# JWT Expiration
JWT_EXPIRATION=24h

# Refresh token expiration
REFRESH_EXPIRATION=168h

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Database provider
PROVIDER_DATABASE=supabase
PROVIDER_AUTH=supabase
PROVIDER_CACHE=supabase
PROVIDER_STORAGE=supabase

# Database connection settings
DB_DRIVER=postgres
DB_HOST=db.qpqhuqqmkjxsltzshfam.supabase.co
DB_PORT=5432
DB_USERNAME=postgres
DB_PASSWORD=your_supabase_db_password_here
DB_DATABASE=postgres
DB_SSL_MODE=require
DB_MAX_OPEN_CONNS=10
DB_MAX_IDLE_CONNS=2
DB_CONN_MAX_LIFETIME=5m
DB_AUTO_MIGRATE=true

# Database URL (PostgreSQL connection string)
# Format: postgresql://[username]:[password]@[host]:[port]/[database]?sslmode=[ssl_mode]
# 
# SECURITY WARNING: Never commit actual passwords to version control!
# This file should be in .gitignore or use Railway's secret variables.
# 
# To set the DATABASE_URL:
# 1. Get connection string from: Supabase Dashboard > Project Settings > Database > Connection String (URI format)
# 2. Set as Railway secret variable: railway variables set DATABASE_URL="postgresql://..."
# 3. Or use environment variable: export DATABASE_URL="postgresql://postgres:[PASSWORD]@db.qpqhuqqmkjxsltzshfam.supabase.co:5432/postgres"
#
# For local development, create a .env.local file (gitignored) with:
# DATABASE_URL=postgresql://postgres:[YOUR_PASSWORD]@db.qpqhuqqmkjxsltzshfam.supabase.co:5432/postgres
export DATABASE_URL="${DATABASE_URL:-postgresql://postgres:[YOUR_PASSWORD_HERE]@db.qpqhuqqmkjxsltzshfam.supabase.co:5432/postgres}"

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# Server host
HOST=0.0.0.0

# Server timeouts
READ_TIMEOUT=30s
WRITE_TIMEOUT=30s
IDLE_TIMEOUT=60s

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Core features
FEATURE_BUSINESS_CLASSIFICATION=true
FEATURE_RISK_ASSESSMENT=true
FEATURE_COMPLIANCE_FRAMEWORK=true
FEATURE_ADVANCED_ANALYTICS=true
FEATURE_REAL_TIME_MONITORING=true
FEATURE_BATCH_PROCESSING=true
FEATURE_API_KEY_MANAGEMENT=true
FEATURE_WEBHOOK_SUPPORT=true
FEATURE_EXPORT_FUNCTIONALITY=true

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================

# Cache enabled
CACHE_ENABLED=true

# Cache TTL
CACHE_TTL=5m

# Cache max entries
CACHE_MAX_ENTRIES=10000

# Classification cache
CLASSIFICATION_CACHE_ENABLED=true
CLASSIFICATION_CACHE_TTL=10m
CLASSIFICATION_CACHE_MAX_ENTRIES=10000
CLASSIFICATION_CACHE_JANITOR_INTERVAL=1m

# =============================================================================
# BUSINESS LOGIC CONFIGURATION
# =============================================================================

# Max concurrent requests
MAX_CONCURRENT_REQUESTS=100

# Request timeout
REQUEST_TIMEOUT=10s

# Bulk operation limit
BULK_OPERATION_LIMIT=1000

# Search limit
SEARCH_LIMIT=100

# =============================================================================
# CLASSIFICATION CONFIGURATION
# =============================================================================

# ML enabled
ML_ENABLED=true

# Keyword method enabled
KEYWORD_METHOD_ENABLED=true

# Ensemble enabled
ENSEMBLE_ENABLED=true

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================

# Metrics enabled
METRICS_ENABLED=true

# Metrics port
METRICS_PORT=9090

# Metrics path
METRICS_PATH=/metrics

# Health check path
HEALTH_CHECK_PATH=/health

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# IP blocking
IP_BLOCK_ENABLED=true
IP_BLOCK_THRESHOLD=20
IP_BLOCK_WINDOW=5m
IP_BLOCK_DURATION=15m
IP_BLOCK_WHITELIST=
IP_BLOCK_BLACKLIST=

# Password requirements
MIN_PASSWORD_LENGTH=6
REQUIRE_UPPERCASE=false
REQUIRE_LOWERCASE=false
REQUIRE_NUMBERS=false
REQUIRE_SPECIAL=false
MAX_LOGIN_ATTEMPTS=10
LOCKOUT_DURATION=5m

# =============================================================================
# EXTERNAL SERVICES CONFIGURATION
# =============================================================================

# Business Data API
BUSINESS_DATA_API_ENABLED=false
BUSINESS_DATA_API_BASE_URL=
BUSINESS_DATA_API_KEY=
BUSINESS_DATA_API_TIMEOUT=30s
BUSINESS_DATA_API_MAX_RETRIES=3

# Risk Assessment API
RISK_ASSESSMENT_API_ENABLED=false
RISK_ASSESSMENT_API_BASE_URL=
RISK_ASSESSMENT_API_KEY=
RISK_ASSESSMENT_API_TIMEOUT=30s
RISK_ASSESSMENT_API_MAX_RETRIES=3

# Compliance API
COMPLIANCE_API_ENABLED=false
COMPLIANCE_API_BASE_URL=
COMPLIANCE_API_KEY=
COMPLIANCE_API_TIMEOUT=30s
COMPLIANCE_API_MAX_RETRIES=3

# =============================================================================
# OBSERVABILITY CONFIGURATION
# =============================================================================

# Tracing enabled
TRACING_ENABLED=true

# Tracing URL
TRACING_URL=http://localhost:14268/api/traces

# =============================================================================
# INSTRUCTIONS FOR RAILWAY
# =============================================================================

# 1. Go to Railway Dashboard
# 2. Click on your project
# 3. Go to "Variables" tab
# 4. Add these variables one by one
# 5. Replace placeholder values with actual values
# 6. Set service-specific PORT variables for each service

# CRITICAL VARIABLES TO SET FIRST:
# - SUPABASE_URL
# - SUPABASE_ANON_KEY
# - SUPABASE_SERVICE_ROLE_KEY
# - SUPABASE_JWT_SECRET

# SERVICE-SPECIFIC PORT VARIABLES:
# - API Gateway: PORT=8080
# - Classification: PORT=8081
# - Merchant: PORT=8082
# - Monitoring: PORT=8084
# - Pipeline: PORT=8085
# - Frontend: PORT=8086
# - Service Discovery: PORT=8086
# - BI Service: PORT=8087
