# Railway Deployment Keys Guide

## üîê **Understanding Your Deployment Keys**

This guide explains all the keys and secrets you need for your KYB Platform Railway deployment.

## üìã **Key Categories**

### **1. Application Security Keys (Generated Locally)**

These are generated by your application and should be kept secret:

#### **ENCRYPTION_KEY**
- **Purpose**: Encrypts sensitive data in your application
- **Source**: Generated locally (NOT from Supabase)
- **Format**: 32-character random string
- **Example**: `NUzTbkubsGQPpYysPitxZK4jTPwLCWR`
- **Security Level**: üî¥ **CRITICAL** - Never share or commit

#### **JWT_SECRET**
- **Purpose**: Signs JSON Web Tokens for user authentication
- **Source**: Generated locally (NOT from Supabase)
- **Format**: 32-character random string
- **Example**: `GvEHhjPwx6xttws0qScCGzDBMhQ0ORGh`
- **Security Level**: üî¥ **CRITICAL** - Never share or commit

#### **API_SECRET**
- **Purpose**: Secures internal API communications
- **Source**: Generated locally
- **Format**: 24-character random string
- **Example**: `4gqjV6OM2R2T6DIjdjaspp7G`
- **Security Level**: üî¥ **CRITICAL** - Never share or commit

### **2. Supabase Integration Keys (From Supabase Dashboard)**

These come from your Supabase project:

#### **SUPABASE_URL**
- **Purpose**: Your Supabase project URL
- **Source**: Supabase Dashboard ‚Üí Settings ‚Üí API
- **Format**: `https://your-project-id.supabase.co`
- **Example**: `https://abc123def456.supabase.co`
- **Security Level**: üü° **PUBLIC** - Safe to share

#### **SUPABASE_ANON_KEY**
- **Purpose**: Public API key for client-side operations
- **Source**: Supabase Dashboard ‚Üí Settings ‚Üí API
- **Format**: 48-character string starting with `eyJ`
- **Example**: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`
- **Security Level**: üü° **PUBLIC** - Safe to share

#### **SUPABASE_SERVICE_ROLE_KEY**
- **Purpose**: Admin API key for server-side operations
- **Source**: Supabase Dashboard ‚Üí Settings ‚Üí API
- **Format**: 48-character string starting with `eyJ`
- **Example**: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`
- **Security Level**: üî¥ **CRITICAL** - Never share or commit

### **3. Railway Auto-Generated Keys**

These are automatically set by Railway:

#### **DATABASE_URL**
- **Purpose**: PostgreSQL connection string
- **Source**: Railway automatically generates when you add PostgreSQL
- **Format**: `postgresql://user:password@host:port/database`
- **Example**: `postgresql://postgres:abc123@containers-us-west-1.railway.app:5432/railway`
- **Security Level**: üî¥ **CRITICAL** - Never share or commit

#### **CORS_ORIGIN**
- **Purpose**: Allowed origins for CORS
- **Source**: Railway automatically sets to your app URL
- **Format**: `https://your-app.railway.app`
- **Example**: `https://kyb-platform-beta-production.up.railway.app`
- **Security Level**: üü° **PUBLIC** - Safe to share

### **4. External API Keys (Optional)**

These are for external services you might use:

#### **BUSINESS_DATA_API_KEY**
- **Purpose**: API key for external business data services
- **Source**: External service provider
- **Format**: Varies by provider
- **Example**: `sk_live_abc123def456...`
- **Security Level**: üî¥ **CRITICAL** - Never share or commit

## üöÄ **Quick Deployment Checklist**

### **Step 1: Generate Local Keys**
```bash
./scripts/generate-keys.sh
```

### **Step 2: Get Supabase Keys**
1. Go to [supabase.com](https://supabase.com)
2. Create a new project or use existing
3. Go to Settings ‚Üí API
4. Copy:
   - Project URL
   - Anon key
   - Service role key

### **Step 3: Set Railway Environment Variables**
In Railway Dashboard ‚Üí Variables tab, add:

#### **Required (Generated)**
```
JWT_SECRET=GvEHhjPwx6xttws0qScCGzDBMhQ0ORGh
ENCRYPTION_KEY=NUzTbkubsGQPpYysPitxZK4jTPwLCWR
API_SECRET=4gqjV6OM2R2T6DIjdjaspp7G
```

#### **Required (Supabase)**
```
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
```

#### **Optional (External APIs)**
```
BUSINESS_DATA_API_KEY=your-external-api-key
BUSINESS_DATA_API_URL=https://api.example.com
```

#### **Auto-Set by Railway**
```
DATABASE_URL=postgresql://...
CORS_ORIGIN=https://your-app.railway.app
```

## üîí **Security Best Practices**

### **‚úÖ DO:**
- Generate unique keys for each environment
- Store keys in Railway's encrypted environment variables
- Use password managers for key storage
- Rotate keys regularly
- Use different keys for development and production

### **‚ùå DON'T:**
- Commit keys to version control
- Share keys in public repositories
- Use the same keys across environments
- Store keys in plain text files
- Share keys via email or chat

## üõ†Ô∏è **Key Management Commands**

### **Generate New Keys**
```bash
./scripts/generate-keys.sh
```

### **View Current Keys (Local)**
```bash
cat .env.railway.generated
```

### **Update Railway Variables**
```bash
# Using Railway CLI (when working)
railway variables set JWT_SECRET=new-secret
railway variables set ENCRYPTION_KEY=new-key
```

## üêõ **Troubleshooting**

### **Common Issues:**

#### **"Invalid JWT Secret"**
- Regenerate JWT_SECRET using the script
- Update in Railway dashboard
- Restart deployment

#### **"Encryption Key Error"**
- Ensure ENCRYPTION_KEY is exactly 32 characters
- Regenerate if needed
- Check for special characters

#### **"Supabase Connection Failed"**
- Verify SUPABASE_URL format
- Check SUPABASE_ANON_KEY and SUPABASE_SERVICE_ROLE_KEY
- Ensure Supabase project is active

#### **"Database Connection Error"**
- Railway automatically sets DATABASE_URL
- Add PostgreSQL service in Railway dashboard
- Check if database service is running

## üìû **Support**

If you need help with keys:
1. Check this guide first
2. Regenerate keys if needed
3. Verify all environment variables are set
4. Check Railway logs for specific errors

Remember: **Security keys are the foundation of your application's security. Handle them with care!** üîê
