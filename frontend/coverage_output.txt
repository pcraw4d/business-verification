
> frontend@0.1.0 test:coverage
> vitest run --coverage


[1m[46m RUN [49m[22m [36mv4.0.13 [39m[90m/Users/petercrawford/New tool/frontend[39m
      [2mCoverage enabled with [22m[33mv8[39m

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould fetch merchant data successfully
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould fetch merchant data successfully
[22m[39m[API] getMerchant: Response received [90mundefined[39m [33mtrue[39m

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould fetch merchant data successfully
[22m[39m[API] getMerchant: Data parsed successfully {
  id: [32m'merchant-123'[39m,
  business_name: [32m'Test Business'[39m,
  status: [32m'active'[39m,
  created_at: [32m'2024-01-01T00:00:00Z'[39m,
  updated_at: [32m'2024-01-01T00:00:00Z'[39m
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould map financial information fields (Phase 1)
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould map financial information fields (Phase 1)
[22m[39m[API] getMerchant: Response received [90mundefined[39m [33mtrue[39m

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould map financial information fields (Phase 1)
[22m[39m[API] getMerchant: Data parsed successfully {
  id: [32m'merchant-123'[39m,
  business_name: [32m'Test Business'[39m,
  status: [32m'active'[39m,
  created_at: [32m'2024-01-01T00:00:00Z'[39m,
  updated_at: [32m'2024-01-01T00:00:00Z'[39m,
  founded_date: [32m'2020-01-15T00:00:00Z'[39m,
  employee_count: [33m150[39m,
  annual_revenue: [33m5000000.5[39m
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould map system information fields (Phase 1)
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould map system information fields (Phase 1)
[22m[39m[API] getMerchant: Response received [90mundefined[39m [33mtrue[39m

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould map system information fields (Phase 1)
[22m[39m[API] getMerchant: Data parsed successfully {
  id: [32m'merchant-123'[39m,
  business_name: [32m'Test Business'[39m,
  status: [32m'active'[39m,
  created_at: [32m'2024-01-01T00:00:00Z'[39m,
  updated_at: [32m'2024-01-01T00:00:00Z'[39m,
  created_by: [32m'user-123'[39m,
  metadata: { source: [32m'manual'[39m, verified: [33mtrue[39m, tags: [ [32m'enterprise'[39m ] }
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould map address fields including street1, street2, countryCode (Phase 1)
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould map address fields including street1, street2, countryCode (Phase 1)
[22m[39m[API] getMerchant: Response received [90mundefined[39m [33mtrue[39m

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould map address fields including street1, street2, countryCode (Phase 1)
[22m[39m[API] getMerchant: Data parsed successfully {
  id: [32m'merchant-123'[39m,
  business_name: [32m'Test Business'[39m,
  status: [32m'active'[39m,
  created_at: [32m'2024-01-01T00:00:00Z'[39m,
  updated_at: [32m'2024-01-01T00:00:00Z'[39m,
  address: {
    street1: [32m'123 Main Street'[39m,
    street2: [32m'Suite 100'[39m,
    city: [32m'San Francisco'[39m,
    state: [32m'CA'[39m,
    postal_code: [32m'94102'[39m,
    country: [32m'United States'[39m,
    country_code: [32m'US'[39m
  }
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould map flat address fields (address_street1, etc.)
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould map flat address fields (address_street1, etc.)
[22m[39m[API] getMerchant: Response received [90mundefined[39m [33mtrue[39m

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould map flat address fields (address_street1, etc.)
[22m[39m[API] getMerchant: Data parsed successfully {
  id: [32m'merchant-123'[39m,
  business_name: [32m'Test Business'[39m,
  status: [32m'active'[39m,
  created_at: [32m'2024-01-01T00:00:00Z'[39m,
  updated_at: [32m'2024-01-01T00:00:00Z'[39m,
  address_street1: [32m'123 Main Street'[39m,
  address_street2: [32m'Suite 100'[39m,
  address_city: [32m'San Francisco'[39m,
  address_state: [32m'CA'[39m,
  address_postal_code: [32m'94102'[39m,
  address_country: [32m'United States'[39m,
  address_country_code: [32m'US'[39m
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould handle optional financial fields as undefined
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould handle optional financial fields as undefined
[22m[39m[API] getMerchant: Response received [90mundefined[39m [33mtrue[39m

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould handle optional financial fields as undefined
[22m[39m[API] getMerchant: Data parsed successfully {
  id: [32m'merchant-123'[39m,
  business_name: [32m'Test Business'[39m,
  status: [32m'active'[39m,
  created_at: [32m'2024-01-01T00:00:00Z'[39m,
  updated_at: [32m'2024-01-01T00:00:00Z'[39m
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould handle contact_info nested object
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould handle contact_info nested object
[22m[39m[API] getMerchant: Response received [90mundefined[39m [33mtrue[39m

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould handle contact_info nested object
[22m[39m[API] getMerchant: Data parsed successfully {
  id: [32m'merchant-123'[39m,
  business_name: [32m'Test Business'[39m,
  status: [32m'active'[39m,
  created_at: [32m'2024-01-01T00:00:00Z'[39m,
  updated_at: [32m'2024-01-01T00:00:00Z'[39m,
  contact_info: {
    email: [32m'test@example.com'[39m,
    phone: [32m'+1-555-123-4567'[39m,
    website: [32m'https://test.com'[39m
  }
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould validate API response with Zod schema (Phase 5)
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould validate API response with Zod schema (Phase 5)
[22m[39m[API] getMerchant: Response received [90mundefined[39m [33mtrue[39m

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould validate API response with Zod schema (Phase 5)
[22m[39m[API] getMerchant: Data parsed successfully {
  id: [32m'merchant-123'[39m,
  business_name: [32m'Test Business'[39m,
  status: [32m'active'[39m,
  created_at: [32m'2024-01-01T00:00:00Z'[39m,
  updated_at: [32m'2024-01-01T00:00:00Z'[39m,
  founded_date: [32m'2020-01-15T00:00:00Z'[39m,
  employee_count: [33m150[39m,
  annual_revenue: [33m5000000.5[39m
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould handle API errors
[22m[39m[API] getMerchant: Making request for invalid-id
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/invalid-id

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould handle API errors
[22m[39m[API] getMerchant: Response received [33m404[39m [33mfalse[39m
[API Debug] Error response - status: [33m404[39m ok: [33mfalse[39m statusText: Not Found

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mLoading State[2m > [22m[2mshould show loading skeleton initially
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mLoading State[2m > [22m[2mshould show loading skeleton initially
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk recommendations when loaded
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk alerts when loaded
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk recommendations when loaded
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk recommendations when loaded
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk alerts when loaded
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk alerts when loaded
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould handle API errors
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/invalid-id

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould handle API errors
[22m[39m[API] getMerchant: Error occurred TypeError: Cannot read properties of undefined (reading 'status')
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:264:74
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk alerts when loaded
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk alerts when loaded
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mComponent Rendering[2m > [22m[2mshould display number of enabled sources in badge
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mComponent Rendering[2m > [22m[2mshould display number of enabled sources in badge
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mComponent Rendering[2m > [22m[2mshould display number of enabled sources in badge
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould group recommendations by priority
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould group recommendations by priority
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould group recommendations by priority
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mDialog Interaction[2m > [22m[2mshould open dialog when button is clicked
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mDialog Interaction[2m > [22m[2mshould open dialog when button is clicked
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mDialog Interaction[2m > [22m[2mshould open dialog when button is clicked
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display recommendation descriptions
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display recommendation descriptions
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display recommendation descriptions
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould handle API errors
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/invalid-id

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchant[2m > [22m[2mshould handle API errors
[22m[39m[API] getMerchant: Error occurred TypeError: Cannot read properties of undefined (reading 'status')
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:264:74
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetPortfolioAnalytics[2m > [22m[2mshould handle API errors
[22m[39m[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetPortfolioStatistics[2m > [22m[2mshould handle API errors
[22m[39m[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetRiskTrends[2m > [22m[2mshould handle API errors
[22m[39m[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetRiskInsights[2m > [22m[2mshould handle API errors
[22m[39m[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetRiskBenchmarks[2m > [22m[2mshould handle API errors
[22m[39m[API Debug] Error response - status: [33m404[39m ok: [33mfalse[39m statusText: Not Found

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetMerchantRiskScore[2m > [22m[2mshould handle API errors
[22m[39m[API Debug] Error response - status: [33m404[39m ok: [33mfalse[39m statusText: Not Found

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetRiskAlerts[2m > [22m[2mshould handle API errors
[22m[39m[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mexplainRiskAssessment[2m > [22m[2mshould handle API errors
[22m[39m[API Debug] Error response - status: [33m404[39m ok: [33mfalse[39m statusText: Not Found

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mgetRiskRecommendations[2m > [22m[2mshould handle API errors
[22m[39m[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould retry on failure and eventually succeed
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould retry on failure and eventually succeed
[22m[39m[API] getMerchant: Error occurred Error: CORS policy blocked the request. Please check server configuration.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:77:25[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'CORS_ERROR'[39m,
  isCORS: [33mtrue[39m
}

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mDialog Interaction[2m > [22m[2mshould close dialog when clicking outside
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mDialog Interaction[2m > [22m[2mshould close dialog when clicking outside
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mDialog Interaction[2m > [22m[2mshould close dialog when clicking outside
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould group alerts by severity
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould group alerts by severity
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould group alerts by severity
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display alert descriptions
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display alert descriptions
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display alert descriptions
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display action items for each recommendation
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display action items for each recommendation
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display action items for each recommendation
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mLoading Sources[2m > [22m[2mshould show loading skeleton while fetching sources
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mLoading Sources[2m > [22m[2mshould display enrichment sources when loaded
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mLoading Sources[2m > [22m[2mshould display enrichment sources when loaded
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mLoading Sources[2m > [22m[2mshould display enrichment sources when loaded
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould retry on failure and eventually succeed
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould retry on failure and eventually succeed
[22m[39m[API] getMerchant: Error occurred Error: CORS policy blocked the request. Please check server configuration.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:77:25[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'CORS_ERROR'[39m,
  isCORS: [33mtrue[39m
}

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mLoading Sources[2m > [22m[2mshould only show enabled sources
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mLoading Sources[2m > [22m[2mshould only show enabled sources
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mLoading Sources[2m > [22m[2mshould only show enabled sources
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mLoading Sources[2m > [22m[2mshould show message when no sources available
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mLoading Sources[2m > [22m[2mshould show message when no sources available
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mLoading Sources[2m > [22m[2mshould show message when no sources available
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould show toast notification for critical alerts
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould show toast notification for critical alerts
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould show toast notification for critical alerts
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould show toast notification for high severity alerts
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould show toast notification for high severity alerts
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould show toast notification for high severity alerts
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould trigger enrichment when source is clicked
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould trigger enrichment when source is clicked
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould trigger enrichment when source is clicked
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mEmpty State[2m > [22m[2mshould display message when no alerts available
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mEmpty State[2m > [22m[2mshould display message when no alerts available
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mEmpty State[2m > [22m[2mshould display message when no alerts available
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mError Handling[2m > [22m[2mshould handle API error gracefully
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mError Handling[2m > [22m[2mshould handle API error gracefully
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mError Handling[2m > [22m[2mshould handle API error gracefully
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m404[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Not Found
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display priority badges
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display priority badges
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mSuccess State[2m > [22m[2mshould display priority badges
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mAuto-refresh[2m > [22m[2mshould auto-refresh alerts periodically
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mAuto-refresh[2m > [22m[2mshould auto-refresh alerts periodically
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mAuto-refresh[2m > [22m[2mshould auto-refresh alerts periodically
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mEmpty State[2m > [22m[2mshould display message when no recommendations available
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mEmpty State[2m > [22m[2mshould display message when no recommendations available
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mEmpty State[2m > [22m[2mshould display message when no recommendations available
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mError Handling[2m > [22m[2mshould handle API error gracefully
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mError Handling[2m > [22m[2mshould handle API error gracefully
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mError Handling[2m > [22m[2mshould handle API error gracefully
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m404[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Not Found
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mError Handling[2m > [22m[2mshould handle API error gracefully
[22m[39m[API Debug] Error response - status: [33m404[39m ok: [33mfalse[39m statusText: Not Found

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mCollapsible Sections[2m > [22m[2mshould allow collapsing severity sections
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mCollapsible Sections[2m > [22m[2mshould allow collapsing severity sections
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mCollapsible Sections[2m > [22m[2mshould allow collapsing severity sections
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mCollapsible Sections[2m > [22m[2mshould allow collapsing priority sections
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mCollapsible Sections[2m > [22m[2mshould allow collapsing priority sections
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mCollapsible Sections[2m > [22m[2mshould allow collapsing priority sections
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould trigger enrichment when source is clicked
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould trigger enrichment when source is clicked
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould trigger enrichment when source is clicked
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould show processing state after triggering enrichment
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould show processing state after triggering enrichment
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould show processing state after triggering enrichment
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mAction Items Display[2m > [22m[2mshould display all action items for a recommendation
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mAction Items Display[2m > [22m[2mshould display all action items for a recommendation
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mAction Items Display[2m > [22m[2mshould display all action items for a recommendation
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould retry on failure and eventually succeed
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould retry on failure and eventually succeed
[22m[39m[API] getMerchant: Response received [33m200[39m [33mtrue[39m

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould retry on failure and eventually succeed
[22m[39m[API] getMerchant: Data parsed successfully {
  id: [32m'merchant-123'[39m,
  business_name: [32m'Test Business'[39m,
  status: [32m'active'[39m,
  created_at: [32m'2024-01-01T00:00:00Z'[39m,
  updated_at: [32m'2024-01-01T00:00:00Z'[39m
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould fail after max retries
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould fail after max retries
[22m[39m[API] getMerchant: Error occurred Error: CORS policy blocked the request. Please check server configuration.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:77:25[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'CORS_ERROR'[39m,
  isCORS: [33mtrue[39m
}

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mDismiss Functionality[2m > [22m[2mshould display dismiss button for each alert
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mDismiss Functionality[2m > [22m[2mshould display dismiss button for each alert
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mDismiss Functionality[2m > [22m[2mshould display dismiss button for each alert
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould show processing state after triggering enrichment
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould show processing state after triggering enrichment
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould show processing state after triggering enrichment
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould show completed state after enrichment finishes
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould show completed state after enrichment finishes
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould show completed state after enrichment finishes
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mAction Items Display[2m > [22m[2mshould format action items as list items
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mAction Items Display[2m > [22m[2mshould format action items as list items
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mAction Items Display[2m > [22m[2mshould format action items as list items
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould fail after max retries
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould fail after max retries
[22m[39m[API] getMerchant: Error occurred Error: CORS policy blocked the request. Please check server configuration.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:77:25[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'CORS_ERROR'[39m,
  isCORS: [33mtrue[39m
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould use custom retry count
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould use custom retry count
[22m[39m[API] getMerchant: Response received [33m500[39m [33mfalse[39m
[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mRetry Logic[2m > [22m[2mshould use custom retry count
[22m[39m[API] getMerchant: Error occurred Error: Temporary error
    at handleResponse [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:111:21[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:268:27
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  status: [33m500[39m,
  code: [32m'SERVER_ERROR'[39m
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle CORS errors
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle CORS errors
[22m[39m[API] getMerchant: Error occurred Error: CORS policy blocked the request. Please check server configuration.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:77:25[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'CORS_ERROR'[39m,
  isCORS: [33mtrue[39m
}

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould show completed state after enrichment finishes
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould show completed state after enrichment finishes
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould show completed state after enrichment finishes
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMark as Complete[2m > [22m[2mshould display "Mark as Complete" button for each recommendation
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMark as Complete[2m > [22m[2mshould display "Mark as Complete" button for each recommendation
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMark as Complete[2m > [22m[2mshould display "Mark as Complete" button for each recommendation
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mDismiss Functionality[2m > [22m[2mshould dismiss alert when dismiss button is clicked
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mDismiss Functionality[2m > [22m[2mshould dismiss alert when dismiss button is clicked
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mDismiss Functionality[2m > [22m[2mshould dismiss alert when dismiss button is clicked
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle CORS errors
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle CORS errors
[22m[39m[API] getMerchant: Error occurred Error: CORS policy blocked the request. Please check server configuration.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:77:25[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'CORS_ERROR'[39m,
  isCORS: [33mtrue[39m
}

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger
[MSW] Response status: [33m500[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Internal Server Error
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMark as Complete[2m > [22m[2mshould mark recommendation as complete when button is clicked
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMark as Complete[2m > [22m[2mshould mark recommendation as complete when button is clicked
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMark as Complete[2m > [22m[2mshould mark recommendation as complete when button is clicked
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mDismiss Functionality[2m > [22m[2mshould track dismissed alerts count
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mDismiss Functionality[2m > [22m[2mshould track dismissed alerts count
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mDismiss Functionality[2m > [22m[2mshould track dismissed alerts count
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger
[MSW] Response status: [33m500[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Internal Server Error
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMark as Complete[2m > [22m[2mshould track completed recommendations count
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMark as Complete[2m > [22m[2mshould track completed recommendations count
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMark as Complete[2m > [22m[2mshould track completed recommendations count
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

 [32m✓[39m __tests__/components/bulk-operations/BulkOperationsManager.test.tsx [2m([22m[2m14 tests[22m[2m)[22m[33m 8433[2mms[22m[39m
       [33m[2m✓[22m[39m should render bulk operations manager [33m 391[2mms[22m[39m
       [33m[2m✓[22m[39m should load and display merchants [33m 325[2mms[22m[39m
       [33m[2m✓[22m[39m should allow selecting individual merchants [33m 1216[2mms[22m[39m
       [33m[2m✓[22m[39m should allow selecting all merchants [33m 729[2mms[22m[39m
       [33m[2m✓[22m[39m should allow deselecting all merchants [33m 1245[2mms[22m[39m
       [33m[2m✓[22m[39m should allow selecting merchants by filter [33m 594[2mms[22m[39m
       [33m[2m✓[22m[39m should filter merchants by search term [33m 1869[2mms[22m[39m
       [33m[2m✓[22m[39m should filter merchants by status [33m 447[2mms[22m[39m
       [33m[2m✓[22m[39m should filter merchants by risk level [33m 478[2mms[22m[39m
       [33m[2m✓[22m[39m should show operation selection when merchants are selected [33m 442[2mms[22m[39m
       [33m[2m✓[22m[39m should require merchant selection before starting operation [33m 322[2mms[22m[39m
[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mFiltering by Severity[2m > [22m[2mshould display severity filter dropdown
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mFiltering by Severity[2m > [22m[2mshould display severity filter dropdown
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mFiltering by Severity[2m > [22m[2mshould display severity filter dropdown
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mFiltering by Severity[2m > [22m[2mshould filter alerts by severity when filter is selected
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mFiltering by Severity[2m > [22m[2mshould filter alerts by severity when filter is selected
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mFiltering by Severity[2m > [22m[2mshould filter alerts by severity when filter is selected
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle CORS errors
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle CORS errors
[22m[39m[API] getMerchant: Error occurred Error: CORS policy blocked the request. Please check server configuration.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:77:25[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'CORS_ERROR'[39m,
  isCORS: [33mtrue[39m
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle network errors
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle network errors
[22m[39m[API] getMerchant: Error occurred Error: Network request failed. Please check your connection.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:84:28[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'NETWORK_ERROR'[39m
}

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mFiltering by Priority[2m > [22m[2mshould display priority filter dropdown
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mFiltering by Priority[2m > [22m[2mshould display priority filter dropdown
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mFiltering by Priority[2m > [22m[2mshould display priority filter dropdown
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mFiltering by Priority[2m > [22m[2mshould filter recommendations by priority when filter is selected
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mFiltering by Priority[2m > [22m[2mshould filter recommendations by priority when filter is selected
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mFiltering by Priority[2m > [22m[2mshould filter recommendations by priority when filter is selected
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle network errors
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle network errors
[22m[39m[API] getMerchant: Error occurred Error: Network request failed. Please check your connection.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:84:28[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'NETWORK_ERROR'[39m
}

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger
[MSW] Response status: [33m500[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Internal Server Error
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mTriggering Enrichment[2m > [22m[2mshould handle enrichment failure
[22m[39m[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mError Handling[2m > [22m[2mshould display error message when sources fail to load
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mError Handling[2m > [22m[2mshould display error message when sources fail to load
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mError Handling[2m > [22m[2mshould display error message when sources fail to load
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m500[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Internal Server Error
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mError Handling[2m > [22m[2mshould display error message when sources fail to load
[22m[39m[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstderr[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mError Handling[2m > [22m[2mshould display error message when sources fail to load
[22m[39mAPI Error: UNKNOWN_ERROR API Error 500: Internal Server Error

[90mstderr[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mError Handling[2m > [22m[2mshould display error message when sources fail to load
[22m[39mError loading enrichment sources: Error: API Error 500: Internal Server Error
    at handleResponse [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:111:21[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:873:20
    at [90m/Users/petercrawford/New tool/frontend/[39mcomponents/merchant/EnrichmentButton.tsx:65:20 {
  status: [33m500[39m,
  code: [32m'HTTP_500'[39m
}

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on error
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on error
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on error
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m500[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Internal Server Error
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on error
[22m[39m[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstderr[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on error
[22m[39mAPI Error: UNKNOWN_ERROR API Error 500: Internal Server Error

[90mstderr[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on error
[22m[39mError loading enrichment sources: Error: API Error 500: Internal Server Error
    at handleResponse [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:111:21[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:873:20
    at [90m/Users/petercrawford/New tool/frontend/[39mcomponents/merchant/EnrichmentButton.tsx:65:20 {
  status: [33m500[39m,
  code: [32m'HTTP_500'[39m
}

 [32m✓[39m __tests__/components/export/ExportButton.test.tsx [2m([22m[2m18 tests[22m[2m)[22m[33m 11436[2mms[22m[39m
       [33m[2m✓[22m[39m should render export button with dropdown [33m 614[2mms[22m[39m
       [33m[2m✓[22m[39m should show export formats in dropdown [33m 949[2mms[22m[39m
       [33m[2m✓[22m[39m should only show specified formats [33m 860[2mms[22m[39m
       [33m[2m✓[22m[39m should export CSV format [33m 662[2mms[22m[39m
       [33m[2m✓[22m[39m should export JSON format [33m 782[2mms[22m[39m
       [33m[2m✓[22m[39m should export Excel format [33m 730[2mms[22m[39m
       [33m[2m✓[22m[39m should export PDF format [33m 658[2mms[22m[39m
       [33m[2m✓[22m[39m should handle async data function [33m 734[2mms[22m[39m
       [33m[2m✓[22m[39m should use custom filename when provided [33m 596[2mms[22m[39m
       [33m[2m✓[22m[39m should generate filename when not provided [33m 454[2mms[22m[39m
       [33m[2m✓[22m[39m should use API endpoint when useAPI is true [33m 595[2mms[22m[39m
       [33m[2m✓[22m[39m should call onExportStart callback [33m 390[2mms[22m[39m
       [33m[2m✓[22m[39m should call onExportComplete callback on success [33m 452[2mms[22m[39m
       [33m[2m✓[22m[39m should call onExportError callback on failure [33m 414[2mms[22m[39m
       [33m[2m✓[22m[39m should handle missing data [33m 382[2mms[22m[39m
       [33m[2m✓[22m[39m should handle export function errors [33m 377[2mms[22m[39m
       [33m[2m✓[22m[39m should handle unsupported format [33m 576[2mms[22m[39m
       [33m[2m✓[22m[39m should disable button while exporting [33m 1204[2mms[22m[39m
[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mView All Alerts Link[2m > [22m[2mshould display "View All Alerts" link
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mView All Alerts Link[2m > [22m[2mshould display "View All Alerts" link
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mView All Alerts Link[2m > [22m[2mshould display "View All Alerts" link
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mSearch Functionality[2m > [22m[2mshould display search input
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mSearch Functionality[2m > [22m[2mshould display search input
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mSearch Functionality[2m > [22m[2mshould display search input
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMultiple Vendor Selection[2m > [22m[2mshould allow selecting multiple vendors with checkboxes
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMultiple Vendor Selection[2m > [22m[2mshould allow selecting multiple vendors with checkboxes
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMultiple Vendor Selection[2m > [22m[2mshould allow selecting multiple vendors with checkboxes
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle network errors
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle network errors
[22m[39m[API] getMerchant: Error occurred Error: Network request failed. Please check your connection.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:84:28[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'NETWORK_ERROR'[39m
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle generic TypeError errors
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle generic TypeError errors
[22m[39m[API] getMerchant: Error occurred Error: Network request failed. Please check your connection.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:84:28[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'NETWORK_ERROR'[39m
}

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mSearch Functionality[2m > [22m[2mshould filter recommendations by search text
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mSearch Functionality[2m > [22m[2mshould filter recommendations by search text
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mSearch Functionality[2m > [22m[2mshould filter recommendations by search text
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mLoading State[2m > [22m[2mshould show loading skeleton initially
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk explainability section when loaded
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk explainability section when loaded
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk explainability section when loaded
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk explainability section when loaded
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk explainability section when loaded
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk explainability section when loaded
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mWebSocket Real-time Updates[2m > [22m[2mshould listen for WebSocket riskAlert events
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mWebSocket Real-time Updates[2m > [22m[2mshould listen for WebSocket riskAlert events
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mWebSocket Real-time Updates[2m > [22m[2mshould listen for WebSocket riskAlert events
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMultiple Vendor Selection[2m > [22m[2mshould trigger enrichment for all selected vendors
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMultiple Vendor Selection[2m > [22m[2mshould trigger enrichment for all selected vendors
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMultiple Vendor Selection[2m > [22m[2mshould trigger enrichment for all selected vendors
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display SHAP values chart
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display SHAP values chart
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display SHAP values chart
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display SHAP values chart
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display SHAP values chart
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display SHAP values chart
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display SHAP values chart
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display SHAP values chart
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mWebSocket Real-time Updates[2m > [22m[2mshould show toast notification for new critical alerts
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mWebSocket Real-time Updates[2m > [22m[2mshould show toast notification for new critical alerts
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mWebSocket Real-time Updates[2m > [22m[2mshould show toast notification for new critical alerts
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display feature importance chart
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display feature importance chart
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display feature importance chart
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display feature importance chart
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display feature importance chart
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display feature importance chart
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle generic TypeError errors
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle generic TypeError errors
[22m[39m[API] getMerchant: Error occurred Error: Network request failed. Please check your connection.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:84:28[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'NETWORK_ERROR'[39m
}

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mWebSocket Real-time Updates[2m > [22m[2mshould update alerts state when WebSocket event is received
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mWebSocket Real-time Updates[2m > [22m[2mshould update alerts state when WebSocket event is received
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active

[90mstdout[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mWebSocket Real-time Updates[2m > [22m[2mshould update alerts state when WebSocket event is received
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/indicators/merchant-123?status=active
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk factors table
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk factors table
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk factors table
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk factors table
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk factors table
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display risk factors table
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mSearch Functionality[2m > [22m[2mshould search across title, description, type, and action items
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mSearch Functionality[2m > [22m[2mshould search across title, description, type, and action items
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations

[90mstdout[2m | __tests__/components/merchant/RiskRecommendationsSection.test.tsx[2m > [22m[2mRiskRecommendationsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mSearch Functionality[2m > [22m[2mshould search across title, description, type, and action items
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-recommendations
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstderr[2m | __tests__/components/forms/MerchantForm.test.tsx[2m > [22m[2mMerchantForm[2m > [22m[2mForm Submission[2m > [22m[2mshould show error toast on submission failure
[22m[39mError submitting merchant form: Error: Failed to create merchant
    at [90m/Users/petercrawford/New tool/frontend/[39m__tests__/components/forms/MerchantForm.test.tsx:665:21
    at [90mfile:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:912:26
    at [90mfile:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1237:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1203:10[90m)[39m
    at [90mfile:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1647:37
    at Traces.$ [90m(file:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1647:12[90m)[39m

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMultiple Vendor Selection[2m > [22m[2mshould trigger enrichment for all selected vendors
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMultiple Vendor Selection[2m > [22m[2mshould trigger enrichment for all selected vendors
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMultiple Vendor Selection[2m > [22m[2mshould trigger enrichment for all selected vendors
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display top 10 SHAP values
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display top 10 SHAP values
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display top 10 SHAP values
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display top 10 SHAP values
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display top 10 SHAP values
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display top 10 SHAP values
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display factor scores and weights in table
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display factor scores and weights in table
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display factor scores and weights in table
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display factor scores and weights in table
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display factor scores and weights in table
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould display factor scores and weights in table
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould calculate and display impact (score * weight)
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould calculate and display impact (score * weight)
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould calculate and display impact (score * weight)
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould calculate and display impact (score * weight)
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould calculate and display impact (score * weight)
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSuccess State[2m > [22m[2mshould calculate and display impact (score * weight)
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstderr[2m | __tests__/components/merchant/RiskAlertsSection.test.tsx[2m > [22m[2mRiskAlertsSection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mWebSocket Real-time Updates[2m > [22m[2mshould update alerts state when WebSocket event is received
[22m[39mAn update to RiskAlertsSection inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mAssessment ID Resolution[2m > [22m[2mshould fetch assessment ID from risk assessment
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mAssessment ID Resolution[2m > [22m[2mshould fetch assessment ID from risk assessment
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mAssessment ID Resolution[2m > [22m[2mshould fetch assessment ID from risk assessment
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mAssessment ID Resolution[2m > [22m[2mshould fetch assessment ID from risk assessment
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mAssessment ID Resolution[2m > [22m[2mshould fetch assessment ID from risk assessment
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mAssessment ID Resolution[2m > [22m[2mshould fetch assessment ID from risk assessment
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mAssessment ID Resolution[2m > [22m[2mshould use cached assessment ID on subsequent renders
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mAssessment ID Resolution[2m > [22m[2mshould use cached assessment ID on subsequent renders
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mAssessment ID Resolution[2m > [22m[2mshould use cached assessment ID on subsequent renders
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mAssessment ID Resolution[2m > [22m[2mshould use cached assessment ID on subsequent renders
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mAssessment ID Resolution[2m > [22m[2mshould use cached assessment ID on subsequent renders
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mAssessment ID Resolution[2m > [22m[2mshould use cached assessment ID on subsequent renders
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle missing risk assessment
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle missing risk assessment
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle missing risk assessment
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m404[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Not Found
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

 [32m✓[39m __tests__/components/merchant/RiskRecommendationsSection.test.tsx [2m([22m[2m19 tests[22m[2m)[22m[33m 14849[2mms[22m[39m
       [33m[2m✓[22m[39m should display risk recommendations when loaded [33m 1540[2mms[22m[39m
       [33m[2m✓[22m[39m should group recommendations by priority [33m 401[2mms[22m[39m
       [33m[2m✓[22m[39m should display recommendation descriptions [33m 796[2mms[22m[39m
       [33m[2m✓[22m[39m should display action items for each recommendation [33m 1426[2mms[22m[39m
       [33m[2m✓[22m[39m should allow collapsing priority sections [33m 793[2mms[22m[39m
       [33m[2m✓[22m[39m should display all action items for a recommendation [33m 726[2mms[22m[39m
       [33m[2m✓[22m[39m should format action items as list items [33m 622[2mms[22m[39m
         [33m[2m✓[22m[39m should display "Mark as Complete" button for each recommendation [33m 996[2mms[22m[39m
         [33m[2m✓[22m[39m should mark recommendation as complete when button is clicked [33m 918[2mms[22m[39m
         [33m[2m✓[22m[39m should track completed recommendations count [33m 864[2mms[22m[39m
         [33m[2m✓[22m[39m should filter recommendations by priority when filter is selected [33m 2737[2mms[22m[39m
         [33m[2m✓[22m[39m should filter recommendations by search text [33m 1264[2mms[22m[39m
         [33m[2m✓[22m[39m should search across title, description, type, and action items [33m 1206[2mms[22m[39m
[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle generic TypeError errors
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstderr[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mCORS and Network Errors[2m > [22m[2mshould handle generic TypeError errors
[22m[39m[API] getMerchant: Error occurred Error: Network request failed. Please check your connection.
    at safeFetch [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:84:28[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:257:28
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m {
  code: [32m'NETWORK_ERROR'[39m
}

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mError Response Handling[2m > [22m[2mshould handle error response with message
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mError Response Handling[2m > [22m[2mshould handle error response with message
[22m[39m[API] getMerchant: Response received [33m400[39m [33mfalse[39m
[API Debug] Error response - status: [33m400[39m ok: [33mfalse[39m statusText: Bad Request

 [31m❯[39m __tests__/components/merchant/RiskAlertsSection.test.tsx [2m([22m[2m19 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 15274[2mms[22m[39m
       [32m✓[39m should show loading skeleton initially[32m 157[2mms[22m[39m
       [33m[2m✓[22m[39m should display risk alerts when loaded [33m 2320[2mms[22m[39m
       [32m✓[39m should group alerts by severity[32m 229[2mms[22m[39m
       [33m[2m✓[22m[39m should display alert descriptions [33m 1250[2mms[22m[39m
       [32m✓[39m should show toast notification for critical alerts[32m 252[2mms[22m[39m
       [32m✓[39m should show toast notification for high severity alerts[32m 65[2mms[22m[39m
       [32m✓[39m should display message when no alerts available[32m 12[2mms[22m[39m
       [32m✓[39m should handle API error gracefully[32m 11[2mms[22m[39m
       [32m✓[39m should auto-refresh alerts periodically[32m 172[2mms[22m[39m
       [33m[2m✓[22m[39m should allow collapsing severity sections [33m 1002[2mms[22m[39m
         [33m[2m✓[22m[39m should display dismiss button for each alert [33m 1453[2mms[22m[39m
         [33m[2m✓[22m[39m should dismiss alert when dismiss button is clicked [33m 1148[2mms[22m[39m
         [33m[2m✓[22m[39m should track dismissed alerts count [33m 1084[2mms[22m[39m
         [32m✓[39m should display severity filter dropdown[32m 144[2mms[22m[39m
         [33m[2m✓[22m[39m should filter alerts by severity when filter is selected [33m 2574[2mms[22m[39m
         [33m[2m✓[22m[39m should display "View All Alerts" link [33m 1129[2mms[22m[39m
         [32m✓[39m should listen for WebSocket riskAlert events[32m 169[2mms[22m[39m
[31m         [31m×[31m should show toast notification for new critical alerts[39m[33m 368[2mms[22m[39m
         [33m[2m✓[22m[39m should update alerts state when WebSocket event is received [33m 1726[2mms[22m[39m
[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle risk assessment without ID
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle risk assessment without ID
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle risk assessment without ID
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m404[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Not Found
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle explanation fetch failure
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle explanation fetch failure
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle explanation fetch failure
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle explanation fetch failure
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle explanation fetch failure
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle explanation fetch failure
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m404[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Not Found
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle explanation fetch failure
[22m[39m[API Debug] Error response - status: [33m404[39m ok: [33mfalse[39m statusText: Not Found

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle explanation fetch failure
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle explanation fetch failure
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle explanation fetch failure
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m404[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Not Found
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould handle explanation fetch failure
[22m[39m[API Debug] Error response - status: [33m404[39m ok: [33mfalse[39m statusText: Not Found

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on explanation error (when assessment exists)
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on explanation error (when assessment exists)
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on explanation error (when assessment exists)
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on explanation error (when assessment exists)
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on explanation error (when assessment exists)
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on explanation error (when assessment exists)
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m404[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Not Found
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on explanation error (when assessment exists)
[22m[39m[API Debug] Error response - status: [33m404[39m ok: [33mfalse[39m statusText: Not Found

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on explanation error (when assessment exists)
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on explanation error (when assessment exists)
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on explanation error (when assessment exists)
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m404[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Not Found
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould show retry button on explanation error (when assessment exists)
[22m[39m[API Debug] Error response - status: [33m404[39m ok: [33mfalse[39m statusText: Not Found

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMultiple Vendor Selection[2m > [22m[2mshould trigger enrichment for all selected vendors
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMultiple Vendor Selection[2m > [22m[2mshould trigger enrichment for all selected vendors
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mMultiple Vendor Selection[2m > [22m[2mshould trigger enrichment for all selected vendors
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould retry fetching when retry button is clicked
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould retry fetching when retry button is clicked
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould retry fetching when retry button is clicked
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould retry fetching when retry button is clicked
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould retry fetching when retry button is clicked
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould retry fetching when retry button is clicked
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m404[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Not Found
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould retry fetching when retry button is clicked
[22m[39m[API Debug] Error response - status: [33m404[39m ok: [33mfalse[39m statusText: Not Found

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould retry fetching when retry button is clicked
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould retry fetching when retry button is clicked
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mError Handling[2m > [22m[2mshould retry fetching when retry button is clicked
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mJob Tracking[2m > [22m[2mshould display job status and progress
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mJob Tracking[2m > [22m[2mshould display job status and progress
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mJob Tracking[2m > [22m[2mshould display job status and progress
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render loading state initially
[22m[39m[MerchantDetailsLayout] Loading merchant (attempt 1): merchant-123
[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123
[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MerchantDetailsLayout] Loading merchant (attempt 1): merchant-123
[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123
[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[API] getMerchant: Response received [33m200[39m [33mtrue[39m

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[API] getMerchant: Data parsed successfully {
  id: [32m'merchant-123'[39m,
  businessName: [32m'Test Business'[39m,
  industry: [32m'Technology'[39m,
  status: [32m'active'[39m,
  email: [32m'test@example.com'[39m,
  phone: [32m'+1-555-123-4567'[39m,
  website: [32m'https://test.com'[39m,
  address: {
    street: [32m'123 Main St'[39m,
    city: [32m'San Francisco'[39m,
    state: [32m'CA'[39m,
    postalCode: [32m'94102'[39m,
    country: [32m'USA'[39m
  },
  createdAt: [32m'2025-11-22T18:33:45.912Z'[39m,
  updatedAt: [32m'2025-11-22T18:33:45.912Z'[39m
}

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MerchantDetailsLayout] Merchant data received: {
  id: [32m'merchant-123'[39m,
  businessName: [32m'Test Business'[39m,
  name: [90mundefined[39m,
  legalName: [90mundefined[39m,
  registrationNumber: [90mundefined[39m,
  taxId: [90mundefined[39m,
  industry: [32m'Technology'[39m,
  industryCode: [90mundefined[39m,
  businessType: [90mundefined[39m,
  description: [90mundefined[39m,
  status: [32m'active'[39m,
  website: [32m'https://test.com'[39m,
  email: [32m'test@example.com'[39m,
  phone: [32m'+1-555-123-4567'[39m,
  address: {
    street: [32m'123 Main St'[39m,
    street1: [90mundefined[39m,
    street2: [90mundefined[39m,
    city: [32m'San Francisco'[39m,
    state: [32m'CA'[39m,
    postalCode: [32m'94102'[39m,
    country: [32m'USA'[39m,
    countryCode: [90mundefined[39m
  },
  portfolioType: [90mundefined[39m,
  riskLevel: [90mundefined[39m,
  complianceStatus: [90mundefined[39m,
  foundedDate: [90mundefined[39m,
  employeeCount: [90mundefined[39m,
  annualRevenue: [90mundefined[39m,
  createdBy: [90mundefined[39m,
  metadata: [90mundefined[39m,
  createdAt: [32m'2025-11-22T18:33:45.912Z'[39m,
  updatedAt: [32m'2025-11-22T18:33:45.912Z'[39m
}
[MerchantDetailsLayout] State updated with merchant data
[MerchantDetailsLayout] Loading complete

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mEmpty State[2m > [22m[2mshould show message when no explanation data available
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mEmpty State[2m > [22m[2mshould show message when no explanation data available
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mEmpty State[2m > [22m[2mshould show message when no explanation data available
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mEmpty State[2m > [22m[2mshould show message when no explanation data available
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mEmpty State[2m > [22m[2mshould show message when no explanation data available
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mEmpty State[2m > [22m[2mshould show message when no explanation data available
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mError Response Handling[2m > [22m[2mshould handle error response with message
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mError Response Handling[2m > [22m[2mshould handle error response with message
[22m[39m[API] getMerchant: Response received [33m400[39m [33mfalse[39m
[API Debug] Error response - status: [33m400[39m ok: [33mfalse[39m statusText: Bad Request

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mJob Tracking[2m > [22m[2mshould display job status and progress
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSHAP Values Processing[2m > [22m[2mshould sort SHAP values by absolute value
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSHAP Values Processing[2m > [22m[2mshould sort SHAP values by absolute value
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSHAP Values Processing[2m > [22m[2mshould sort SHAP values by absolute value
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSHAP Values Processing[2m > [22m[2mshould sort SHAP values by absolute value
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSHAP Values Processing[2m > [22m[2mshould sort SHAP values by absolute value
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSHAP Values Processing[2m > [22m[2mshould sort SHAP values by absolute value
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mJob Tracking[2m > [22m[2mshould display job status and progress
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mJob Tracking[2m > [22m[2mshould display job status and progress
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSHAP Values Processing[2m > [22m[2mshould limit SHAP values to top 10
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSHAP Values Processing[2m > [22m[2mshould limit SHAP values to top 10
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSHAP Values Processing[2m > [22m[2mshould limit SHAP values to top 10
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSHAP Values Processing[2m > [22m[2mshould limit SHAP values to top 10
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSHAP Values Processing[2m > [22m[2mshould limit SHAP values to top 10
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mSHAP Values Processing[2m > [22m[2mshould limit SHAP values to top 10
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mFeature Importance Calculation[2m > [22m[2mshould calculate impact as score * weight
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mFeature Importance Calculation[2m > [22m[2mshould calculate impact as score * weight
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mFeature Importance Calculation[2m > [22m[2mshould calculate impact as score * weight
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mFeature Importance Calculation[2m > [22m[2mshould calculate impact as score * weight
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mFeature Importance Calculation[2m > [22m[2mshould calculate impact as score * weight
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mFeature Importance Calculation[2m > [22m[2mshould calculate impact as score * weight
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mJob Tracking[2m > [22m[2mshould show progress indicator during enrichment
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mJob Tracking[2m > [22m[2mshould show progress indicator during enrichment
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mJob Tracking[2m > [22m[2mshould show progress indicator during enrichment
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/statistics
[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/statistics

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/statistics
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstderr[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[API Validation] Validation failed for getPortfolioStatistics()
API Error: UNKNOWN_ERROR API response validation failed for getPortfolioStatistics(): Invalid input: expected number, received undefined; Invalid input: expected number, received undefined; Invalid input: expected number, received undefined; Invalid input: expected object, received undefined; Invalid input: expected array, received undefined; Invalid input: expected array, received undefined; Invalid input: expected string, received undefined

[90mstderr[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[API Validation] Validation failed for getMerchantRiskScore(merchant-123)
API Error: UNKNOWN_ERROR API response validation failed for getMerchantRiskScore(merchant-123): Invalid input: expected string, received undefined; Invalid option: expected one of "low"|"medium"|"high"; Invalid input: expected string, received undefined

[90mstderr[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39mFailed to fetch portfolio statistics: Error: API response validation failed for getPortfolioStatistics(): Invalid input: expected number, received undefined; Invalid input: expected number, received undefined; Invalid input: expected number, received undefined; Invalid input: expected object, received undefined; Invalid input: expected array, received undefined; Invalid input: expected array, received undefined; Invalid input: expected string, received undefined
    at validateAPIResponse [90m(/Users/petercrawford/New tool/frontend/[39mlib/api-validation.ts:355:13[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:1545:20
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at async Promise.allSettled (index 0)
    at [90m/Users/petercrawford/New tool/frontend/[39mcomponents/merchant/PortfolioContextBadge.tsx:33:63

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mFeature Importance Calculation[2m > [22m[2mshould sort features by impact
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mFeature Importance Calculation[2m > [22m[2mshould sort features by impact
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mFeature Importance Calculation[2m > [22m[2mshould sort features by impact
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mFeature Importance Calculation[2m > [22m[2mshould sort features by impact
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mFeature Importance Calculation[2m > [22m[2mshould sort features by impact
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mFeature Importance Calculation[2m > [22m[2mshould sort features by impact
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/statistics
[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/statistics

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/statistics
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstderr[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[API Validation] Validation failed for getPortfolioStatistics()
API Error: UNKNOWN_ERROR API response validation failed for getPortfolioStatistics(): Invalid input: expected number, received undefined; Invalid input: expected number, received undefined; Invalid input: expected number, received undefined; Invalid input: expected object, received undefined; Invalid input: expected array, received undefined; Invalid input: expected array, received undefined; Invalid input: expected string, received undefined

[90mstderr[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39m[API Validation] Validation failed for getMerchantRiskScore(merchant-123)
API Error: UNKNOWN_ERROR API response validation failed for getMerchantRiskScore(merchant-123): Invalid input: expected string, received undefined; Invalid option: expected one of "low"|"medium"|"high"; Invalid input: expected string, received undefined

[90mstderr[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render merchant details when loaded
[22m[39mFailed to fetch portfolio statistics: Error: API response validation failed for getPortfolioStatistics(): Invalid input: expected number, received undefined; Invalid input: expected number, received undefined; Invalid input: expected number, received undefined; Invalid input: expected object, received undefined; Invalid input: expected array, received undefined; Invalid input: expected array, received undefined; Invalid input: expected string, received undefined
    at validateAPIResponse [90m(/Users/petercrawford/New tool/frontend/[39mlib/api-validation.ts:355:13[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:1545:20

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render error state on API error
[22m[39m[MerchantDetailsLayout] Loading merchant (attempt 1): merchant-123
[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123
[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render error state on API error
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render error state on API error
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123
[MSW] Response status: [33m500[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Internal Server Error
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render error state on API error
[22m[39m[API] getMerchant: Response received [33m500[39m [33mfalse[39m
[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstderr[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render error state on API error
[22m[39m[API] getMerchant: Error occurred Error: Failed to load merchant data
    at handleResponse [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:111:21[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:268:27
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mcomponents/merchant/MerchantDetailsLayout.tsx:76:20 {
  status: [33m500[39m,
  code: [32m'INTERNAL_ERROR'[39m
}

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mJob Tracking[2m > [22m[2mshould show progress indicator during enrichment
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mJob Tracking[2m > [22m[2mshould show progress indicator during enrichment
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mJob Tracking[2m > [22m[2mshould show progress indicator during enrichment
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mTooltips[2m > [22m[2mshould display tooltips for SHAP values
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mTooltips[2m > [22m[2mshould display tooltips for SHAP values
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mTooltips[2m > [22m[2mshould display tooltips for SHAP values
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mTooltips[2m > [22m[2mshould display tooltips for SHAP values
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mTooltips[2m > [22m[2mshould display tooltips for SHAP values
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mTooltips[2m > [22m[2mshould display tooltips for SHAP values
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mTooltips[2m > [22m[2mshould display tooltips for feature importance
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mTooltips[2m > [22m[2mshould display tooltips for feature importance
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mTooltips[2m > [22m[2mshould display tooltips for feature importance
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mTooltips[2m > [22m[2mshould display tooltips for feature importance
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mTooltips[2m > [22m[2mshould display tooltips for feature importance
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mTooltips[2m > [22m[2mshould display tooltips for feature importance
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mEnrichment History[2m > [22m[2mshould display enrichment history tab
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mEnrichment History[2m > [22m[2mshould display enrichment history tab
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mEnrichment History[2m > [22m[2mshould display enrichment history tab
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mExport Functionality[2m > [22m[2mshould display export button
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mExport Functionality[2m > [22m[2mshould display export button
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mExport Functionality[2m > [22m[2mshould display export button
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mExport Functionality[2m > [22m[2mshould display export button
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mExport Functionality[2m > [22m[2mshould display export button
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mExport Functionality[2m > [22m[2mshould display export button
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mExport Functionality[2m > [22m[2mshould export explanation data when export button is clicked
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mExport Functionality[2m > [22m[2mshould export explanation data when export button is clicked
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mExport Functionality[2m > [22m[2mshould export explanation data when export button is clicked
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mExport Functionality[2m > [22m[2mshould export explanation data when export button is clicked
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mExport Functionality[2m > [22m[2mshould export explanation data when export button is clicked
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/risk/explain/assessment-123

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mExport Functionality[2m > [22m[2mshould export explanation data when export button is clicked
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/risk/explain/assessment-123
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mEnrichment History[2m > [22m[2mshould show past enrichment jobs in history
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mEnrichment History[2m > [22m[2mshould show past enrichment jobs in history
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mEnrichment History[2m > [22m[2mshould show past enrichment jobs in history
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render error state on API error
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123
[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render error state on API error
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render error state on API error
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123
[MSW] Response status: [33m500[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Internal Server Error
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render error state on API error
[22m[39m[API] getMerchant: Response received [33m500[39m [33mfalse[39m
[API Debug] Error response - status: [33m500[39m ok: [33mfalse[39m statusText: Internal Server Error

[90mstderr[2m | __tests__/components/merchant/MerchantDetailsLayout.test.tsx[2m > [22m[2mMerchantDetailsLayout[2m > [22m[2mshould render error state on API error
[22m[39m[API] getMerchant: Error occurred Error: Failed to load merchant data
    at handleResponse [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:111:21[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mlib/api.ts:268:27
    at retryWithBackoff [90m(/Users/petercrawford/New tool/frontend/[39mlib/api.ts:198:14[90m)[39m
    at [90m/Users/petercrawford/New tool/frontend/[39mcomponents/merchant/MerchantDetailsLayout.tsx:76:20 {
  status: [33m500[39m,
  code: [32m'INTERNAL_ERROR'[39m
}

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mEnrichment History[2m > [22m[2mshould show past enrichment jobs in history
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mEnrichment History[2m > [22m[2mshould show past enrichment jobs in history
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mEnrichment History[2m > [22m[2mshould show past enrichment jobs in history
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render loading state initially
[22m[39m[RiskAssessmentTab] Starting to load assessment: merchant-123

[90mstdout[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render assessment data when loaded
[22m[39m[RiskAssessmentTab] Starting to load assessment: merchant-123

[90mstderr[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render assessment data when loaded
[22m[39mFailed to load risk history: Error: [vitest] No "getRiskHistory" export is defined on the "@/lib/api" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError [90m(file:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.W28wBIgJ.js:310:17[90m)[39m
    at Object.get [90m(file:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.W28wBIgJ.js:383:16[90m)[39m
    at loadAssessment [90m(/Users/petercrawford/New tool/frontend/[39mcomponents/merchant/RiskAssessmentTab.tsx:119:33[90m)[39m {
  codeFrame: [32m'vi.mock(import("@/lib/api"), async (importOriginal) => {\n'[39m +
    [32m'  const actual = await importOriginal()\n'[39m +
    [32m'  return {\n'[39m +
    [32m'    ...actual,\n'[39m +
    [32m'    // your mocked methods\n'[39m +
    [32m'  }\n'[39m +
    [32m'})'[39m
}
Failed to load risk predictions: Error: [vitest] No "getRiskPredictions" export is defined on the "@/lib/api" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError [90m(file:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.W28wBIgJ.js:310:17[90m)[39m
    at Object.get [90m(file:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.W28wBIgJ.js:383:16[90m)[39m
    at loadAssessment [90m(/Users/petercrawford/New tool/frontend/[39mcomponents/merchant/RiskAssessmentTab.tsx:134:37[90m)[39m {
  codeFrame: [32m'vi.mock(import("@/lib/api"), async (importOriginal) => {\n'[39m +
    [32m'  const actual = await importOriginal()\n'[39m +
    [32m'  return {\n'[39m +
    [32m'    ...actual,\n'[39m +
    [32m'    // your mocked methods\n'[39m +
    [32m'  }\n'[39m +
    [32m'})'[39m
}

[90mstdout[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render assessment data when loaded
[22m[39m[RiskAssessmentTab] Assessment data received: {
  id: [32m'assessment-123'[39m,
  merchantId: [32m'merchant-123'[39m,
  status: [32m'completed'[39m,
  progress: [33m100[39m,
  options: { includeHistory: [33mtrue[39m, includePredictions: [33mtrue[39m },
  result: { overallScore: [33m0.7[39m, riskLevel: [32m'medium'[39m, factors: [] },
  createdAt: [32m'2025-11-22T18:33:47.660Z'[39m,
  updatedAt: [32m'2025-11-22T18:33:47.660Z'[39m
}
[RiskAssessmentTab] State updated with assessment data
[RiskAssessmentTab] Loading complete

[90mstdout[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render empty state when no assessment
[22m[39m[RiskAssessmentTab] Starting to load assessment: merchant-123

[90mstderr[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render empty state when no assessment
[22m[39mThe current testing environment is not configured to support act(...)
The current testing environment is not configured to support act(...)
The current testing environment is not configured to support act(...)
The current testing environment is not configured to support act(...)

[90mstdout[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render empty state when no assessment
[22m[39m[RiskAssessmentTab] Assessment data received: [1mnull[22m
[RiskAssessmentTab] State updated with assessment data
[RiskAssessmentTab] Loading complete

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mError State with Run Assessment Button[2m > [22m[2mshould display "Run Risk Assessment" button when no assessment exists
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mError State with Run Assessment Button[2m > [22m[2mshould display "Run Risk Assessment" button when no assessment exists
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mError State with Run Assessment Button[2m > [22m[2mshould display "Run Risk Assessment" button when no assessment exists
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m404[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Not Found
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mError Response Handling[2m > [22m[2mshould handle error response with message
[22m[39m[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mError Response Handling[2m > [22m[2mshould handle error response with message
[22m[39m[API] getMerchant: Response received [33m400[39m [33mfalse[39m
[API Debug] Error response - status: [33m400[39m ok: [33mfalse[39m statusText: Bad Request

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mError Response Handling[2m > [22m[2mshould handle error response with message
[22m[39m[API] getMerchant: Making request for merchant-123
[API] getMerchant: Fetching http://localhost:8080/api/v1/merchants/merchant-123

[90mstdout[2m | __tests__/lib/api.test.ts[2m > [22m[2mAPI Client[2m > [22m[2mError Response Handling[2m > [22m[2mshould handle error response with message
[22m[39m[API] getMerchant: Response received [33m400[39m [33mfalse[39m
[API Debug] Error response - status: [33m400[39m ok: [33mfalse[39m statusText: Bad Request

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mError State with Run Assessment Button[2m > [22m[2mshould trigger risk assessment when "Run Risk Assessment" button is clicked
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mError State with Run Assessment Button[2m > [22m[2mshould trigger risk assessment when "Run Risk Assessment" button is clicked
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mError State with Run Assessment Button[2m > [22m[2mshould trigger risk assessment when "Run Risk Assessment" button is clicked
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/risk-score
[MSW] Response status: [33m404[39m
[MSW] Response ok: [33mfalse[39m
[MSW] Response statusText: Not Found
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mResults Display[2m > [22m[2mshould display enrichment results (added/updated/unchanged fields)
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mResults Display[2m > [22m[2mshould display enrichment results (added/updated/unchanged fields)
[22m[39m[MSW] Request matched: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mResults Display[2m > [22m[2mshould display enrichment results (added/updated/unchanged fields)
[22m[39m[MSW] Response mocked: GET http://localhost:8080/api/v1/merchants/merchant-123/enrichment/sources
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mError State with Run Assessment Button[2m > [22m[2mshould trigger risk assessment when "Run Risk Assessment" button is clicked
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/risk/assess

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mError State with Run Assessment Button[2m > [22m[2mshould trigger risk assessment when "Run Risk Assessment" button is clicked
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/risk/assess

[90mstdout[2m | __tests__/components/merchant/RiskExplainabilitySection.test.tsx[2m > [22m[2mRiskExplainabilitySection[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mError State with Run Assessment Button[2m > [22m[2mshould trigger risk assessment when "Run Risk Assessment" button is clicked
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/risk/assess
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

 [32m✓[39m __tests__/components/merchant/RiskExplainabilitySection.test.tsx [2m([22m[2m26 tests[22m[2m)[22m[33m 6120[2mms[22m[39m
       [33m[2m✓[22m[39m should show loading skeleton initially [33m 354[2mms[22m[39m
       [33m[2m✓[22m[39m should display risk explainability section when loaded [33m 314[2mms[22m[39m
       [33m[2m✓[22m[39m should display risk factors table [33m 446[2mms[22m[39m
       [33m[2m✓[22m[39m should display factor scores and weights in table [33m 381[2mms[22m[39m
       [33m[2m✓[22m[39m should handle missing risk assessment [33m 403[2mms[22m[39m
       [33m[2m✓[22m[39m should retry fetching when retry button is clicked [33m 444[2mms[22m[39m
         [33m[2m✓[22m[39m should display export button [33m 360[2mms[22m[39m
         [33m[2m✓[22m[39m should export explanation data when export button is clicked [33m 622[2mms[22m[39m
[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mResults Display[2m > [22m[2mshould display enrichment results (added/updated/unchanged fields)
[22m[39m[MSW] Request started: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mResults Display[2m > [22m[2mshould display enrichment results (added/updated/unchanged fields)
[22m[39m[MSW] Request matched: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger

[90mstdout[2m | __tests__/components/merchant/EnrichmentButton.test.tsx[2m > [22m[2mEnrichmentButton[2m > [22m[2mPhase 4 Enhancements[2m > [22m[2mResults Display[2m > [22m[2mshould display enrichment results (added/updated/unchanged fields)
[22m[39m[MSW] Response mocked: POST http://localhost:8080/api/v1/merchants/merchant-123/enrichment/trigger
[MSW] Response status: [33m200[39m
[MSW] Response ok: [33mtrue[39m
[MSW] Response statusText: OK
[MSW] Response has body
[MSW] Response type: default
[MSW] Response constructor: Response

[90mstderr[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render empty state when no assessment
[22m[39m[MSW] Unhandled request: GET ws://localhost:8080/api/v1/risk/ws

[90mstdout[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render empty state when no assessment
[22m[39m[MSW] Request started: GET http://localhost:8080/api/v1/risk/ws

[90mstderr[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render empty state when no assessment
[22m[39m[MSW] Unhandled request: GET http://localhost:8080/api/v1/risk/ws

[90mstderr[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render empty state when no assessment
[22m[39m[MSW] Unhandled request: GET http://localhost:8080/api/v1/risk/ws

[90mstdout[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render error state on API error
[22m[39m[RiskAssessmentTab] Starting to load assessment: merchant-123

[90mstderr[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render error state on API error
[22m[39m[RiskAssessmentTab] Error loading assessment: Error: Failed to load
    at [90m/Users/petercrawford/New tool/frontend/[39m__tests__/components/merchant/RiskAssessmentTab.test.tsx:132:45
    at [90mfile:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:912:26
    at [90mfile:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1237:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1203:10[90m)[39m
    at [90mfile:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1647:37
    at Traces.$ [90m(file:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///Users/petercrawford/New%20tool/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1647:12[90m)[39m

[90mstdout[2m | __tests__/components/merchant/RiskAssessmentTab.test.tsx[2m > [22m[2mRiskAssessmentTab[2m > [22m[2mshould render error state on API error
[22m[39m[RiskAssessmentTab] Loading complete

Assertion failed: (!uv__io_active(&stream->io_watcher, POLLIN | POLLOUT)), function uv__stream_destroy, file stream.c, line 456.
