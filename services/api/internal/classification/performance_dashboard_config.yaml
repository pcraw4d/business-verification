# Performance Monitoring Dashboard Configuration
# This file configures the performance monitoring dashboard for the KYB Platform

dashboard:
  name: "KYB Classification Performance Dashboard"
  version: "1.0.0"
  refresh_interval: "1m"
  theme: "dark"

# Performance Metrics Configuration
metrics:
  # Response Time Metrics
  response_time:
    enabled: true
    threshold_warning: 2000  # 2 seconds
    threshold_critical: 5000 # 5 seconds
    unit: "ms"
    
  # Accuracy Metrics
  accuracy:
    enabled: true
    threshold_warning: 0.85  # 85%
    threshold_critical: 0.75 # 75%
    unit: "percentage"
    
  # Error Rate Metrics
  error_rate:
    enabled: true
    threshold_warning: 0.03  # 3%
    threshold_critical: 0.05 # 5%
    unit: "percentage"
    
  # Throughput Metrics
  throughput:
    enabled: true
    unit: "requests_per_second"
    
  # Cache Performance
  cache:
    enabled: true
    hit_ratio_threshold: 0.8  # 80%
    unit: "percentage"

# Dashboard Widgets Configuration
widgets:
  # Real-time Performance Overview
  performance_overview:
    type: "gauge"
    title: "Current Performance Status"
    position: { row: 1, col: 1, width: 4, height: 2 }
    metrics:
      - response_time
      - accuracy
      - error_rate
      
  # Response Time Trend
  response_time_trend:
    type: "line_chart"
    title: "Response Time Trend (Last 24 Hours)"
    position: { row: 1, col: 5, width: 8, height: 3 }
    time_range: "24h"
    metrics:
      - response_time
      
  # Accuracy Trend
  accuracy_trend:
    type: "line_chart"
    title: "Classification Accuracy Trend (Last 24 Hours)"
    position: { row: 4, col: 1, width: 6, height: 3 }
    time_range: "24h"
    metrics:
      - accuracy
      
  # Error Rate Trend
  error_rate_trend:
    type: "line_chart"
    title: "Error Rate Trend (Last 24 Hours)"
    position: { row: 4, col: 7, width: 6, height: 3 }
    time_range: "24h"
    metrics:
      - error_rate
      
  # Throughput Chart
  throughput_chart:
    type: "bar_chart"
    title: "Request Throughput (Last Hour)"
    position: { row: 7, col: 1, width: 6, height: 3 }
    time_range: "1h"
    metrics:
      - throughput
      
  # Cache Performance
  cache_performance:
    type: "pie_chart"
    title: "Cache Hit Ratio"
    position: { row: 7, col: 7, width: 6, height: 3 }
    metrics:
      - cache
      
  # Top Industries
  top_industries:
    type: "table"
    title: "Top Classified Industries (Last 24 Hours)"
    position: { row: 10, col: 1, width: 12, height: 4 }
    time_range: "24h"
    sort_by: "count"
    limit: 10
    
  # Performance Alerts
  performance_alerts:
    type: "alert_list"
    title: "Active Performance Alerts"
    position: { row: 14, col: 1, width: 12, height: 3 }
    alert_levels:
      - critical
      - warning
      - info

# Alerting Configuration
alerting:
  enabled: true
  
  # Alert Channels
  channels:
    email:
      enabled: true
      recipients:
        - "admin@kyb-platform.com"
        - "devops@kyb-platform.com"
      template: "performance_alert_email"
      
    slack:
      enabled: true
      webhook_url: "${SLACK_WEBHOOK_URL}"
      channel: "#kyb-alerts"
      
    webhook:
      enabled: true
      url: "${ALERT_WEBHOOK_URL}"
      
  # Alert Rules
  rules:
    high_response_time:
      condition: "response_time > 5000"
      severity: "critical"
      message: "Response time exceeds 5 seconds"
      cooldown: "5m"
      
    low_accuracy:
      condition: "accuracy < 0.75"
      severity: "critical"
      message: "Classification accuracy below 75%"
      cooldown: "10m"
      
    high_error_rate:
      condition: "error_rate > 0.05"
      severity: "warning"
      message: "Error rate exceeds 5%"
      cooldown: "5m"
      
    low_cache_hit_ratio:
      condition: "cache_hit_ratio < 0.8"
      severity: "warning"
      message: "Cache hit ratio below 80%"
      cooldown: "15m"

# Data Retention Configuration
retention:
  # Metrics retention periods
  metrics:
    raw_data: "7d"      # Keep raw metrics for 7 days
    aggregated_1h: "30d" # Keep 1-hour aggregates for 30 days
    aggregated_1d: "1y"  # Keep daily aggregates for 1 year
    
  # Log retention
  logs:
    performance_logs: "14d"
    error_logs: "30d"
    audit_logs: "1y"

# Export Configuration
export:
  # Data export formats
  formats:
    - json
    - csv
    - prometheus
    
  # Export destinations
  destinations:
    prometheus:
      enabled: true
      endpoint: "/metrics"
      port: 9090
      
    grafana:
      enabled: true
      datasource: "prometheus"
      
    elasticsearch:
      enabled: false
      endpoint: "${ELASTICSEARCH_URL}"
      index: "kyb-performance"

# Security Configuration
security:
  # Authentication
  auth:
    enabled: true
    method: "jwt"
    token_expiry: "24h"
    
  # Authorization
  authorization:
    roles:
      admin:
        permissions:
          - "read:all"
          - "write:all"
          - "delete:all"
      viewer:
        permissions:
          - "read:dashboard"
          - "read:metrics"
      operator:
        permissions:
          - "read:all"
          - "write:alerts"
          
  # Rate Limiting
  rate_limiting:
    enabled: true
    requests_per_minute: 100
    burst_size: 20

# Performance Optimization
optimization:
  # Caching
  caching:
    enabled: true
    ttl: "5m"
    max_size: "100MB"
    
  # Query Optimization
  query_optimization:
    enabled: true
    max_query_time: "30s"
    result_limit: 10000
    
  # Background Processing
  background_processing:
    enabled: true
    worker_pool_size: 10
    queue_size: 1000
