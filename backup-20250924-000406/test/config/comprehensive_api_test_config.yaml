# Comprehensive API Endpoint Test Configuration
# Configuration for subtask 4.2.1 - API Endpoint Testing

# Test Environment Configuration
test_environment:
  name: "comprehensive_api_testing"
  description: "Comprehensive API endpoint testing for KYB Platform"
  version: "1.0.0"
  
# Test Categories Configuration
test_categories:
  business_related:
    enabled: true
    description: "Business-related API endpoints testing"
    endpoints:
      - classification:
          - single_classification: "/v1/classify"
          - batch_classification: "/v1/classify/batch"
          - get_classification: "/v1/classify/{business_id}"
          - classification_history: "/v1/classify/history"
      - merchant_management:
          - create_merchant: "/v1/merchants"
          - get_merchant: "/v1/merchants/{merchant_id}"
          - update_merchant: "/v1/merchants/{merchant_id}"
          - delete_merchant: "/v1/merchants/{merchant_id}"
      - risk_assessment:
          - assess_risk: "/v1/risk/assess"
          - get_risk: "/v1/risk/{business_id}"
          - risk_history: "/v1/risk/history/{business_id}"
          - enhanced_assessment: "/v1/risk/enhanced/assess"
          - risk_alerts: "/v1/risk/alerts"
  
  classification:
    enabled: true
    description: "Classification-specific API endpoints testing"
    endpoints:
      - enhanced_classification:
          - v2_classify: "/v2/classify"
          - v2_batch_classify: "/v2/classify/batch"
      - classification_monitoring:
          - accuracy_metrics: "/v1/monitoring/accuracy/metrics"
          - track_classification: "/v1/monitoring/accuracy/track"
          - misclassifications: "/v1/monitoring/misclassifications"
          - error_patterns: "/v1/monitoring/patterns"
          - error_statistics: "/v1/monitoring/statistics"
  
  user_management:
    enabled: true
    description: "User management API endpoints testing"
    endpoints:
      - authentication:
          - register: "/v1/auth/register"
          - login: "/v1/auth/login"
          - logout: "/v1/auth/logout"
          - refresh_token: "/v1/auth/refresh"
      - profile_management:
          - get_profile: "/v1/users/profile"
          - update_profile: "/v1/users/profile"
      - api_key_management:
          - get_api_keys: "/v1/users/api-keys"
          - create_api_key: "/v1/users/api-keys"
          - delete_api_key: "/v1/users/api-keys/{key_id}"
  
  monitoring:
    enabled: true
    description: "Monitoring API endpoints testing"
    endpoints:
      - health_status:
          - health_check: "/health"
          - detailed_status: "/v1/status"
      - metrics:
          - system_metrics: "/v1/metrics"
          - classification_analytics: "/v1/analytics/classification"
          - performance_analytics: "/v1/analytics/performance"
      - monitoring_alerts:
          - active_alerts: "/v1/monitoring/alerts"
          - alert_history: "/v1/monitoring/alerts/history"
          - resolve_alert: "/v1/monitoring/alerts/{alert_id}/resolve"
      - compliance:
          - check_compliance: "/v1/compliance/check"
          - compliance_status: "/v1/compliance/status/{business_id}"
          - compliance_reports: "/v1/compliance/reports"

# Test Data Configuration
test_data:
  business_data:
    valid_business:
      business_name: "Test Business Corporation"
      address: "123 Test Street, Test City, TC 12345"
      website: "https://testbusiness.com"
      description: "A technology company specializing in software development"
      contact_email: "contact@testbusiness.com"
      phone: "+1-555-123-4567"
    
    minimal_business:
      business_name: "Minimal Business"
      address: "456 Minimal Ave"
    
    complex_business:
      business_name: "Complex Multi-Industry Corporation"
      address: "789 Complex Boulevard, Complex City, CC 54321"
      website: "https://complexcorp.com"
      description: "A diversified corporation operating in technology, healthcare, and financial services"
      contact_email: "info@complexcorp.com"
      phone: "+1-555-987-6543"
      industry_codes:
        - "541511"
        - "621111"
        - "522110"
  
  user_data:
    valid_user:
      email: "test@example.com"
      password: "securepassword123"
      full_name: "Test User"
      company: "Test Company Inc"
    
    api_key_data:
      name: "Test API Key"
      description: "API key for testing purposes"
      permissions: ["classify", "read", "monitor"]
  
  risk_data:
    low_risk_business:
      business_name: "Low Risk Retail Store"
      industry: "retail"
      risk_factors: []
    
    high_risk_business:
      business_name: "High Risk Financial Services"
      industry: "financial_services"
      risk_factors: ["high_volume_transactions", "international_operations"]

# Performance Test Configuration
performance_tests:
  enabled: true
  thresholds:
    classification_endpoint: "2s"
    health_check: "100ms"
    metrics_endpoint: "500ms"
    batch_classification: "5s"
    risk_assessment: "3s"
  
  load_testing:
    enabled: false
    concurrent_requests: 10
    duration: "1m"
    ramp_up_time: "10s"

# Error Handling Test Configuration
error_handling_tests:
  enabled: true
  test_cases:
    - name: "Invalid JSON body"
      method: "POST"
      path: "/v1/classify"
      body: "invalid json"
      expected_status: 400
    
    - name: "Missing required fields"
      method: "POST"
      path: "/v1/classify"
      body: {}
      expected_status: 400
    
    - name: "Non-existent business ID"
      method: "GET"
      path: "/v1/classify/non-existent-id"
      expected_status: 404
    
    - name: "Unauthorized access"
      method: "GET"
      path: "/v1/users/profile"
      expected_status: 401
    
    - name: "Invalid authentication token"
      method: "GET"
      path: "/v1/users/profile"
      headers:
        Authorization: "Bearer invalid-token"
      expected_status: 401

# Security Test Configuration
security_tests:
  enabled: true
  test_cases:
    - name: "SQL injection attempt"
      method: "POST"
      path: "/v1/classify"
      body:
        business_name: "'; DROP TABLE users; --"
        address: "123 Test St"
      expected_status: 400
    
    - name: "XSS attempt"
      method: "POST"
      path: "/v1/classify"
      body:
        business_name: "<script>alert('xss')</script>"
        address: "123 Test St"
      expected_status: 400
    
    - name: "Rate limiting test"
      method: "POST"
      path: "/v1/classify"
      requests_per_minute: 100
      expected_status: 429

# Test Execution Configuration
execution:
  timeout: "10m"
  parallel: true
  max_parallel: 5
  retry_failed: true
  max_retries: 3
  
  environment_variables:
    INTEGRATION_TESTS: "true"
    PERFORMANCE_TESTS: "false"
    COVERAGE: "true"
    VERBOSE: "false"

# Reporting Configuration
reporting:
  enabled: true
  formats: ["json", "html", "markdown"]
  output_directory: "test/reports"
  coverage_directory: "test/coverage"
  
  metrics:
    - response_time
    - success_rate
    - error_rate
    - coverage_percentage
  
  alerts:
    enabled: true
    thresholds:
      success_rate: 95
      max_response_time: "5s"
      min_coverage: 80

# Mock Services Configuration
mock_services:
  classification_service:
    enabled: true
    response_time: "100ms"
    success_rate: 99.9
  
  auth_service:
    enabled: true
    response_time: "50ms"
    success_rate: 99.9
  
  risk_service:
    enabled: true
    response_time: "200ms"
    success_rate: 99.9
  
  monitoring_service:
    enabled: true
    response_time: "50ms"
    success_rate: 99.9

# Database Configuration
database:
  test_database:
    enabled: true
    type: "postgresql"
    host: "localhost"
    port: 5432
    name: "kyb_test"
    username: "test_user"
    password: "test_password"
  
  cleanup:
    enabled: true
    after_tests: true
    before_tests: true

# Logging Configuration
logging:
  level: "info"
  format: "json"
  output: "file"
  file_path: "test/logs/comprehensive_api_tests.log"
  
  structured_logging:
    enabled: true
    fields:
      - test_name
      - endpoint
      - method
      - status_code
      - response_time
      - error_message
