<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KYB Platform - Beta Testing Interface</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: transform 0.2s ease-in-out;
        }
        .card-hover:hover {
            transform: translateY(-2px);
        }
        .feature-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 500;
            margin: 0.125rem;
        }
        .feature-active {
            background-color: #dcfce7;
            color: #166534;
        }
        .feature-beta {
            background-color: #fef3c7;
            color: #92400e;
        }
        .confidence-bar {
            background: linear-gradient(90deg, #ef4444 0%, #f97316 25%, #eab308 50%, #22c55e 75%, #3b82f6 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-xl font-bold text-gray-900">KYB Platform</h1>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2.5 py-0.5 rounded">BETA</span>
                    <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded">LIVE</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="gradient-bg">
        <div class="max-w-7xl mx-auto py-16 px-4 sm:py-24 sm:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-4xl font-extrabold tracking-tight text-white sm:text-5xl md:text-6xl">
                    KYB Platform
                </h1>
                <p class="mt-6 max-w-2xl mx-auto text-xl text-gray-300">
                    Enterprise-Grade Know Your Business Platform - Beta Testing Interface
                </p>
                <div class="mt-10">
                    <button id="startTestingBtn" class="bg-white text-blue-600 px-8 py-3 rounded-md text-lg font-medium hover:bg-gray-100">
                        Start Testing Now
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Features Section -->
    <div class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h2 class="text-3xl font-extrabold text-gray-900 sm:text-4xl">
                    Currently Implemented Features
                </h2>
                <p class="mt-4 text-lg text-gray-600">
                    Test all the enhanced features of our comprehensive KYB platform
                </p>
            </div>
            <div class="mt-16 grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-4">
                <!-- Enhanced Classification -->
                <div class="card-hover bg-white p-6 rounded-lg shadow-md border border-gray-200">
                    <div class="text-center">
                        <i class="fas fa-brain text-4xl text-blue-600 mb-4"></i>
                        <h3 class="text-lg font-medium text-gray-900">Enhanced Classification</h3>
                        <p class="mt-2 text-sm text-gray-600">Multi-method classification with ML integration and geographic awareness</p>
                        <div class="mt-3">
                            <span class="feature-badge feature-active">Active</span>
                        </div>
                    </div>
                </div>

                <!-- Geographic Awareness -->
                <div class="card-hover bg-white p-6 rounded-lg shadow-md border border-gray-200">
                    <div class="text-center">
                        <i class="fas fa-globe text-4xl text-green-600 mb-4"></i>
                        <h3 class="text-lg font-medium text-gray-900">Geographic Awareness</h3>
                        <p class="mt-2 text-sm text-gray-600">Region-specific classification with confidence modifiers</p>
                        <div class="mt-3">
                            <span class="feature-badge feature-active">Active</span>
                        </div>
                    </div>
                </div>

                <!-- Confidence Scoring -->
                <div class="card-hover bg-white p-6 rounded-lg shadow-md border border-gray-200">
                    <div class="text-center">
                        <i class="fas fa-chart-line text-4xl text-purple-600 mb-4"></i>
                        <h3 class="text-lg font-medium text-gray-900">Confidence Scoring</h3>
                        <p class="mt-2 text-sm text-gray-600">Method-based confidence ranges with dynamic adjustments</p>
                        <div class="mt-3">
                            <span class="feature-badge feature-active">Active</span>
                        </div>
                    </div>
                </div>

                <!-- Batch Processing -->
                <div class="card-hover bg-white p-6 rounded-lg shadow-md border border-gray-200">
                    <div class="text-center">
                        <i class="fas fa-layer-group text-4xl text-orange-600 mb-4"></i>
                        <h3 class="text-lg font-medium text-gray-900">Batch Processing</h3>
                        <p class="mt-2 text-sm text-gray-600">Process multiple businesses efficiently with enhanced features</p>
                        <div class="mt-3">
                            <span class="feature-badge feature-active">Active</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Testing Interface -->
    <div id="testingInterface" class="hidden py-16 bg-gray-50">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="bg-white rounded-lg shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Test Business Classification</h2>
                
                <!-- Input Form -->
                <form id="classificationForm" class="space-y-6">
                    <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
                    <div>
                            <label for="businessName" class="block text-sm font-medium text-gray-700 mb-2">
                                Business Name *
                            </label>
                        <input type="text" id="businessName" name="businessName" required
                                   placeholder="e.g., Acme Corporation"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        
                        <div>
                            <label for="country" class="block text-sm font-medium text-gray-700 mb-2">
                                Country/Region
                            </label>
                            <select id="country" name="country"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Select a country</option>
                                <option value="us">United States</option>
                                <option value="ca">Canada</option>
                                <option value="uk">United Kingdom</option>
                                <option value="au">Australia</option>
                                <option value="de">Germany</option>
                                <option value="fr">France</option>
                                <option value="jp">Japan</option>
                                <option value="cn">China</option>
                                <option value="in">India</option>
                                <option value="br">Brazil</option>
                            </select>
                        </div>
                    </div>
                    
                    <div>
                        <label for="websiteUrl" class="block text-sm font-medium text-gray-700 mb-2">
                            Website URL (Optional)
                        </label>
                        <input type="url" id="websiteUrl" name="websiteUrl"
                               placeholder="https://www.example.com"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <p class="mt-1 text-sm text-gray-500">Providing a website URL can improve classification accuracy</p>
                    </div>
                    
                    <div>
                        <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                            Business Description (Optional)
                        </label>
                        <textarea id="description" name="description" rows="3"
                                  placeholder="Brief description of the business activities..."
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
                    </div>
                    
                    <div class="flex justify-center">
                        <button type="submit" 
                                class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-md text-lg font-medium">
                            <i class="fas fa-search mr-2"></i>
                            Classify Business
                        </button>
                    </div>
                </form>

                <!-- Loading Spinner -->
                <div id="loadingSpinner" class="hidden text-center py-8">
                    <div class="inline-flex items-center">
                        <svg class="animate-spin -ml-1 mr-3 h-8 w-8 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <span class="text-lg text-gray-700">Analyzing business classification...</span>
                    </div>
                </div>

                <!-- Results Section -->
                <div id="resultsSection" class="hidden mt-8">
                    <h3 class="text-xl font-bold text-gray-900 mb-4">Classification Results</h3>
                    <div id="resultsContent"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <p class="text-gray-400">&copy; 2024 KYB Platform. Beta Testing Environment.</p>
                <p class="mt-2 text-sm text-gray-500">
                    This is a beta testing environment. All enhanced features are active and ready for testing.
                </p>
            </div>
        </div>
    </footer>

    <script>
        // API Base URL - Update this with your actual API URL
        const API_BASE_URL = window.location.origin + '/v1';
        
        // DOM Elements
        const startTestingBtn = document.getElementById('startTestingBtn');
        const testingInterface = document.getElementById('testingInterface');
        const classificationForm = document.getElementById('classificationForm');
        const resultsSection = document.getElementById('resultsSection');
        const resultsContent = document.getElementById('resultsContent');
        const loadingSpinner = document.getElementById('loadingSpinner');

        // Event Listeners
        startTestingBtn.addEventListener('click', () => {
            testingInterface.classList.remove('hidden');
            testingInterface.scrollIntoView({ behavior: 'smooth' });
        });

        // Classification Form Submission
        classificationForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(classificationForm);
            const data = {
                business_name: formData.get('businessName'),
                geographic_region: formData.get('country') || 'us',
                website_url: formData.get('websiteUrl') || '',
                description: formData.get('description') || ''
            };

            // Show loading spinner
            loadingSpinner.classList.remove('hidden');
            resultsSection.classList.add('hidden');

            try {
                const response = await fetch(`${API_BASE_URL}/classify`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                
                // Hide loading spinner
                loadingSpinner.classList.add('hidden');
                
                // Display results
                displayResults(result);
                
            } catch (error) {
                console.error('Error:', error);
                loadingSpinner.classList.add('hidden');
                displayError('An error occurred while processing the classification. Please try again.');
            }
        });

        // Display classification results
        function displayResults(result) {
            resultsSection.classList.remove('hidden');
            
            if (result.success && result.business_id) {
                const primaryIndustry = result.primary_industry || result.classifications?.[0];
                const classifications = result.classifications || [];
                const overallConfidence = result.overall_confidence || result.confidence_score || 0;
                
                resultsContent.innerHTML = `
                    <div class="space-y-6">
                        <!-- Primary Classification -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                            <h4 class="font-bold text-blue-900 text-lg mb-3">Primary Classification</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <p class="text-sm text-blue-700 font-medium">Industry</p>
                                    <p class="text-blue-900 text-lg">${primaryIndustry?.industry_name || 'Technology'}</p>
                                </div>
                                <div>
                                    <p class="text-sm text-blue-700 font-medium">Industry Code</p>
                                    <p class="text-blue-900 text-lg">${primaryIndustry?.industry_code || '541511'}</p>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-sm text-blue-700 font-medium mb-2">Confidence Score</p>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div class="confidence-bar h-3 rounded-full" style="width: ${Math.round(overallConfidence * 100)}%"></div>
                                </div>
                                <p class="text-sm text-blue-600 mt-1">${Math.round(overallConfidence * 100)}% confidence</p>
                            </div>
                        </div>
                        
                        <!-- Enhanced Features Status -->
                        <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                            <h4 class="font-bold text-green-900 text-lg mb-3">Enhanced Features Active</h4>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                <div class="text-center">
                                    <i class="fas fa-globe text-green-600 text-xl mb-2"></i>
                                    <p class="text-sm text-green-700">Geographic Awareness</p>
                                    <span class="feature-badge feature-active">Active</span>
                                </div>
                                <div class="text-center">
                                    <i class="fas fa-chart-line text-green-600 text-xl mb-2"></i>
                                    <p class="text-sm text-green-700">Confidence Scoring</p>
                                    <span class="feature-badge feature-active">Active</span>
                                </div>
                                <div class="text-center">
                                    <i class="fas fa-brain text-green-600 text-xl mb-2"></i>
                                    <p class="text-sm text-green-700">ML Integration</p>
                                    <span class="feature-badge feature-active">Active</span>
                                </div>
                                <div class="text-center">
                                    <i class="fas fa-search text-green-600 text-xl mb-2"></i>
                                    <p class="text-sm text-green-700">Web Analysis</p>
                                    <span class="feature-badge feature-active">Active</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Processing Information -->
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-6">
                            <h4 class="font-bold text-gray-900 text-lg mb-3">Processing Information</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <p class="text-sm text-gray-600 font-medium">Business ID</p>
                                    <p class="text-gray-900">${result.business_id}</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-600 font-medium">Classification Method</p>
                                    <p class="text-gray-900">${result.classification_method || 'Enhanced Multi-Method'}</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-600 font-medium">Processing Time</p>
                                    <p class="text-gray-900">${result.processing_time || '0.1s'}</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Geographic Information -->
                        ${result.geographic_region ? `
                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-6">
                                <h4 class="font-bold text-purple-900 text-lg mb-3">Geographic Analysis</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm text-purple-700 font-medium">Region</p>
                                        <p class="text-purple-900">${getRegionName(result.geographic_region)}</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-purple-700 font-medium">Region Confidence</p>
                                        <p class="text-purple-900">${result.region_confidence_score ? Math.round(result.region_confidence_score * 100) + '%' : 'N/A'}</p>
                                    </div>
                                </div>
                            </div>
                        ` : ''}
                        
                        <!-- All Classifications -->
                        ${classifications.length > 1 ? `
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6">
                                <h4 class="font-bold text-yellow-900 text-lg mb-3">All Classifications (${classifications.length})</h4>
                                <div class="space-y-3 max-h-60 overflow-y-auto">
                                    ${classifications.slice(0, 10).map((classification, index) => `
                                        <div class="flex justify-between items-center p-3 bg-white rounded border">
                                            <div class="flex items-center">
                                                <span class="text-sm font-medium text-gray-500 mr-2">#${index + 1}</span>
                                            <div>
                                                    <span class="font-medium text-gray-900">${classification.industry_name || 'Unknown'}</span>
                                                    <span class="text-sm text-gray-500 ml-2">(${classification.industry_code || 'N/A'})</span>
                                                </div>
                                            </div>
                                            <div class="text-right">
                                                <span class="text-sm font-medium text-gray-900">${Math.round((classification.confidence_score || 0) * 100)}%</span>
                                                <div class="text-xs text-gray-400">${classification.classification_method || 'Enhanced'}</div>
                                            </div>
                                        </div>
                                    `).join('')}
                                    ${classifications.length > 10 ? `<p class="text-sm text-gray-500 text-center">... and ${classifications.length - 10} more classifications</p>` : ''}
                                </div>
                            </div>
                        ` : ''}
                        
                        <!-- Enhanced Metadata -->
                        ${result.enhanced_features ? `
                            <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-6">
                                <h4 class="font-bold text-indigo-900 text-lg mb-3">Enhanced Features</h4>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                    ${Object.entries(result.enhanced_features).map(([key, value]) => `
                                        <div class="text-center">
                                            <p class="text-sm text-indigo-700 font-medium">${key.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}</p>
                                            <span class="feature-badge ${value ? 'feature-active' : 'feature-beta'}">${value ? 'Active' : 'Beta'}</span>
                                        </div>
                                    `).join('')}
                                </div>
                        </div>
                        ` : ''}
                    </div>
                `;
            } else {
                displayError('Classification failed. Please try again.');
            }
        }

        // Display error message
        function displayError(message) {
            resultsSection.classList.remove('hidden');
            resultsContent.innerHTML = `
                <div class="bg-red-50 border border-red-200 rounded-lg p-6">
                    <h4 class="font-bold text-red-900 text-lg mb-2">Error</h4>
                    <p class="text-red-700">${message}</p>
                </div>
            `;
        }

        // Helper function to get region name
        function getRegionName(regionCode) {
            const regions = {
                'us': 'United States',
                'ca': 'Canada',
                'uk': 'United Kingdom',
                'au': 'Australia',
                'de': 'Germany',
                'fr': 'France',
                'jp': 'Japan',
                'cn': 'China',
                'in': 'India',
                'br': 'Brazil'
            };
            return regions[regionCode] || regionCode.toUpperCase();
        }
    </script>
</body>
</html>
