# Development Environment Configuration
# Risk Assessment Service - Development Settings

environment: "development"

# Service Configuration
service:
  name: "risk-assessment-service"
  version: "1.0.0"
  description: "Enhanced Risk Assessment Service with ML-powered predictions"
  port: "8080"
  host: "0.0.0.0"

# Server Configuration
server:
  port: "8080"
  read_timeout: "30s"
  write_timeout: "30s"
  idle_timeout: "120s"
  max_header_bytes: 1048576  # 1MB

# Database Configuration (Supabase)
database:
  url: "${DATABASE_URL}"
  max_open_conns: 10
  max_idle_conns: 5
  conn_max_lifetime: "1h"
  conn_max_idle_time: "30m"
  ssl_mode: "require"

# Supabase Configuration
supabase:
  url: "${SUPABASE_URL}"
  anon_key: "${SUPABASE_ANON_KEY}"
  service_role_key: "${SUPABASE_SERVICE_ROLE_KEY}"
  jwt_secret: "${SUPABASE_JWT_SECRET}"

# Redis Configuration
redis:
  url: "${REDIS_URL}"
  password: "${REDIS_PASSWORD}"
  db: 0
  pool_size: 10
  min_idle_conns: 2
  max_idle_conns: 5
  dial_timeout: "5s"
  read_timeout: "3s"
  write_timeout: "3s"
  pool_timeout: "4s"
  idle_timeout: "5m"
  max_retries: 3
  min_retry_backoff: "8ms"
  max_retry_backoff: "512ms"
  enable_fallback: true
  fallback_to_memory: true
  key_prefix: "dev:ra:"

# Logging Configuration
logging:
  level: "debug"
  format: "console"  # console or json
  output: "stdout"
  enable_caller: true
  enable_stacktrace: true

# Monitoring Configuration
monitoring:
  enabled: true
  metrics_enabled: true
  health_check_interval: "30s"
  performance_monitoring: true

# Rate Limiting Configuration
rate_limiting:
  enabled: true
  requests_per_minute: 1000  # More permissive for development
  burst_allowance: 100
  window_size: "1m"
  use_redis: false  # Use in-memory for development
  redis_key_prefix: "dev:rate_limit:"

# Authentication Configuration
authentication:
  require_auth: false  # Disable auth for development
  allow_service_auth: true
  allow_api_key_auth: true
  allow_jwt_auth: true
  jwt_secret: "${JWT_SECRET}"
  api_key_header: "X-API-Key"
  service_token: "${SERVICE_TOKEN}"
  token_cache_ttl: "1h"

# Security Configuration
security:
  allowed_origins:
    - "*"  # Allow all origins in development
  allowed_methods:
    - "GET"
    - "POST"
    - "PUT"
    - "DELETE"
    - "OPTIONS"
    - "PATCH"
  allowed_headers:
    - "Content-Type"
    - "Authorization"
    - "X-Requested-With"
    - "X-API-Key"
    - "X-User-ID"
    - "X-Tenant-ID"
    - "X-Service-Token"
    - "X-Service-ID"
  allow_credentials: true
  max_age: 86400
  request_size_limit: 52428800  # 50MB for development
  request_timeout: "60s"
  enable_hsts: false
  enable_csp: false
  enable_xss_protection: true
  enable_frame_options: true
  enable_content_type_options: true
  enable_referrer_policy: true

# ML Configuration
ml:
  models_path: "./models"
  cache_enabled: true
  cache_ttl: "1h"
  batch_size: 100
  max_concurrent_requests: 10
  model_update_interval: "24h"
  enable_model_validation: true
  validation_threshold: 0.8

# External APIs Configuration
external_apis:
  newsapi:
    base_url: "https://newsapi.org/v2"
    api_key: "${NEWSAPI_KEY}"
    timeout: "10s"
    retry_attempts: 3
    retry_delay: "1s"
    rate_limit: 1000  # requests per day
    
  opencorporates:
    base_url: "https://api.opencorporates.com/v0.4"
    api_key: "${OPENCORPORATES_API_KEY}"
    timeout: "10s"
    retry_attempts: 3
    retry_delay: "1s"
    rate_limit: 500  # requests per month
    
  thomson_reuters:
    base_url: "https://api.thomsonreuters.com"
    api_key: "${THOMSON_REUTERS_API_KEY}"
    timeout: "15s"
    retry_attempts: 3
    retry_delay: "2s"
    rate_limit: 10000  # requests per month
    
  ofac:
    base_url: "https://api.treasury.gov"
    api_key: "${OFAC_API_KEY}"
    timeout: "10s"
    retry_attempts: 3
    retry_delay: "1s"
    rate_limit: 1000  # requests per day

# Webhook Configuration
webhooks:
  enabled: true
  max_retries: 3
  retry_delay: "5s"
  timeout: "10s"
  signature_validation: false  # Disable for development
  rate_limit: 100  # webhooks per minute

# Batch Processing Configuration
batch_processing:
  enabled: true
  max_batch_size: 1000
  processing_timeout: "30m"
  worker_pool_size: 5
  queue_size: 10000
  retry_attempts: 3
  retry_delay: "10s"

# Performance Configuration
performance:
  enable_profiling: true
  profiling_port: "6060"
  enable_tracing: true
  trace_sample_rate: 1.0  # 100% sampling in development
  enable_metrics: true
  metrics_port: "9090"

# Development-specific Settings
development:
  enable_debug_endpoints: true
  enable_swagger: true
  swagger_path: "/docs"
  enable_cors_debug: true
  mock_external_apis: true
  enable_test_data: true
  test_data_path: "./testdata"
  enable_hot_reload: true
  log_sql_queries: true
  log_redis_commands: true
  enable_performance_logging: true

# Testing Configuration
testing:
  enabled: true
  test_database_url: "${TEST_DATABASE_URL}"
  test_redis_url: "${TEST_REDIS_URL}"
  test_timeout: "30s"
  enable_mocks: true
  mock_external_services: true
  test_data_cleanup: true

# Feature Flags
feature_flags:
  enable_advanced_ml: true
  enable_batch_processing: true
  enable_webhooks: true
  enable_real_time_updates: true
  enable_analytics: true
  enable_audit_logging: true
  enable_performance_monitoring: true
  enable_circuit_breaker: true
  enable_retry_logic: true
  enable_caching: true
  enable_compression: true
  enable_rate_limiting: true
  enable_authentication: false  # Disabled for development
  enable_authorization: false   # Disabled for development
  enable_encryption: false      # Disabled for development
  enable_ssl: false             # Disabled for development

# Debug Configuration
debug:
  enable_pprof: true
  enable_trace: true
  enable_metrics: true
  log_level: "debug"
  log_requests: true
  log_responses: true
  log_errors: true
  log_performance: true
  log_database_queries: true
  log_redis_operations: true
  log_external_api_calls: true
  log_ml_predictions: true
  log_webhook_deliveries: true
  log_batch_processing: true
