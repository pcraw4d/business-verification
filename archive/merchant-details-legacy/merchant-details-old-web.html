<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merchant Details - KYB Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="components/navigation.js"></script>
    <script src="components/merchant-context.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s ease-in-out;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .confidence-bar {
            background: linear-gradient(90deg, #ef4444 0%, #f97316 25%, #eab308 50%, #22c55e 75%, #3b82f6 100%);
        }
        .risk-gauge {
            background: conic-gradient(from 0deg, #ef4444 0deg, #f97316 72deg, #eab308 144deg, #22c55e 216deg, #3b82f6 288deg, #ef4444 360deg);
        }
        .expandable-section {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
        }
        .expandable-section.expanded {
            max-height: 1000px;
        }
        .skeleton-loading {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        .progressive-disclosure {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s ease-in-out;
        }
        .progressive-disclosure.visible {
            opacity: 1;
            transform: translateY(0);
        }
        /* Enhanced Risk Level Styles */
        .risk-indicator {
            position: relative;
            transition: all 0.3s ease-in-out;
        }
        .risk-indicator:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        .risk-badge {
            position: relative;
            overflow: hidden;
            border: 2px solid;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .risk-badge::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }
        .risk-badge:hover::before {
            left: 100%;
        }
        .risk-low {
            background: linear-gradient(135deg, #10b981, #059669);
            border-color: #047857;
            color: white;
        }
        .risk-medium {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            border-color: #b45309;
            color: white;
        }
        .risk-high {
            background: linear-gradient(135deg, #f97316, #ea580c);
            border-color: #c2410c;
            color: white;
        }
        .risk-critical {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border-color: #b91c1c;
            color: white;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        .risk-trend {
            position: relative;
            display: inline-flex;
            align-items: center;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }
        .trend-up {
            background: #fef2f2;
            color: #dc2626;
        }
        .trend-down {
            background: #f0fdf4;
            color: #16a34a;
        }
        .trend-stable {
            background: #f8fafc;
            color: #6b7280;
        }
        
        /* Risk Keywords Section Styles */
        .risk-keywords-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 24px;
            overflow: hidden;
        }
        
        .risk-keywords-section h4 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin: 0;
            padding: 16px 20px;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
        }
        
        .risk-keywords-section h4 i {
            margin-right: 8px;
            font-size: 16px;
        }
        
        .risk-overview {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .risk-summary {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 16px;
        }
        
        .risk-level-indicator {
            display: flex;
            align-items: center;
        }
        
        .risk-badge {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease-in-out;
            cursor: pointer;
        }
        
        .risk-badge i {
            margin-right: 6px;
            font-size: 12px;
        }
        
        .risk-metrics {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
        }
        
        .risk-metric {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        .risk-metric-label {
            font-size: 12px;
            color: #6b7280;
            font-weight: 500;
            margin-bottom: 4px;
        }
        
        .risk-metric-value {
            font-size: 16px;
            font-weight: 700;
            color: #1f2937;
        }
        
        .risk-categories {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .risk-category {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 8px;
            transition: all 0.3s ease-in-out;
            cursor: pointer;
        }
        
        .risk-category:hover {
            transform: translateX(4px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .risk-category-info {
            display: flex;
            align-items: center;
            flex: 1;
        }
        
        .risk-category-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 14px;
        }
        
        .risk-category-details h5 {
            margin: 0 0 4px 0;
            font-size: 14px;
            font-weight: 600;
            color: #1f2937;
        }
        
        .risk-category-details p {
            margin: 0;
            font-size: 12px;
            color: #6b7280;
        }
        
        .risk-category-count {
            background: #f3f4f6;
            color: #374151;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .detected-keywords {
            padding: 20px;
        }
        
        .keywords-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        
        .keywords-header h5 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
        }
        
        .keywords-toggle {
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            font-size: 12px;
            text-decoration: underline;
        }
        
        .keywords-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 8px;
        }
        
        .keyword-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s ease-in-out;
            cursor: pointer;
            position: relative;
        }
        
        .keyword-item:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .keyword-severity {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
            flex-shrink: 0;
        }
        
        .keyword-text {
            flex: 1;
            margin-right: 8px;
        }
        
        .keyword-category {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        /* Risk Category Background Colors */
        .risk-category-bg-low {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border: 1px solid #bbf7d0;
        }
        
        .risk-category-bg-medium {
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
            border: 1px solid #fde68a;
        }
        
        .risk-category-bg-high {
            background: linear-gradient(135deg, #fff7ed, #fed7aa);
            border: 1px solid #fdba74;
        }
        
        .risk-category-bg-critical {
            background: linear-gradient(135deg, #fef2f2, #fecaca);
            border: 1px solid #fca5a5;
        }
        
        /* Keyword Severity Colors */
        .severity-low {
            background-color: #10b981;
        }
        
        .severity-medium {
            background-color: #f59e0b;
        }
        
        .severity-high {
            background-color: #f97316;
        }
        
        .severity-critical {
            background-color: #ef4444;
        }
        
        /* Keyword Category Colors */
        .category-illegal {
            background-color: #fef2f2;
            color: #dc2626;
        }
        
        .category-prohibited {
            background-color: #fff7ed;
            color: #ea580c;
        }
        
        .category-high-risk {
            background-color: #fffbeb;
            color: #d97706;
        }
        
        .category-tbml {
            background-color: #f0f9ff;
            color: #0284c7;
        }
        
        .category-sanctions {
            background-color: #faf5ff;
            color: #9333ea;
        }
        
        .category-fraud {
            background-color: #f0fdf4;
            color: #16a34a;
        }
        
        /* Risk Tooltip Styles */
        .risk-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1f2937;
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            max-width: 300px;
            white-space: normal;
            margin-bottom: 8px;
        }
        
        .risk-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: #1f2937;
        }
        
        .risk-tooltip.show {
            opacity: 1;
        }
        
        /* Mobile tooltip styles */
        .mobile-tooltip {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            max-width: 90vw;
            z-index: 10000;
        }
        
        .mobile-tooltip::after {
            display: none;
        }
        
        /* No Keywords Message */
        .no-keywords-message {
            text-align: center;
            padding: 32px 20px;
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border-radius: 8px;
            border: 1px solid #bbf7d0;
        }
        
        /* Keyword Highlighting Styles */
        .keyword-highlight {
            position: relative;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
            text-decoration: underline;
            text-decoration-style: wavy;
        }
        
        .keyword-highlight:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        /* Keyword Highlight Severity Colors */
        .keyword-highlight-low {
            background-color: rgba(16, 185, 129, 0.2);
            color: #065f46;
            text-decoration-color: #10b981;
        }
        
        .keyword-highlight-medium {
            background-color: rgba(245, 158, 11, 0.2);
            color: #92400e;
            text-decoration-color: #f59e0b;
        }
        
        .keyword-highlight-high {
            background-color: rgba(249, 115, 22, 0.2);
            color: #9a3412;
            text-decoration-color: #f97316;
        }
        
        .keyword-highlight-critical {
            background-color: rgba(239, 68, 68, 0.2);
            color: #991b1b;
            text-decoration-color: #ef4444;
            animation: criticalHighlight 2s infinite;
        }
        
        @keyframes criticalHighlight {
            0%, 100% { 
                background-color: rgba(239, 68, 68, 0.2);
            }
            50% { 
                background-color: rgba(239, 68, 68, 0.4);
            }
        }
        
        /* Keyword Highlight Category Colors */
        .keyword-category-illegal {
            border-left: 3px solid #dc2626;
        }
        
        .keyword-category-prohibited {
            border-left: 3px solid #ea580c;
        }
        
        .keyword-category-high-risk {
            border-left: 3px solid #d97706;
        }
        
        .keyword-category-tbml {
            border-left: 3px solid #0284c7;
        }
        
        .keyword-category-sanctions {
            border-left: 3px solid #9333ea;
        }
        
        .keyword-category-fraud {
            border-left: 3px solid #16a34a;
        }
        
        /* Keyword Highlight Toggle Button */
        .keyword-highlight-toggle {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
            margin-left: 12px;
        }
        
        .keyword-highlight-toggle:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .risk-summary {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .risk-metrics {
                width: 100%;
                justify-content: space-between;
            }
            
            .keywords-list {
                grid-template-columns: 1fr;
            }
            
            .risk-tooltip {
                max-width: 250px;
                font-size: 11px;
                padding: 8px 12px;
            }
            
            .risk-keywords-section h4 {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }
            
            .keyword-highlight-toggle {
                margin-left: 0;
                margin-top: 8px;
                width: 100%;
            }
            
            .risk-category {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .risk-category-info {
                width: 100%;
            }
            
            .risk-category-count {
                align-self: flex-end;
            }
        }
        
        @media (max-width: 480px) {
            .risk-keywords-section {
                margin-bottom: 16px;
            }
            
            .risk-overview {
                padding: 16px;
            }
            
            .risk-categories {
                padding: 16px;
            }
            
            .detected-keywords {
                padding: 16px;
            }
            
            .risk-metrics {
                flex-direction: column;
                gap: 16px;
            }
            
            .risk-metric {
                width: 100%;
                text-align: left;
            }
            
            .keywords-list {
                gap: 6px;
            }
            
            .keyword-item {
                padding: 6px 10px;
                font-size: 12px;
            }
            
            .risk-tooltip {
                max-width: 200px;
                font-size: 10px;
                padding: 6px 10px;
            }
        }
        
        /* Mobile-specific enhancements */
        @media (max-width: 768px) {
            .risk-badge {
                font-size: 12px;
                padding: 6px 12px;
            }
            
            .risk-category-icon {
                width: 28px;
                height: 28px;
                font-size: 12px;
            }
            
            .risk-category-details h5 {
                font-size: 13px;
            }
            
            .risk-category-details p {
                font-size: 11px;
            }
            
            .keyword-highlight {
                padding: 1px 3px;
                font-size: 12px;
            }
        }
        
        /* Touch-friendly interactions */
        @media (hover: none) and (pointer: coarse) {
            .risk-category:hover {
                transform: none;
                box-shadow: none;
            }
            
            .keyword-item:hover {
                transform: none;
                box-shadow: none;
            }
            
            .risk-badge:hover {
                transform: none;
            }
            
            .keyword-highlight:hover {
                transform: none;
                box-shadow: none;
            }
            
            /* Add touch feedback */
            .risk-category:active {
                background-color: rgba(0, 0, 0, 0.05);
            }
            
            .keyword-item:active {
                background-color: rgba(0, 0, 0, 0.05);
            }
        }
        
        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .risk-badge {
                border-width: 3px;
            }
            
            .keyword-highlight {
                border: 2px solid currentColor;
            }
            
            .risk-tooltip {
                border: 2px solid #ffffff;
            }
        }
        
        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            .risk-badge::before {
                display: none;
            }
            
            .keyword-highlight {
                animation: none;
            }
            
            .risk-critical {
                animation: none;
            }
            
            .keyword-highlight-critical {
                animation: none;
            }
            
            * {
                transition: none !important;
                animation: none !important;
            }
        }
        /* Tab Styles */
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .tab-button {
            background: none;
            border: none;
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        .tab-button.active {
            border-bottom-color: #3498db;
            color: #3498db;
            font-weight: 600;
        }
        .tab-button:hover {
            background: rgba(52, 152, 219, 0.1);
        }

        .header-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .header-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2c3e50;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-title i {
            font-size: 2.5rem;
            color: #3498db;
        }

        .header-subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
            margin-top: 10px;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            min-height: 48px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: #6c757d;
            border: 2px solid #6c757d;
        }

        .btn-outline:hover {
            background: #6c757d;
            color: white;
            transform: translateY(-2px);
        }

        /* Tabbed Interface */
        .tabbed-interface {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .tab-navigation {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            overflow-x: auto;
        }

        .tab-button {
            flex: 1;
            padding: 20px 25px;
            background: none;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            color: #6c757d;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 200px;
            white-space: nowrap;
        }

        .tab-button:hover {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
        }

        .tab-button.active {
            background: white;
            color: #3498db;
            border-bottom: 3px solid #3498db;
        }

        .tab-button i {
            font-size: 1.2rem;
        }

        .tab-content {
            display: none;
            padding: 40px;
            min-height: 500px;
        }

        .tab-content.active {
            display: block;
        }

        /* Merchant Details Tab */
        .merchant-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .info-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
        }

        .info-section h3 {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin: 0 0 20px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-section h3 i {
            color: #3498db;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 12px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: 600;
            color: #495057;
            min-width: 120px;
        }

        .info-value {
            color: #2c3e50;
            text-align: right;
            flex: 1;
            margin-left: 15px;
        }

        .info-value.empty {
            color: #6c757d;
            font-style: italic;
        }

        /* Analytics Tabs */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .analytics-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .analytics-card:hover {
            transform: translateY(-5px);
        }

        .analytics-card h4 {
            font-size: 1.2rem;
            font-weight: 700;
            color: #2c3e50;
            margin: 0 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .analytics-card h4 i {
            color: #3498db;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #dee2e6;
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-label {
            font-weight: 500;
            color: #495057;
        }

        .metric-value {
            font-weight: 700;
            color: #2c3e50;
        }

        .metric-value.score {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .metric-value.score.high {
            background: #d4edda;
            color: #155724;
        }

        .metric-value.score.medium {
            background: #fff3cd;
            color: #856404;
        }

        .metric-value.score.low {
            background: #f8d7da;
            color: #721c24;
        }

        /* Risk Assessment Specific */
        .risk-indicator {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: white;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .risk-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
        }

        .risk-icon.low {
            background: #28a745;
        }

        .risk-icon.medium {
            background: #ffc107;
        }

        .risk-icon.high {
            background: #dc3545;
        }

        .risk-content {
            flex: 1;
        }

        .risk-title {
            font-weight: 700;
            color: #2c3e50;
            margin: 0 0 5px 0;
        }

        .risk-description {
            color: #6c757d;
            font-size: 0.9rem;
            margin: 0;
        }

        /* Classification Results */
        .classification-results {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .classification-results h4 {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin: 0 0 20px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .classification-results h4 i {
            color: #3498db;
        }

        .classification-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .classification-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .classification-item h5 {
            font-size: 1.1rem;
            font-weight: 700;
            color: #2c3e50;
            margin: 0 0 10px 0;
        }

        .classification-item p {
            color: #6c757d;
            margin: 0 0 10px 0;
            font-size: 0.9rem;
        }

        .confidence-score {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .confidence-bar {
            flex: 1;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #e74c3c, #f39c12, #27ae60);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .confidence-text {
            font-weight: 700;
            color: #2c3e50;
            min-width: 50px;
        }

        /* Loading States */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            color: #3498db;
            font-weight: 600;
            padding: 40px;
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Enhanced Mobile Responsive Design */
        @media (max-width: 768px) {
            .header-section, .tabbed-interface {
                margin: 15px;
                border-radius: 15px;
            }

            .header-title {
                font-size: 2rem;
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .header-actions {
                flex-direction: column;
                gap: 12px;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .tab-navigation {
                flex-direction: column;
            }

            .tab-button {
                min-width: auto;
                padding: 16px 20px;
                border-bottom: 1px solid #e9ecef;
            }

            .tab-content {
                padding: 25px;
            }

            .merchant-info-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .analytics-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .classification-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .info-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }

            .info-value {
                text-align: left;
                margin-left: 0;
            }
        }

        @media (max-width: 480px) {
            .header-section, .tabbed-interface {
                margin: 10px;
                padding: 20px;
            }

            .header-title {
                font-size: 1.8rem;
            }

            .tab-content {
                padding: 20px;
            }

            .info-section {
                padding: 20px;
            }
        }

        /* Enhanced Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .tab-button:focus, .btn:focus {
            outline: 2px solid #3498db;
            outline-offset: 2px;
        }

        /* Enhanced Touch Targets for Mobile */
        @media (max-width: 768px) {
            .tab-button, .btn {
                min-height: 48px;
                touch-action: manipulation;
                -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-xl font-bold text-gray-900" id="merchantNameText">Loading...</h1>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded">ENHANCED</span>
                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">LIVE</span>
                    <button id="helpBtn" class="text-gray-600 hover:text-gray-900">
                        <i class="fas fa-question-circle"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Tab Navigation -->
        <div class="bg-white rounded-lg shadow-lg mb-8">
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                    <button class="tab-button active" data-tab="merchant-details" class="whitespace-nowrap py-2 px-1 border-b-2 border-blue-500 font-medium text-sm text-blue-600">
                        <i class="fas fa-info-circle mr-2"></i>
                        Merchant Details
                    </button>
                    <button class="tab-button" data-tab="business-analytics" class="whitespace-nowrap py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        <i class="fas fa-chart-line mr-2"></i>
                        Business Analytics
                    </button>
                    <button class="tab-button" data-tab="risk-assessment" class="whitespace-nowrap py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        Risk Assessment
                    </button>
                    <button class="tab-button" data-tab="risk-indicators" class="whitespace-nowrap py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        <i class="fas fa-gauge-high mr-2"></i>
                        Risk Indicators
                    </button>
                </nav>
            </div>
        </div>

        <!-- Tab Content -->

        <!-- Merchant Details Tab -->
        <div class="tab-content active" id="merchant-details">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Merchant Information</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Business Information -->
                    <div class="space-y-4">
                        <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                            <i class="fas fa-building mr-2 text-blue-600"></i>
                            Business Information
                        </h3>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Business Name</label>
                                <p class="mt-1 text-sm text-gray-900" id="businessName">-</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Website</label>
                                <p class="mt-1 text-sm text-gray-900" id="websiteUrl">-</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Description</label>
                                <p class="mt-1 text-sm text-gray-900" id="businessDescription">-</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Registration Number</label>
                                <p class="mt-1 text-sm text-gray-900" id="registrationNumber">-</p>
                            </div>
                        </div>
                    </div>

                    <!-- Address Information -->
                    <div class="space-y-4">
                        <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                            <i class="fas fa-map-marker-alt mr-2 text-green-600"></i>
                            Address Information
                        </h3>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Street Address</label>
                                <p class="mt-1 text-sm text-gray-900" id="streetAddress">-</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">City</label>
                                <p class="mt-1 text-sm text-gray-900" id="city">-</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">State/Province</label>
                                <p class="mt-1 text-sm text-gray-900" id="state">-</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Postal Code</label>
                                <p class="mt-1 text-sm text-gray-900" id="postalCode">-</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Country</label>
                                <p class="mt-1 text-sm text-gray-900" id="country">-</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contact Information -->
                <div class="mt-6 pt-6 border-t border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-800 flex items-center mb-4">
                        <i class="fas fa-phone mr-2 text-purple-600"></i>
                        Contact Information
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Phone Number</label>
                            <p class="mt-1 text-sm text-gray-900" id="phoneNumber">-</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Email Address</label>
                            <p class="mt-1 text-sm text-gray-900" id="email">-</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

            <!-- Business Analytics Tab -->
            <div class="tab-content" id="business-analytics">
                <div class="loading" id="analyticsLoading">
                    <div class="spinner"></div>
                    Loading business analytics...
                </div>
                <div id="analyticsContent" style="display: none;">
                    <div class="classification-results">
                        <h4>
                            <i class="fas fa-search"></i>
                            Business Classification Results
                        </h4>
                        <div class="classification-grid" id="classificationResults">
                            <!-- Classification results will be populated here -->
                        </div>
                    </div>

                    <!-- Risk Keywords Analysis Section -->
                    <div class="risk-keywords-section">
                        <h4>
                            <i class="fas fa-exclamation-triangle"></i>
                            Risk Keywords Analysis
                            <button class="keyword-highlight-toggle" onclick="merchantHandler.toggleKeywordHighlighting()">
                                Toggle Highlights
                            </button>
                        </h4>
                        <div class="risk-overview">
                            <div class="risk-summary">
                                <div class="risk-level-indicator">
                                    <span class="risk-badge risk-low" id="overallRiskLevel">
                                        <i class="fas fa-shield-alt"></i>
                                        Low Risk
                                    </span>
                                </div>
                                <div class="risk-metrics">
                                    <div class="risk-metric">
                                        <span class="risk-metric-label">Risk Score:</span>
                                        <span class="risk-metric-value" id="riskScore">15/100</span>
                                    </div>
                                    <div class="risk-metric">
                                        <span class="risk-metric-label">Keywords Detected:</span>
                                        <span class="risk-metric-value" id="keywordsDetected">0</span>
                                    </div>
                                    <div class="risk-metric">
                                        <span class="risk-metric-label">Last Assessed:</span>
                                        <span class="risk-metric-value" id="lastAssessed">Just now</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="risk-categories" id="riskCategories">
                            <!-- Risk categories will be populated here -->
                        </div>
                        
                        <div class="detected-keywords" id="detectedKeywords">
                            <!-- Detected keywords will be populated here -->
                        </div>
                    </div>

                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h4>
                                <i class="fas fa-chart-pie"></i>
                                Industry Analysis
                            </h4>
                            <div class="metric">
                                <span class="metric-label">Primary Industry:</span>
                                <span class="metric-value" id="primaryIndustry">Technology</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Confidence Score:</span>
                                <span class="metric-value score high" id="industryConfidence">95%</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Market Size:</span>
                                <span class="metric-value" id="marketSize">Large</span>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h4>
                                <i class="fas fa-globe"></i>
                                Digital Presence
                            </h4>
                            <div class="metric">
                                <span class="metric-label">Website Status:</span>
                                <span class="metric-value score high" id="websiteStatus">Active</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">SSL Certificate:</span>
                                <span class="metric-value score high" id="sslStatus">Valid</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Domain Age:</span>
                                <span class="metric-value" id="domainAge">5 years</span>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h4>
                                <i class="fas fa-database"></i>
                                Data Quality
                            </h4>
                            <div class="metric">
                                <span class="metric-label">Completeness:</span>
                                <span class="metric-value score high" id="dataCompleteness">92%</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Accuracy:</span>
                                <span class="metric-value score high" id="dataAccuracy">95%</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Freshness:</span>
                                <span class="metric-value score medium" id="dataFreshness">85%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Risk Assessment Tab -->
            <div class="tab-content" id="risk-assessment">
                <div class="loading" id="riskLoading">
                    <div class="spinner"></div>
                    Analyzing risk factors...
                </div>
                <div id="riskContent" style="display: none;">
                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h4>
                                <i class="fas fa-shield-alt"></i>
                                Overall Risk Score
                            </h4>
                            <div class="metric">
                                <span class="metric-label">Risk Level:</span>
                                <span class="metric-value score low" id="overallRisk">Low</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Risk Score:</span>
                                <span class="metric-value" id="riskScore">25/100</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Last Updated:</span>
                                <span class="metric-value" id="riskLastUpdated">Just now</span>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h4>
                                <i class="fas fa-exclamation-triangle"></i>
                                Risk Factors
                            </h4>
                            <div class="metric">
                                <span class="metric-label">Financial Risk:</span>
                                <span class="metric-value score low" id="financialRisk">Low</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Operational Risk:</span>
                                <span class="metric-value score medium" id="operationalRisk">Medium</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Compliance Risk:</span>
                                <span class="metric-value score low" id="complianceRisk">Low</span>
                            </div>
                        </div>
                    </div>

                    <div class="info-section">
                        <h3>
                            <i class="fas fa-list"></i>
                            Risk Indicators
                        </h3>
                        <div class="risk-indicator">
                            <div class="risk-icon low">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="risk-content">
                                <h5 class="risk-title">Website Verification</h5>
                                <p class="risk-description">Website is active and properly configured with valid SSL certificate</p>
                            </div>
                        </div>
                        <div class="risk-indicator">
                            <div class="risk-icon low">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="risk-content">
                                <h5 class="risk-title">Business Registration</h5>
                                <p class="risk-description">Business appears to be properly registered and compliant</p>
                            </div>
                        </div>
                        <div class="risk-indicator">
                            <div class="risk-icon medium">
                                <i class="fas fa-exclamation"></i>
                            </div>
                            <div class="risk-content">
                                <h5 class="risk-title">Industry Risk</h5>
                                <p class="risk-description">Operating in a medium-risk industry with standard compliance requirements</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Risk Indicators Tab -->
            <div class="tab-content" id="risk-indicators">
                <div class="loading" id="indicatorsLoading">
                    <div class="spinner"></div>
                    Calculating risk indicators...
                </div>
                <div id="indicatorsContent" style="display: none;">
                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h4>
                                <i class="fas fa-chart-bar"></i>
                                Risk Metrics
                            </h4>
                            <div class="metric">
                                <span class="metric-label">Credit Risk:</span>
                                <span class="metric-value score low" id="creditRisk">Low</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Market Risk:</span>
                                <span class="metric-value score medium" id="marketRisk">Medium</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Liquidity Risk:</span>
                                <span class="metric-value score low" id="liquidityRisk">Low</span>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h4>
                                <i class="fas fa-balance-scale"></i>
                                Compliance Score
                            </h4>
                            <div class="metric">
                                <span class="metric-label">Regulatory:</span>
                                <span class="metric-value score high" id="regulatoryScore">95%</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Industry Standards:</span>
                                <span class="metric-value score high" id="industryScore">90%</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Best Practices:</span>
                                <span class="metric-value score medium" id="bestPracticesScore">85%</span>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h4>
                                <i class="fas fa-trending-up"></i>
                                Performance Indicators
                            </h4>
                            <div class="metric">
                                <span class="metric-label">Growth Potential:</span>
                                <span class="metric-value score high" id="growthPotential">High</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Stability:</span>
                                <span class="metric-value score high" id="stability">High</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Innovation:</span>
                                <span class="metric-value score medium" id="innovation">Medium</span>
                            </div>
                        </div>
                    </div>

                    <div class="info-section">
                        <h3>
                            <i class="fas fa-chart-line"></i>
                            Risk Trend Analysis
                        </h3>
                        <div class="analytics-grid">
                            <div class="analytics-card">
                                <h4>
                                    <i class="fas fa-clock"></i>
                                    Historical Trends
                                </h4>
                                <div class="metric">
                                    <span class="metric-label">30-Day Trend:</span>
                                    <span class="metric-value score low" id="trend30Day">Improving</span>
                                </div>
                                <div class="metric">
                                    <span class="metric-label">90-Day Trend:</span>
                                    <span class="metric-value score low" id="trend90Day">Stable</span>
                                </div>
                                <div class="metric">
                                    <span class="metric-label">1-Year Trend:</span>
                                    <span class="metric-value score medium" id="trend1Year">Moderate</span>
                                </div>
                            </div>

                            <div class="analytics-card">
                                <h4>
                                    <i class="fas fa-eye"></i>
                                    Monitoring Status
                                </h4>
                                <div class="metric">
                                    <span class="metric-label">Active Monitoring:</span>
                                    <span class="metric-value score high" id="monitoringStatus">Active</span>
                                </div>
                                <div class="metric">
                                    <span class="metric-label">Alert Level:</span>
                                    <span class="metric-value score low" id="alertLevel">Low</span>
                                </div>
                                <div class="metric">
                                    <span class="metric-label">Next Review:</span>
                                    <span class="metric-value" id="nextReview">30 days</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced Merchant Details Handler
        class MerchantDetailsHandler {
            constructor() {
                this.merchantData = null;
                this.currentTab = 'merchant-details';
                this.init();
            }

            init() {
                this.loadMerchantData();
                this.bindEvents();
                this.initializeMobileFeatures();
            }

            loadMerchantData() {
                // Load merchant data from session storage
                const storedData = sessionStorage.getItem('merchantData');
                if (storedData) {
                    this.merchantData = JSON.parse(storedData);
                    this.populateMerchantDetails();
                    this.updatePageTitle();
                } else {
                    // No data found, redirect to add merchant page
                    this.showNotification('No merchant data found. Redirecting to add merchant page.', 'info');
                    setTimeout(() => {
                        window.location.href = 'add-merchant.html';
                    }, 2000);
                }
            }

            populateMerchantDetails() {
                if (!this.merchantData) return;

                // Populate merchant details
                document.getElementById('businessName').textContent = this.merchantData.businessName || 'Not provided';
                document.getElementById('websiteUrl').textContent = this.merchantData.websiteUrl || 'Not provided';
                document.getElementById('businessDescription').textContent = this.merchantData.businessDescription || 'Not provided';
                document.getElementById('registrationNumber').textContent = this.merchantData.registrationNumber || 'Not provided';
                
                // Populate address information
                document.getElementById('streetAddress').textContent = this.merchantData.streetAddress || 'Not provided';
                document.getElementById('city').textContent = this.merchantData.city || 'Not provided';
                document.getElementById('state').textContent = this.merchantData.state || 'Not provided';
                document.getElementById('postalCode').textContent = this.merchantData.postalCode || 'Not provided';
                document.getElementById('country').textContent = this.getCountryName(this.merchantData.country) || 'Not provided';
                
                // Populate contact information
                document.getElementById('phoneNumber').textContent = this.merchantData.phoneNumber || 'Not provided';
                document.getElementById('email').textContent = this.merchantData.email || 'Not provided';

                // Add empty class for styling
                this.addEmptyStyling();
            }

            addEmptyStyling() {
                const fields = ['websiteUrl', 'businessDescription', 'registrationNumber', 'streetAddress', 'city', 'state', 'postalCode', 'phoneNumber', 'email'];
                fields.forEach(fieldId => {
                    const element = document.getElementById(fieldId);
                    if (element && element.textContent === 'Not provided') {
                        element.classList.add('empty');
                    }
                });
            }

            getCountryName(countryCode) {
                const countries = {
                    'US': 'United States',
                    'CA': 'Canada',
                    'GB': 'United Kingdom',
                    'AU': 'Australia',
                    'DE': 'Germany',
                    'FR': 'France',
                    'IT': 'Italy',
                    'ES': 'Spain',
                    'NL': 'Netherlands',
                    'BE': 'Belgium',
                    'CH': 'Switzerland',
                    'AT': 'Austria',
                    'SE': 'Sweden',
                    'NO': 'Norway',
                    'DK': 'Denmark',
                    'FI': 'Finland',
                    'IE': 'Ireland',
                    'PT': 'Portugal',
                    'LU': 'Luxembourg',
                    'JP': 'Japan',
                    'KR': 'South Korea',
                    'SG': 'Singapore',
                    'HK': 'Hong Kong',
                    'NZ': 'New Zealand',
                    'BR': 'Brazil',
                    'MX': 'Mexico',
                    'AR': 'Argentina',
                    'CL': 'Chile',
                    'CO': 'Colombia',
                    'PE': 'Peru',
                    'ZA': 'South Africa',
                    'EG': 'Egypt',
                    'NG': 'Nigeria',
                    'KE': 'Kenya',
                    'MA': 'Morocco',
                    'TN': 'Tunisia',
                    'IN': 'India',
                    'CN': 'China',
                    'TH': 'Thailand',
                    'MY': 'Malaysia',
                    'ID': 'Indonesia',
                    'PH': 'Philippines',
                    'VN': 'Vietnam',
                    'TW': 'Taiwan',
                    'IL': 'Israel',
                    'AE': 'United Arab Emirates',
                    'SA': 'Saudi Arabia',
                    'TR': 'Turkey',
                    'RU': 'Russia',
                    'PL': 'Poland',
                    'CZ': 'Czech Republic',
                    'HU': 'Hungary',
                    'RO': 'Romania',
                    'BG': 'Bulgaria',
                    'HR': 'Croatia',
                    'SI': 'Slovenia',
                    'SK': 'Slovakia',
                    'LT': 'Lithuania',
                    'LV': 'Latvia',
                    'EE': 'Estonia',
                    'GR': 'Greece',
                    'CY': 'Cyprus',
                    'MT': 'Malta'
                };
                return countries[countryCode] || countryCode;
            }

            updatePageTitle() {
                if (this.merchantData && this.merchantData.businessName) {
                    document.getElementById('merchantNameText').textContent = this.merchantData.businessName;
                    document.title = `${this.merchantData.businessName} - Merchant Details - KYB Platform`;
                }
            }

            bindEvents() {
                // Tab navigation
                document.querySelectorAll('.tab-button').forEach(button => {
                    button.addEventListener('click', (e) => this.switchTab(e.target.dataset.tab));
                });

                // Action buttons
                document.getElementById('editMerchantBtn').addEventListener('click', () => {
                    this.showNotification('Edit functionality coming soon!', 'info');
                });

                document.getElementById('newMerchantBtn').addEventListener('click', () => {
                    window.location.href = 'add-merchant.html';
                });
            }

            switchTab(tabName) {
                // Update tab buttons
                document.querySelectorAll('.tab-button').forEach(button => {
                    button.classList.remove('active');
                });
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

                // Update tab content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tabName).classList.add('active');

                this.currentTab = tabName;

                // Load tab-specific data
                this.loadTabData(tabName);
            }

            async loadTabData(tabName) {
                switch (tabName) {
                    case 'business-analytics':
                        await this.loadBusinessAnalytics();
                        break;
                    case 'risk-assessment':
                        await this.loadRiskAssessment();
                        break;
                    case 'risk-indicators':
                        await this.loadRiskIndicators();
                        break;
                }
            }

            async loadBusinessAnalytics() {
                const loading = document.getElementById('analyticsLoading');
                const content = document.getElementById('analyticsContent');
                
                loading.style.display = 'flex';
                content.style.display = 'none';

                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 1500));

                // Populate classification results
                this.populateClassificationResults();
                
                // Populate risk keywords analysis
                this.populateRiskKeywordsAnalysis();
                
                // Add keyword highlighting to content
                this.addKeywordHighlighting();

                loading.style.display = 'none';
                content.style.display = 'block';
            }

            populateClassificationResults() {
                const container = document.getElementById('classificationResults');
                const mockResults = [
                    {
                        type: 'MCC',
                        code: '7372',
                        description: 'Computer Programming Services',
                        confidence: 95
                    },
                    {
                        type: 'NAICS',
                        code: '541511',
                        description: 'Custom Computer Programming Services',
                        confidence: 92
                    },
                    {
                        type: 'SIC',
                        code: '7372',
                        description: 'Prepackaged Software',
                        confidence: 88
                    }
                ];

                container.innerHTML = mockResults.map(result => `
                    <div class="classification-item">
                        <h5>${result.type} Code: ${result.code}</h5>
                        <p>${result.description}</p>
                        <div class="confidence-score">
                            <div class="confidence-bar">
                                <div class="confidence-fill" style="width: ${result.confidence}%"></div>
                            </div>
                            <span class="confidence-text">${result.confidence}%</span>
                        </div>
                    </div>
                `).join('');
            }

            populateRiskKeywordsAnalysis() {
                // Mock risk keywords data - in real implementation, this would come from the API
                // This demonstrates different risk levels for testing purposes
                const riskData = this.getMockRiskData();

                // Update overall risk metrics
                this.updateOverallRiskMetrics(riskData.overallRisk);
                
                // Populate risk categories
                this.populateRiskCategories(riskData.categories);
                
                // Populate detected keywords
                this.populateDetectedKeywords(riskData.detectedKeywords);
                
                // Initialize tooltips
                this.initializeRiskTooltips();
            }

            getMockRiskData() {
                // This method provides different risk scenarios for demonstration
                // In production, this would be replaced with actual API data
                const scenarios = [
                    {
                        overallRisk: {
                            level: 'low',
                            score: 15,
                            keywordsDetected: 0,
                            lastAssessed: 'Just now'
                        },
                        categories: [
                            {
                                name: 'Illegal Activities',
                                icon: 'fas fa-ban',
                                count: 0,
                                severity: 'critical',
                                description: 'Activities prohibited by law'
                            },
                            {
                                name: 'Prohibited by Card Brands',
                                icon: 'fas fa-credit-card',
                                count: 0,
                                severity: 'high',
                                description: 'Activities restricted by Visa, Mastercard, Amex'
                            },
                            {
                                name: 'High-Risk Industries',
                                icon: 'fas fa-exclamation-triangle',
                                count: 0,
                                severity: 'medium',
                                description: 'Industries with elevated risk profiles'
                            },
                            {
                                name: 'Trade-Based Money Laundering',
                                icon: 'fas fa-exchange-alt',
                                count: 0,
                                severity: 'high',
                                description: 'TBML indicators and patterns'
                            },
                            {
                                name: 'Sanctions & OFAC',
                                icon: 'fas fa-gavel',
                                count: 0,
                                severity: 'critical',
                                description: 'Sanctions and regulatory violations'
                            },
                            {
                                name: 'Fraud Indicators',
                                icon: 'fas fa-user-secret',
                                count: 0,
                                severity: 'medium',
                                description: 'Patterns indicating potential fraud'
                            }
                        ],
                        detectedKeywords: []
                    },
                    {
                        overallRisk: {
                            level: 'medium',
                            score: 45,
                            keywordsDetected: 3,
                            lastAssessed: '2 minutes ago'
                        },
                        categories: [
                            {
                                name: 'Illegal Activities',
                                icon: 'fas fa-ban',
                                count: 0,
                                severity: 'critical',
                                description: 'Activities prohibited by law'
                            },
                            {
                                name: 'Prohibited by Card Brands',
                                icon: 'fas fa-credit-card',
                                count: 1,
                                severity: 'high',
                                description: 'Activities restricted by Visa, Mastercard, Amex'
                            },
                            {
                                name: 'High-Risk Industries',
                                icon: 'fas fa-exclamation-triangle',
                                count: 2,
                                severity: 'medium',
                                description: 'Industries with elevated risk profiles'
                            },
                            {
                                name: 'Trade-Based Money Laundering',
                                icon: 'fas fa-exchange-alt',
                                count: 0,
                                severity: 'high',
                                description: 'TBML indicators and patterns'
                            },
                            {
                                name: 'Sanctions & OFAC',
                                icon: 'fas fa-gavel',
                                count: 0,
                                severity: 'critical',
                                description: 'Sanctions and regulatory violations'
                            },
                            {
                                name: 'Fraud Indicators',
                                icon: 'fas fa-user-secret',
                                count: 0,
                                severity: 'medium',
                                description: 'Patterns indicating potential fraud'
                            }
                        ],
                        detectedKeywords: [
                            {
                                text: 'cryptocurrency',
                                category: 'prohibited',
                                severity: 'high',
                                description: 'Cryptocurrency trading is restricted by most card brands'
                            },
                            {
                                text: 'gambling',
                                category: 'high-risk',
                                severity: 'medium',
                                description: 'Gambling activities require special licensing and compliance'
                            },
                            {
                                text: 'adult entertainment',
                                category: 'prohibited',
                                severity: 'high',
                                description: 'Adult entertainment is prohibited by most payment processors'
                            }
                        ]
                    }
                ];

                // For demonstration, randomly select a scenario
                // In production, this would be determined by actual risk assessment
                return scenarios[Math.floor(Math.random() * scenarios.length)];
            }

            updateOverallRiskMetrics(riskData) {
                const riskLevelElement = document.getElementById('overallRiskLevel');
                const riskScoreElement = document.getElementById('riskScore');
                const keywordsDetectedElement = document.getElementById('keywordsDetected');
                const lastAssessedElement = document.getElementById('lastAssessed');

                // Update risk level badge
                riskLevelElement.className = `risk-badge risk-${riskData.level}`;
                riskLevelElement.innerHTML = `
                    <i class="fas fa-shield-alt"></i>
                    ${this.capitalizeFirst(riskData.level)} Risk
                `;

                // Update metrics
                riskScoreElement.textContent = `${riskData.score}/100`;
                keywordsDetectedElement.textContent = riskData.keywordsDetected;
                lastAssessedElement.textContent = riskData.lastAssessed;
            }

            populateRiskCategories(categories) {
                const container = document.getElementById('riskCategories');
                
                container.innerHTML = categories.map(category => `
                    <div class="risk-category risk-category-bg-${category.severity}" 
                         data-category="${category.name.toLowerCase().replace(/\s+/g, '-')}"
                         data-tooltip="${category.description}">
                        <div class="risk-category-info">
                            <div class="risk-category-icon severity-${category.severity}">
                                <i class="${category.icon}"></i>
                            </div>
                            <div class="risk-category-details">
                                <h5>${category.name}</h5>
                                <p>${category.description}</p>
                            </div>
                        </div>
                        <div class="risk-category-count">${category.count}</div>
                    </div>
                `).join('');
            }

            populateDetectedKeywords(keywords) {
                const container = document.getElementById('detectedKeywords');
                
                if (keywords.length === 0) {
                    container.innerHTML = `
                        <div class="keywords-header">
                            <h5>Detected Risk Keywords</h5>
                        </div>
                        <div class="no-keywords-message">
                            <i class="fas fa-check-circle" style="color: #10b981; font-size: 24px; margin-bottom: 8px;"></i>
                            <p style="color: #6b7280; margin: 0;">No risk keywords detected. This business appears to be operating in compliance with standard regulations.</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = `
                    <div class="keywords-header">
                        <h5>Detected Risk Keywords</h5>
                        <button class="keywords-toggle" onclick="this.toggleKeywords()">Show All</button>
                    </div>
                    <div class="keywords-list">
                        ${keywords.map(keyword => `
                            <div class="keyword-item" 
                                 data-keyword="${keyword.text}"
                                 data-category="${keyword.category}"
                                 data-severity="${keyword.severity}"
                                 data-tooltip="${keyword.description}">
                                <div class="keyword-severity severity-${keyword.severity}"></div>
                                <div class="keyword-text">${keyword.text}</div>
                                <div class="keyword-category category-${keyword.category}">${keyword.category}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            initializeRiskTooltips() {
                // Add tooltips to risk categories
                document.querySelectorAll('.risk-category').forEach(element => {
                    const category = element.getAttribute('data-category');
                    if (category) {
                        const tooltip = this.getRiskCategoryTooltip(category);
                        this.createTooltip(element, tooltip);
                    }
                });

                // Add tooltips to detected keywords
                document.querySelectorAll('.keyword-item').forEach(element => {
                    const tooltip = element.getAttribute('data-tooltip');
                    if (tooltip) {
                        this.createTooltip(element, tooltip);
                    }
                });

                // Add tooltips to risk badges
                document.querySelectorAll('.risk-badge').forEach(element => {
                    const riskLevel = element.classList.contains('risk-low') ? 'low' :
                                    element.classList.contains('risk-medium') ? 'medium' :
                                    element.classList.contains('risk-high') ? 'high' :
                                    element.classList.contains('risk-critical') ? 'critical' : 'low';
                    
                    const tooltip = this.getRiskLevelTooltip(riskLevel);
                    this.createTooltip(element, tooltip);
                });

                // Add tooltips to risk metrics
                document.querySelectorAll('.risk-metric').forEach(element => {
                    const label = element.querySelector('.risk-metric-label')?.textContent;
                    if (label) {
                        const tooltip = this.getRiskMetricTooltip(label);
                        this.createTooltip(element, tooltip);
                    }
                });
            }

            getRiskMetricTooltip(metricLabel) {
                const tooltips = {
                    'Risk Score:': `
                        <div style="font-weight: 600; margin-bottom: 4px;"> Risk Score</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">Overall risk assessment score based on detected keywords and business analysis.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Score Ranges:</strong><br>
                             0-25: Low Risk<br>
                             26-50: Medium Risk<br>
                             51-75: High Risk<br>
                             76-100: Critical Risk
                        </div>
                    `,
                    'Keywords Detected:': `
                        <div style="font-weight: 600; margin-bottom: 4px;"> Keywords Detected</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">Number of risk-related keywords found in business content and website analysis.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Analysis includes:</strong><br>
                             Website content<br>
                             Business descriptions<br>
                             Industry classifications<br>
                             Regulatory keywords
                        </div>
                    `,
                    'Last Assessed:': `
                        <div style="font-weight: 600; margin-bottom: 4px;"> Last Assessed</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">Timestamp of the most recent risk assessment analysis.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Assessment includes:</strong><br>
                             Real-time keyword scanning<br>
                             Website content analysis<br>
                             Industry risk evaluation<br>
                             Compliance checking
                        </div>
                    `
                };
                return tooltips[metricLabel] || `
                    <div style="font-weight: 600; margin-bottom: 4px;"> Information</div>
                    <div style="font-size: 12px;">Additional information about this risk metric.</div>
                `;
            }

            createTooltip(element, content) {
                const tooltip = document.createElement('div');
                tooltip.className = 'risk-tooltip';
                tooltip.innerHTML = content;
                element.appendChild(tooltip);
                
                element.addEventListener('mouseenter', () => {
                    tooltip.classList.add('show');
                });
                
                element.addEventListener('mouseleave', () => {
                    tooltip.classList.remove('show');
                });
            }

            getRiskLevelTooltip(level) {
                const tooltips = {
                    low: `
                        <div style="font-weight: 600; margin-bottom: 4px; color: #10b981;"> Low Risk</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">This business operates in a low-risk environment with minimal compliance concerns.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Recommendations:</strong><br>
                             Standard monitoring procedures<br>
                             Annual risk review<br>
                             Basic compliance checks
                        </div>
                    `,
                    medium: `
                        <div style="font-weight: 600; margin-bottom: 4px; color: #f59e0b;"> Medium Risk</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">This business has some risk factors that require monitoring and regular review.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Recommendations:</strong><br>
                             Enhanced monitoring<br>
                             Quarterly risk assessments<br>
                             Additional compliance documentation
                        </div>
                    `,
                    high: `
                        <div style="font-weight: 600; margin-bottom: 4px; color: #f97316;"> High Risk</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">This business operates in a high-risk environment requiring enhanced due diligence.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Recommendations:</strong><br>
                             Continuous monitoring<br>
                             Monthly risk reviews<br>
                             Enhanced due diligence<br>
                             Consider additional controls
                        </div>
                    `,
                    critical: `
                        <div style="font-weight: 600; margin-bottom: 4px; color: #ef4444;"> Critical Risk</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">This business presents critical risk factors requiring immediate attention and review.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Immediate Actions Required:</strong><br>
                             Immediate risk assessment<br>
                             Enhanced monitoring<br>
                             Regulatory consultation<br>
                             Consider account restrictions
                        </div>
                    `
                };
                return tooltips[level] || tooltips.low;
            }

            getRiskCategoryTooltip(category) {
                const tooltips = {
                    'illegal-activities': `
                        <div style="font-weight: 600; margin-bottom: 4px; color: #dc2626;"> Illegal Activities</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">Activities that are prohibited by law and may result in criminal prosecution.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Examples:</strong><br>
                             Drug trafficking<br>
                             Weapons sales<br>
                             Human trafficking<br>
                             Money laundering
                        </div>
                    `,
                    'prohibited-by-card-brands': `
                        <div style="font-weight: 600; margin-bottom: 4px; color: #ea580c;"> Prohibited by Card Brands</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">Activities restricted by Visa, Mastercard, and American Express payment networks.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Examples:</strong><br>
                             Adult entertainment<br>
                             Cryptocurrency trading<br>
                             Gambling (unlicensed)<br>
                             Tobacco sales
                        </div>
                    `,
                    'high-risk-industries': `
                        <div style="font-weight: 600; margin-bottom: 4px; color: #d97706;"> High-Risk Industries</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">Industries with elevated risk profiles requiring enhanced due diligence.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Examples:</strong><br>
                             Money services<br>
                             Prepaid cards<br>
                             Travel services<br>
                             Dating services
                        </div>
                    `,
                    'trade-based-money-laundering': `
                        <div style="font-weight: 600; margin-bottom: 4px; color: #0284c7;"> Trade-Based Money Laundering</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">TBML indicators and patterns that may indicate money laundering through trade.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Examples:</strong><br>
                             Shell companies<br>
                             Trade finance<br>
                             Commodity trading<br>
                             Complex trade structures
                        </div>
                    `,
                    'sanctions-ofac': `
                        <div style="font-weight: 600; margin-bottom: 4px; color: #9333ea;"> Sanctions & OFAC</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">Sanctions and regulatory violations that may result in severe penalties.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Examples:</strong><br>
                             OFAC violations<br>
                             Sanctioned entities<br>
                             Embargo violations<br>
                             Terrorist financing
                        </div>
                    `,
                    'fraud-indicators': `
                        <div style="font-weight: 600; margin-bottom: 4px; color: #16a34a;"> Fraud Indicators</div>
                        <div style="font-size: 12px; margin-bottom: 8px;">Patterns indicating potential fraud or deceptive business practices.</div>
                        <div style="font-size: 11px; color: #6b7280;">
                            <strong>Examples:</strong><br>
                             Fake business names<br>
                             Stolen identities<br>
                             Rapid business changes<br>
                             Unusual patterns
                        </div>
                    `
                };
                return tooltips[category] || tooltips['illegal-activities'];
            }

            capitalizeFirst(str) {
                return str.charAt(0).toUpperCase() + str.slice(1);
            }

            // Risk Keyword Highlighting Functionality
            highlightRiskKeywords(content, keywords) {
                if (!keywords || keywords.length === 0) {
                    return content;
                }

                let highlightedContent = content;
                
                keywords.forEach(keyword => {
                    const regex = new RegExp(`\\b(${keyword.text})\\b`, 'gi');
                    const severityClass = `keyword-highlight-${keyword.severity}`;
                    const categoryClass = `keyword-category-${keyword.category}`;
                    
                    highlightedContent = highlightedContent.replace(regex, 
                        `<span class="keyword-highlight ${severityClass} ${categoryClass}" 
                                data-keyword="${keyword.text}" 
                                data-category="${keyword.category}" 
                                data-severity="${keyword.severity}"
                                data-tooltip="${keyword.description}">$1</span>`
                    );
                });

                return highlightedContent;
            }

            addKeywordHighlighting() {
                // Add highlighting to business description if available
                const businessDescription = document.querySelector('.business-description');
                if (businessDescription) {
                    const originalContent = businessDescription.textContent;
                    const highlightedContent = this.highlightRiskKeywords(originalContent, this.getDetectedKeywords());
                    businessDescription.innerHTML = highlightedContent;
                    
                    // Add tooltips to highlighted keywords
                    this.addHighlightedKeywordTooltips();
                }

                // Add highlighting to website content if available
                const websiteContent = document.querySelector('.website-content');
                if (websiteContent) {
                    const originalContent = websiteContent.textContent;
                    const highlightedContent = this.highlightRiskKeywords(originalContent, this.getDetectedKeywords());
                    websiteContent.innerHTML = highlightedContent;
                    
                    // Add tooltips to highlighted keywords
                    this.addHighlightedKeywordTooltips();
                }
            }

            addHighlightedKeywordTooltips() {
                document.querySelectorAll('.keyword-highlight').forEach(element => {
                    const tooltip = element.getAttribute('data-tooltip');
                    if (tooltip) {
                        this.createTooltip(element, tooltip);
                    }
                });
            }

            getDetectedKeywords() {
                // This would normally come from the risk assessment API
                // For demonstration, return the keywords from the current risk data
                const riskData = this.getMockRiskData();
                return riskData.detectedKeywords || [];
            }

            toggleKeywordHighlighting() {
                const highlightedElements = document.querySelectorAll('.keyword-highlight');
                const isVisible = highlightedElements.length > 0 && highlightedElements[0].style.display !== 'none';
                
                highlightedElements.forEach(element => {
                    element.style.display = isVisible ? 'none' : 'inline';
                });

                // Update toggle button text
                const toggleButton = document.querySelector('.keyword-highlight-toggle');
                if (toggleButton) {
                    toggleButton.textContent = isVisible ? 'Show Risk Keywords' : 'Hide Risk Keywords';
                }
            }

            // Mobile-specific functionality
            initializeMobileFeatures() {
                // Add touch event listeners for mobile devices
                if (this.isMobileDevice()) {
                    this.addMobileTouchHandlers();
                    this.optimizeForMobile();
                }
            }

            isMobileDevice() {
                return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
                       window.innerWidth <= 768;
            }

            addMobileTouchHandlers() {
                // Add touch handlers for risk categories
                document.querySelectorAll('.risk-category').forEach(element => {
                    element.addEventListener('touchstart', (e) => {
                        element.style.backgroundColor = 'rgba(0, 0, 0, 0.05)';
                    });
                    
                    element.addEventListener('touchend', (e) => {
                        setTimeout(() => {
                            element.style.backgroundColor = '';
                        }, 150);
                    });
                });

                // Add touch handlers for keyword items
                document.querySelectorAll('.keyword-item').forEach(element => {
                    element.addEventListener('touchstart', (e) => {
                        element.style.backgroundColor = 'rgba(0, 0, 0, 0.05)';
                    });
                    
                    element.addEventListener('touchend', (e) => {
                        setTimeout(() => {
                            element.style.backgroundColor = '';
                        }, 150);
                    });
                });

                // Add long press for tooltips on mobile
                document.querySelectorAll('.risk-badge, .risk-category, .keyword-item').forEach(element => {
                    let longPressTimer;
                    
                    element.addEventListener('touchstart', (e) => {
                        longPressTimer = setTimeout(() => {
                            this.showMobileTooltip(element);
                        }, 500);
                    });
                    
                    element.addEventListener('touchend', () => {
                        clearTimeout(longPressTimer);
                    });
                    
                    element.addEventListener('touchmove', () => {
                        clearTimeout(longPressTimer);
                    });
                });
            }

            optimizeForMobile() {
                // Adjust tooltip positioning for mobile
                const originalCreateTooltip = this.createTooltip.bind(this);
                this.createTooltip = (element, content) => {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'risk-tooltip mobile-tooltip';
                    tooltip.innerHTML = content;
                    element.appendChild(tooltip);
                    
                    // For mobile, show tooltip on click instead of hover
                    if (this.isMobileDevice()) {
                        element.addEventListener('click', (e) => {
                            e.preventDefault();
                            this.toggleMobileTooltip(tooltip);
                        });
                    } else {
                        element.addEventListener('mouseenter', () => {
                            tooltip.classList.add('show');
                        });
                        
                        element.addEventListener('mouseleave', () => {
                            tooltip.classList.remove('show');
                        });
                    }
                };
            }

            showMobileTooltip(element) {
                const tooltip = element.querySelector('.risk-tooltip');
                if (tooltip) {
                    this.toggleMobileTooltip(tooltip);
                }
            }

            toggleMobileTooltip(tooltip) {
                // Hide all other tooltips
                document.querySelectorAll('.risk-tooltip.show').forEach(t => {
                    if (t !== tooltip) {
                        t.classList.remove('show');
                    }
                });
                
                // Toggle current tooltip
                tooltip.classList.toggle('show');
                
                // Auto-hide after 3 seconds
                setTimeout(() => {
                    tooltip.classList.remove('show');
                }, 3000);
            }

            async loadRiskAssessment() {
                const loading = document.getElementById('riskLoading');
                const content = document.getElementById('riskContent');
                
                loading.style.display = 'flex';
                content.style.display = 'none';

                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 1200));

                loading.style.display = 'none';
                content.style.display = 'block';
            }

            async loadRiskIndicators() {
                const loading = document.getElementById('indicatorsLoading');
                const content = document.getElementById('indicatorsContent');
                
                loading.style.display = 'flex';
                content.style.display = 'none';

                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 1000));

                loading.style.display = 'none';
                content.style.display = 'block';
            }

            initializeMobileOptimization() {
                if (typeof MobileOptimization !== 'undefined') {
                    const mobileOpt = new MobileOptimization({
                        touchTargetSize: 48,
                        enableTouchOptimization: true,
                        enableProgressiveEnhancement: true
                    });
                    mobileOpt.optimizeForMobile();
                }
            }

            showNotification(message, type = 'info') {
                // Create notification element
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                notification.innerHTML = `
                    <i class="fas fa-${type === 'error' ? 'exclamation-circle' : type === 'success' ? 'check-circle' : 'info-circle'}"></i>
                    ${message}
                `;
                
                // Add styles
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${type === 'error' ? '#e74c3c' : type === 'success' ? '#27ae60' : '#3498db'};
                    color: white;
                    padding: 15px 20px;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    z-index: 10000;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    max-width: 400px;
                    animation: slideIn 0.3s ease;
                `;
                
                document.body.appendChild(notification);
                
                // Remove after 5 seconds
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }, 5000);
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            window.merchantHandler = new MerchantDetailsHandler();
        });

        // Add notification animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
