<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KYB Platform - Market Analysis Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="components/navigation.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s ease-in-out;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        /* Market Analysis Specific Styles */
        .market-trend-up {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        .market-trend-down {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }
        .market-trend-stable {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            color: white;
        }
        
        .opportunity-high {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
        }
        .opportunity-medium {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }
        .opportunity-low {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            color: white;
        }
        
        .benchmark-excellent {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        .benchmark-good {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
        }
        .benchmark-average {
            background: linear-gradient(135deg, #eab308, #ca8a04);
            color: white;
        }
        .benchmark-below-average {
            background: linear-gradient(135deg, #f97316, #ea580c);
            color: white;
        }
        .benchmark-poor {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }
        
        .skeleton-loading {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        .progressive-disclosure {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s ease-in-out;
        }
        .progressive-disclosure.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        
        .metric-card:hover {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        
        .trend-indicator {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .trend-up {
            background: #dcfce7;
            color: #166534;
        }
        
        .trend-down {
            background: #fef2f2;
            color: #dc2626;
        }
        
        .trend-stable {
            background: #f3f4f6;
            color: #374151;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .opportunity-card {
            transition: all 0.3s ease-in-out;
        }
        
        .opportunity-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50">
<!-- DEPRECATION NOTICE -->
<div style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; padding: 16px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
    <div style="display: flex; align-items: center; gap: 12px;">
        <span style="font-size: 24px;">⚠️</span>
        <div style="flex: 1;">
            <strong style="font-size: 18px; display: block; margin-bottom: 4px;">This page is deprecated</strong>
            <p style="margin: 0; font-size: 14px; opacity: 0.95;">
                This legacy UI page has been replaced with a new shadcn UI implementation. 
                Please use the new UI for the best experience. 
                <a href="/" style="color: white; text-decoration: underline; font-weight: bold;">Go to new UI →</a>
            </p>
        </div>
    </div>
</div>
    <!-- Navigation -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-xl font-bold text-gray-900">KYB Market Analysis Dashboard</h1>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">MARKET ANALYSIS</span>
                    <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded">LIVE</span>
                    <button id="helpBtn" class="text-gray-600 hover:text-gray-900">
                        <i class="fas fa-question-circle"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Header Section -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">Market Analysis Dashboard</h2>
                    <p class="text-gray-600">Comprehensive market intelligence and industry benchmarking for informed business decisions</p>
                </div>
                <div class="flex space-x-4">
                    <button id="refreshData" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                        <i class="fas fa-sync-alt mr-2"></i>Refresh Data
                    </button>
                    <button id="exportReport" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                        <i class="fas fa-download mr-2"></i>Export Report
                    </button>
                </div>
            </div>
        </div>

        <!-- Market Overview Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Market Size Card -->
            <div class="metric-card card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Market Size</p>
                        <p class="text-2xl font-bold text-gray-900" id="marketSize">$2.4T</p>
                        <div class="flex items-center mt-2">
                            <span class="trend-indicator trend-up">
                                <i class="fas fa-arrow-up mr-1"></i>+12.5%
                            </span>
                            <span class="text-xs text-gray-500 ml-2">vs last year</span>
                        </div>
                    </div>
                    <div class="p-3 bg-blue-100 rounded-full">
                        <i class="fas fa-chart-line text-blue-600 text-xl"></i>
                    </div>
                </div>
            </div>

            <!-- Growth Rate Card -->
            <div class="metric-card card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Growth Rate</p>
                        <p class="text-2xl font-bold text-gray-900" id="growthRate">8.2%</p>
                        <div class="flex items-center mt-2">
                            <span class="trend-indicator trend-up">
                                <i class="fas fa-arrow-up mr-1"></i>+2.1%
                            </span>
                            <span class="text-xs text-gray-500 ml-2">vs last quarter</span>
                        </div>
                    </div>
                    <div class="p-3 bg-green-100 rounded-full">
                        <i class="fas fa-trending-up text-green-600 text-xl"></i>
                    </div>
                </div>
            </div>

            <!-- Market Share Card -->
            <div class="metric-card card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Your Market Share</p>
                        <p class="text-2xl font-bold text-gray-900" id="marketShare">3.2%</p>
                        <div class="flex items-center mt-2">
                            <span class="trend-indicator trend-up">
                                <i class="fas fa-arrow-up mr-1"></i>+0.8%
                            </span>
                            <span class="text-xs text-gray-500 ml-2">vs last year</span>
                        </div>
                    </div>
                    <div class="p-3 bg-purple-100 rounded-full">
                        <i class="fas fa-pie-chart text-purple-600 text-xl"></i>
                    </div>
                </div>
            </div>

            <!-- Competition Index Card -->
            <div class="metric-card card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Competition Index</p>
                        <p class="text-2xl font-bold text-gray-900" id="competitionIndex">7.4</p>
                        <div class="flex items-center mt-2">
                            <span class="trend-indicator trend-stable">
                                <i class="fas fa-minus mr-1"></i>0.0%
                            </span>
                            <span class="text-xs text-gray-500 ml-2">vs last quarter</span>
                        </div>
                    </div>
                    <div class="p-3 bg-orange-100 rounded-full">
                        <i class="fas fa-users text-orange-600 text-xl"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Dashboard Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Enhanced Industry Benchmarking Chart -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Industry Benchmarking</h3>
                    <div class="flex space-x-2">
                        <button id="benchmarkRevenue" class="px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full benchmark-btn active">Revenue</button>
                        <button id="benchmarkProfit" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full benchmark-btn">Profit</button>
                        <button id="benchmarkGrowth" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full benchmark-btn">Growth</button>
                        <button id="benchmarkEfficiency" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full benchmark-btn">Efficiency</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="benchmarkChart"></canvas>
                </div>
                <div class="mt-4 grid grid-cols-3 gap-4">
                    <div class="text-center">
                        <p class="text-sm text-gray-600">Your Performance</p>
                        <p class="text-lg font-bold text-blue-600" id="yourPercentile">85th Percentile</p>
                    </div>
                    <div class="text-center">
                        <p class="text-sm text-gray-600">Industry Average</p>
                        <p class="text-lg font-bold text-gray-600">50th Percentile</p>
                    </div>
                    <div class="text-center">
                        <p class="text-sm text-gray-600">Top Performer</p>
                        <p class="text-lg font-bold text-green-600">95th Percentile</p>
                    </div>
                </div>
                <div class="mt-4 p-4 bg-gray-50 rounded-lg">
                    <h4 class="font-semibold text-gray-900 mb-2">Benchmark Insights</h4>
                    <p class="text-sm text-gray-600" id="benchmarkInsights">
                        Your revenue performance exceeds industry average by 35%. Focus on operational efficiency to reach top performer status.
                    </p>
                </div>
            </div>

            <!-- Enhanced Market Trend Analysis -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Market Trends</h3>
                    <div class="flex space-x-2">
                        <button id="trend6M" class="px-3 py-1 text-sm bg-green-100 text-green-800 rounded-full trend-btn active">6M</button>
                        <button id="trend1Y" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full trend-btn">1Y</button>
                        <button id="trend3Y" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full trend-btn">3Y</button>
                        <button id="trend5Y" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full trend-btn">5Y</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
                <div class="mt-4 grid grid-cols-2 gap-4">
                    <div class="p-3 bg-blue-50 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                                <span class="text-sm font-medium">Market Growth</span>
                            </div>
                            <span class="text-sm font-bold text-blue-600" id="marketGrowthRate">+8.2%</span>
                        </div>
                    </div>
                    <div class="p-3 bg-green-50 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                                <span class="text-sm font-medium">Your Growth</span>
                            </div>
                            <span class="text-sm font-bold text-green-600" id="yourGrowthRate">+12.5%</span>
                        </div>
                    </div>
                </div>
                <div class="mt-4 p-4 bg-gradient-to-r from-blue-50 to-green-50 rounded-lg">
                    <h4 class="font-semibold text-gray-900 mb-2">Trend Analysis</h4>
                    <p class="text-sm text-gray-600" id="trendInsights">
                        Your growth rate is 4.3% above market average, indicating strong competitive positioning and market outperformance.
                    </p>
                </div>
            </div>
        </div>

        <!-- Additional Benchmarking Charts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Performance Comparison Chart -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Performance Comparison</h3>
                    <div class="flex space-x-2">
                        <button id="performanceBar" class="px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full performance-btn active">Bar Chart</button>
                        <button id="performanceDoughnut" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full performance-btn">Doughnut</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="performanceChart"></canvas>
                </div>
                <div class="mt-4 grid grid-cols-2 gap-4">
                    <div class="text-center p-3 bg-blue-50 rounded-lg">
                        <p class="text-sm text-gray-600">Revenue Growth</p>
                        <p class="text-lg font-bold text-blue-600">+15.2%</p>
                    </div>
                    <div class="text-center p-3 bg-green-50 rounded-lg">
                        <p class="text-sm text-gray-600">Profit Margin</p>
                        <p class="text-lg font-bold text-green-600">12.8%</p>
                    </div>
                </div>
            </div>

            <!-- Industry Position Chart -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Industry Position</h3>
                    <div class="flex space-x-2">
                        <button id="positionScatter" class="px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full position-btn active">Scatter</button>
                        <button id="positionBubble" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full position-btn">Bubble</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="positionChart"></canvas>
                </div>
                <div class="mt-4 p-4 bg-yellow-50 rounded-lg">
                    <h4 class="font-semibold text-yellow-800 mb-2">Position Analysis</h4>
                    <p class="text-sm text-yellow-700">
                        Your company is positioned in the "High Growth, High Profit" quadrant, indicating strong market position.
                    </p>
                </div>
            </div>
        </div>

        <!-- Advanced Trend Visualization Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Market Forecasting Chart -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Market Forecasting</h3>
                    <div class="flex space-x-2">
                        <button id="forecastLinear" class="px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full forecast-btn active">Linear</button>
                        <button id="forecastExponential" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full forecast-btn">Exponential</button>
                        <button id="forecastPolynomial" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full forecast-btn">Polynomial</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="forecastChart"></canvas>
                </div>
                <div class="mt-4 grid grid-cols-3 gap-4">
                    <div class="text-center p-3 bg-blue-50 rounded-lg">
                        <p class="text-sm text-gray-600">Next Quarter</p>
                        <p class="text-lg font-bold text-blue-600" id="nextQuarter">+9.2%</p>
                    </div>
                    <div class="text-center p-3 bg-green-50 rounded-lg">
                        <p class="text-sm text-gray-600">Next Year</p>
                        <p class="text-lg font-bold text-green-600" id="nextYear">+11.8%</p>
                    </div>
                    <div class="text-center p-3 bg-purple-50 rounded-lg">
                        <p class="text-sm text-gray-600">Confidence</p>
                        <p class="text-lg font-bold text-purple-600" id="forecastConfidence">87%</p>
                    </div>
                </div>
            </div>

            <!-- Seasonal Trend Analysis -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Seasonal Trends</h3>
                    <div class="flex space-x-2">
                        <button id="seasonalMonthly" class="px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full seasonal-btn active">Monthly</button>
                        <button id="seasonalQuarterly" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full seasonal-btn">Quarterly</button>
                        <button id="seasonalYearly" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full seasonal-btn">Yearly</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="seasonalChart"></canvas>
                </div>
                <div class="mt-4 p-4 bg-yellow-50 rounded-lg">
                    <h4 class="font-semibold text-yellow-800 mb-2">Seasonal Insights</h4>
                    <p class="text-sm text-yellow-700" id="seasonalInsights">
                        Q4 shows 23% higher performance due to holiday season. Q2 is typically the weakest quarter with 8% below average.
                    </p>
                </div>
            </div>
        </div>

        <!-- Trend Comparison and Volatility Analysis -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Market Volatility Chart -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Market Volatility</h3>
                    <div class="flex space-x-2">
                        <button id="volatility30D" class="px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full volatility-btn active">30D</button>
                        <button id="volatility90D" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full volatility-btn">90D</button>
                        <button id="volatility1Y" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full volatility-btn">1Y</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="volatilityChart"></canvas>
                </div>
                <div class="mt-4 grid grid-cols-2 gap-4">
                    <div class="text-center p-3 bg-red-50 rounded-lg">
                        <p class="text-sm text-gray-600">Volatility Index</p>
                        <p class="text-lg font-bold text-red-600" id="volatilityIndex">2.3</p>
                    </div>
                    <div class="text-center p-3 bg-green-50 rounded-lg">
                        <p class="text-sm text-gray-600">Stability Score</p>
                        <p class="text-lg font-bold text-green-600" id="stabilityScore">7.7</p>
                    </div>
                </div>
            </div>

            <!-- Trend Momentum Analysis -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Trend Momentum</h3>
                    <div class="flex space-x-2">
                        <button id="momentumRSI" class="px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full momentum-btn active">RSI</button>
                        <button id="momentumMACD" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full momentum-btn">MACD</button>
                        <button id="momentumBollinger" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full momentum-btn">Bollinger</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="momentumChart"></canvas>
                </div>
                <div class="mt-4 p-4 bg-indigo-50 rounded-lg">
                    <h4 class="font-semibold text-indigo-800 mb-2">Momentum Analysis</h4>
                    <p class="text-sm text-indigo-700" id="momentumInsights">
                        Strong upward momentum with RSI at 68. Market is in bullish territory with potential for continued growth.
                    </p>
                </div>
            </div>
        </div>

        <!-- Enhanced Market Opportunities Section -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-900">Market Opportunities</h3>
                <div class="flex space-x-2">
                    <button id="opportunityAll" class="px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full opportunity-filter active">All</button>
                    <button id="opportunityHigh" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full opportunity-filter">High</button>
                    <button id="opportunityMedium" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full opportunity-filter">Medium</button>
                    <button id="opportunityLow" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full opportunity-filter">Low</button>
                </div>
            </div>
            
            <!-- Opportunity Overview Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-green-800">High Opportunities</p>
                            <p class="text-2xl font-bold text-green-900" id="highOpportunityCount">3</p>
                        </div>
                        <div class="p-2 bg-green-200 rounded-full">
                            <i class="fas fa-arrow-up text-green-700"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-yellow-50 to-yellow-100 rounded-lg p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-yellow-800">Medium Opportunities</p>
                            <p class="text-2xl font-bold text-yellow-900" id="mediumOpportunityCount">5</p>
                        </div>
                        <div class="p-2 bg-yellow-200 rounded-full">
                            <i class="fas fa-minus text-yellow-700"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-gray-50 to-gray-100 rounded-lg p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-800">Low Opportunities</p>
                            <p class="text-2xl font-bold text-gray-900" id="lowOpportunityCount">2</p>
                        </div>
                        <div class="p-2 bg-gray-200 rounded-full">
                            <i class="fas fa-arrow-down text-gray-700"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-blue-800">Total Potential</p>
                            <p class="text-2xl font-bold text-blue-900" id="totalPotential">$4.2M</p>
                        </div>
                        <div class="p-2 bg-blue-200 rounded-full">
                            <i class="fas fa-dollar-sign text-blue-700"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Opportunity Cards Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="opportunityCards">
                <!-- High Opportunity 1 -->
                <div class="border border-gray-200 rounded-lg p-4 card-hover opportunity-card" data-priority="high">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-gray-900">Emerging Markets</h4>
                        <span class="opportunity-high px-2 py-1 rounded-full text-xs font-medium">HIGH</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">Untapped markets with high growth potential and low competition.</p>
                    <div class="mb-3">
                        <div class="flex justify-between text-xs text-gray-500 mb-1">
                            <span>Market Size</span>
                            <span>85%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-green-500 h-2 rounded-full" style="width: 85%"></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm text-gray-500">Potential Revenue:</span>
                        <span class="font-semibold text-green-600">$2.1M</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-500">ROI:</span>
                        <span class="font-semibold text-green-600">+340%</span>
                    </div>
                </div>

                <!-- High Opportunity 2 -->
                <div class="border border-gray-200 rounded-lg p-4 card-hover opportunity-card" data-priority="high">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-gray-900">Digital Transformation</h4>
                        <span class="opportunity-high px-2 py-1 rounded-full text-xs font-medium">HIGH</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">Leverage digital technologies to improve operational efficiency and customer experience.</p>
                    <div class="mb-3">
                        <div class="flex justify-between text-xs text-gray-500 mb-1">
                            <span>Market Readiness</span>
                            <span>92%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-green-500 h-2 rounded-full" style="width: 92%"></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm text-gray-500">Potential Revenue:</span>
                        <span class="font-semibold text-green-600">$1.8M</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-500">ROI:</span>
                        <span class="font-semibold text-green-600">+280%</span>
                    </div>
                </div>

                <!-- High Opportunity 3 -->
                <div class="border border-gray-200 rounded-lg p-4 card-hover opportunity-card" data-priority="high">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-gray-900">Sustainability Focus</h4>
                        <span class="opportunity-high px-2 py-1 rounded-full text-xs font-medium">HIGH</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">Growing demand for sustainable business practices and eco-friendly solutions.</p>
                    <div class="mb-3">
                        <div class="flex justify-between text-xs text-gray-500 mb-1">
                            <span>Consumer Demand</span>
                            <span>78%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-green-500 h-2 rounded-full" style="width: 78%"></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm text-gray-500">Potential Revenue:</span>
                        <span class="font-semibold text-green-600">$1.5M</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-500">ROI:</span>
                        <span class="font-semibold text-green-600">+220%</span>
                    </div>
                </div>

                <!-- Medium Opportunity 1 -->
                <div class="border border-gray-200 rounded-lg p-4 card-hover opportunity-card" data-priority="medium">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-gray-900">Product Expansion</h4>
                        <span class="opportunity-medium px-2 py-1 rounded-full text-xs font-medium">MEDIUM</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">Expand existing product lines to capture additional market share.</p>
                    <div class="mb-3">
                        <div class="flex justify-between text-xs text-gray-500 mb-1">
                            <span>Market Penetration</span>
                            <span>65%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-yellow-500 h-2 rounded-full" style="width: 65%"></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm text-gray-500">Potential Revenue:</span>
                        <span class="font-semibold text-yellow-600">$850K</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-500">ROI:</span>
                        <span class="font-semibold text-yellow-600">+150%</span>
                    </div>
                </div>

                <!-- Medium Opportunity 2 -->
                <div class="border border-gray-200 rounded-lg p-4 card-hover opportunity-card" data-priority="medium">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-gray-900">Geographic Expansion</h4>
                        <span class="opportunity-medium px-2 py-1 rounded-full text-xs font-medium">MEDIUM</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">Enter new geographic markets with existing product portfolio.</p>
                    <div class="mb-3">
                        <div class="flex justify-between text-xs text-gray-500 mb-1">
                            <span>Market Accessibility</span>
                            <span>58%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-yellow-500 h-2 rounded-full" style="width: 58%"></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm text-gray-500">Potential Revenue:</span>
                        <span class="font-semibold text-yellow-600">$720K</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-500">ROI:</span>
                        <span class="font-semibold text-yellow-600">+120%</span>
                    </div>
                </div>

                <!-- Medium Opportunity 3 -->
                <div class="border border-gray-200 rounded-lg p-4 card-hover opportunity-card" data-priority="medium">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-gray-900">Partnership Opportunities</h4>
                        <span class="opportunity-medium px-2 py-1 rounded-full text-xs font-medium">MEDIUM</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">Strategic partnerships to expand market reach and capabilities.</p>
                    <div class="mb-3">
                        <div class="flex justify-between text-xs text-gray-500 mb-1">
                            <span>Partnership Potential</span>
                            <span>72%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-yellow-500 h-2 rounded-full" style="width: 72%"></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm text-gray-500">Potential Revenue:</span>
                        <span class="font-semibold text-yellow-600">$650K</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-500">ROI:</span>
                        <span class="font-semibold text-yellow-600">+180%</span>
                    </div>
                </div>

                <!-- Low Opportunity 1 -->
                <div class="border border-gray-200 rounded-lg p-4 card-hover opportunity-card" data-priority="low">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-gray-900">Market Saturation</h4>
                        <span class="opportunity-low px-2 py-1 rounded-full text-xs font-medium">LOW</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">Mature markets with limited growth opportunities.</p>
                    <div class="mb-3">
                        <div class="flex justify-between text-xs text-gray-500 mb-1">
                            <span>Growth Potential</span>
                            <span>25%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-gray-500 h-2 rounded-full" style="width: 25%"></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm text-gray-500">Potential Revenue:</span>
                        <span class="font-semibold text-gray-600">$120K</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-500">ROI:</span>
                        <span class="font-semibold text-gray-600">+45%</span>
                    </div>
                </div>

                <!-- Low Opportunity 2 -->
                <div class="border border-gray-200 rounded-lg p-4 card-hover opportunity-card" data-priority="low">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-gray-900">Legacy Technology</h4>
                        <span class="opportunity-low px-2 py-1 rounded-full text-xs font-medium">LOW</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">Outdated technology markets with declining demand.</p>
                    <div class="mb-3">
                        <div class="flex justify-between text-xs text-gray-500 mb-1">
                            <span>Market Decline</span>
                            <span>15%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-gray-500 h-2 rounded-full" style="width: 15%"></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm text-gray-500">Potential Revenue:</span>
                        <span class="font-semibold text-gray-600">$80K</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-500">ROI:</span>
                        <span class="font-semibold text-gray-600">+20%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Market Comparison Tools Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Market Segment Comparison -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Market Segment Comparison</h3>
                    <div class="flex space-x-2">
                        <button id="segmentRevenue" class="px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full segment-btn active">Revenue</button>
                        <button id="segmentGrowth" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full segment-btn">Growth</button>
                        <button id="segmentProfit" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full segment-btn">Profit</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="segmentChart"></canvas>
                </div>
                <div class="mt-4 grid grid-cols-2 gap-4">
                    <div class="text-center p-3 bg-blue-50 rounded-lg">
                        <p class="text-sm text-gray-600">Leading Segment</p>
                        <p class="text-lg font-bold text-blue-600" id="leadingSegment">Technology</p>
                    </div>
                    <div class="text-center p-3 bg-green-50 rounded-lg">
                        <p class="text-sm text-gray-600">Growth Leader</p>
                        <p class="text-lg font-bold text-green-600" id="growthLeader">Healthcare</p>
                    </div>
                </div>
            </div>

            <!-- Geographic Market Comparison -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Geographic Markets</h3>
                    <div class="flex space-x-2">
                        <button id="geoRevenue" class="px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full geo-btn active">Revenue</button>
                        <button id="geoMarket" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full geo-btn">Market Size</button>
                        <button id="geoPenetration" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full geo-btn">Penetration</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="geographicChart"></canvas>
                </div>
                <div class="mt-4 p-4 bg-purple-50 rounded-lg">
                    <h4 class="font-semibold text-purple-800 mb-2">Geographic Insights</h4>
                    <p class="text-sm text-purple-700" id="geographicInsights">
                        North America shows highest revenue potential with 45% market penetration. Europe offers growth opportunities with 32% penetration.
                    </p>
                </div>
            </div>
        </div>

        <!-- Advanced Competitive Analysis Section -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-900">Competitive Landscape Analysis</h3>
                <div class="flex space-x-2">
                    <button id="competitiveTable" class="px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full competitive-view active">Table</button>
                    <button id="competitiveChart" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full competitive-view">Chart</button>
                    <button id="competitiveMatrix" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-full competitive-view">Matrix</button>
                </div>
            </div>
            
            <!-- Competitive Analysis Table View -->
            <div id="competitiveTableView" class="competitive-view-content">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Market Share</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Growth Rate</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Revenue</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Threat Level</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-8 w-8">
                                            <div class="h-8 w-8 rounded-full bg-red-100 flex items-center justify-center">
                                                <span class="text-red-600 font-semibold text-sm">A</span>
                                            </div>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900">Alpha Corp</div>
                                            <div class="text-sm text-gray-500">Market Leader</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">24.5%</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="trend-indicator trend-up">+8.2%</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$2.1B</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="benchmark-poor px-2 py-1 rounded-full text-xs font-medium">HIGH</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <button class="text-blue-600 hover:text-blue-900 text-sm font-medium">Analyze</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-8 w-8">
                                            <div class="h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center">
                                                <span class="text-blue-600 font-semibold text-sm">B</span>
                                            </div>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900">Beta Industries</div>
                                            <div class="text-sm text-gray-500">Strong Competitor</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">18.2%</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="trend-indicator trend-up">+5.7%</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$1.6B</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="benchmark-below-average px-2 py-1 rounded-full text-xs font-medium">MEDIUM</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <button class="text-blue-600 hover:text-blue-900 text-sm font-medium">Analyze</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-8 w-8">
                                            <div class="h-8 w-8 rounded-full bg-green-100 flex items-center justify-center">
                                                <span class="text-green-600 font-semibold text-sm">Y</span>
                                            </div>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900">Your Company</div>
                                            <div class="text-sm text-gray-500">Your Business</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">3.2%</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="trend-indicator trend-up">+12.5%</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$280M</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="benchmark-excellent px-2 py-1 rounded-full text-xs font-medium">GROWING</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <button class="text-green-600 hover:text-green-900 text-sm font-medium">View</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Competitive Analysis Chart View -->
            <div id="competitiveChartView" class="competitive-view-content hidden">
                <div class="chart-container">
                    <canvas id="competitiveChartCanvas"></canvas>
                </div>
                <div class="mt-4 grid grid-cols-3 gap-4">
                    <div class="text-center p-3 bg-red-50 rounded-lg">
                        <p class="text-sm text-gray-600">Market Leader</p>
                        <p class="text-lg font-bold text-red-600">Alpha Corp</p>
                        <p class="text-xs text-gray-500">24.5% Share</p>
                    </div>
                    <div class="text-center p-3 bg-blue-50 rounded-lg">
                        <p class="text-sm text-gray-600">Strong Competitor</p>
                        <p class="text-lg font-bold text-blue-600">Beta Industries</p>
                        <p class="text-xs text-gray-500">18.2% Share</p>
                    </div>
                    <div class="text-center p-3 bg-green-50 rounded-lg">
                        <p class="text-sm text-gray-600">Your Position</p>
                        <p class="text-lg font-bold text-green-600">Your Company</p>
                        <p class="text-xs text-gray-500">3.2% Share</p>
                    </div>
                </div>
            </div>

            <!-- Competitive Analysis Matrix View -->
            <div id="competitiveMatrixView" class="competitive-view-content hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="p-4 border border-gray-200 rounded-lg">
                        <h4 class="font-semibold text-gray-900 mb-4">Market Share vs Growth Rate</h4>
                        <div class="chart-container">
                            <canvas id="matrixChart"></canvas>
                        </div>
                    </div>
                    <div class="p-4 border border-gray-200 rounded-lg">
                        <h4 class="font-semibold text-gray-900 mb-4">Competitive Positioning</h4>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between p-3 bg-red-50 rounded-lg">
                                <span class="text-sm font-medium text-gray-900">Alpha Corp</span>
                                <span class="text-sm text-red-600 font-semibold">High Threat</span>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg">
                                <span class="text-sm font-medium text-gray-900">Beta Industries</span>
                                <span class="text-sm text-yellow-600 font-semibold">Medium Threat</span>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                                <span class="text-sm font-medium text-gray-900">Your Company</span>
                                <span class="text-sm text-green-600 font-semibold">Growing</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-6 flex items-center space-x-4">
            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
            <span class="text-gray-700">Loading market data...</span>
        </div>
    </div>

    <script>
        // Market Analysis Dashboard JavaScript
        class MarketAnalysisDashboard {
            constructor() {
                this.charts = {};
                this.currentBenchmarkType = 'revenue';
                this.currentPerformanceType = 'bar';
                this.currentPositionType = 'scatter';
                this.currentTrendPeriod = '6M';
                this.currentForecastType = 'linear';
                this.currentSeasonalType = 'monthly';
                this.currentVolatilityPeriod = '30D';
                this.currentMomentumType = 'rsi';
                this.currentSegmentType = 'revenue';
                this.currentGeographicType = 'revenue';
                this.currentCompetitiveView = 'table';
                this.data = {
                    marketSize: 2400000000000, // $2.4T
                    growthRate: 8.2,
                    marketShare: 3.2,
                    competitionIndex: 7.4,
                    benchmarkData: {
                        revenue: {
                            labels: ['Revenue Growth', 'Profit Margin', 'Market Share', 'Innovation', 'Customer Satisfaction', 'Operational Efficiency'],
                            yourData: [85, 78, 45, 92, 88, 82],
                            industryData: [50, 45, 50, 60, 55, 50],
                            percentile: 85,
                            insights: "Your revenue performance exceeds industry average by 35%. Focus on operational efficiency to reach top performer status."
                        },
                        profit: {
                            labels: ['Profit Margin', 'Cost Efficiency', 'Pricing Power', 'Operational Excellence', 'Financial Health', 'ROI'],
                            yourData: [78, 82, 65, 75, 88, 80],
                            industryData: [45, 50, 40, 55, 50, 45],
                            percentile: 78,
                            insights: "Strong profit margins with room for improvement in pricing power. Focus on value-based pricing strategies."
                        },
                        growth: {
                            labels: ['Revenue Growth', 'Market Expansion', 'Customer Acquisition', 'Product Innovation', 'Geographic Growth', 'Digital Transformation'],
                            yourData: [92, 75, 88, 90, 70, 85],
                            industryData: [60, 55, 50, 65, 45, 60],
                            percentile: 92,
                            insights: "Exceptional growth performance across all metrics. Consider expanding into new geographic markets."
                        },
                        efficiency: {
                            labels: ['Operational Efficiency', 'Resource Utilization', 'Process Optimization', 'Technology Adoption', 'Workforce Productivity', 'Supply Chain'],
                            yourData: [82, 75, 80, 85, 78, 72],
                            industryData: [50, 45, 55, 60, 50, 55],
                            percentile: 82,
                            insights: "Good efficiency metrics with opportunities in supply chain optimization and workforce productivity."
                        }
                    },
                    trendData: {
                        '6M': {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            marketGrowth: [5.2, 6.1, 7.3, 8.2, 7.8, 8.2],
                            yourGrowth: [8.5, 9.2, 10.1, 11.8, 12.1, 12.5],
                            competitorGrowth: [4.8, 5.2, 5.9, 6.1, 5.8, 5.7],
                            insights: "Your growth rate is 4.3% above market average, indicating strong competitive positioning and market outperformance."
                        },
                        '1Y': {
                            labels: ['Q1 2023', 'Q2 2023', 'Q3 2023', 'Q4 2023', 'Q1 2024', 'Q2 2024'],
                            marketGrowth: [6.8, 7.2, 7.8, 8.1, 8.5, 8.2],
                            yourGrowth: [9.2, 10.1, 11.5, 12.8, 13.2, 12.5],
                            competitorGrowth: [5.1, 5.8, 6.2, 6.5, 6.8, 5.7],
                            insights: "Consistent year-over-year growth with 4.7% average outperformance. Strong Q4 performance indicates seasonal strength."
                        },
                        '3Y': {
                            labels: ['2022', '2023', '2024'],
                            marketGrowth: [5.2, 7.5, 8.2],
                            yourGrowth: [7.8, 11.2, 12.5],
                            competitorGrowth: [4.1, 5.9, 5.7],
                            insights: "Three-year compound growth of 12.5% vs market 8.2%. Accelerating growth trajectory with expanding market share."
                        },
                        '5Y': {
                            labels: ['2020', '2021', '2022', '2023', '2024'],
                            marketGrowth: [2.1, 4.8, 5.2, 7.5, 8.2],
                            yourGrowth: [3.2, 6.8, 7.8, 11.2, 12.5],
                            competitorGrowth: [1.8, 4.2, 4.1, 5.9, 5.7],
                            insights: "Five-year growth acceleration from 3.2% to 12.5%. Market recovery and expansion driving sustained outperformance."
                        }
                    },
                    forecastData: {
                        linear: {
                            nextQuarter: 9.2,
                            nextYear: 11.8,
                            confidence: 87,
                            data: [8.2, 8.5, 8.8, 9.2, 9.5, 9.8, 10.1, 10.4, 10.7, 11.0, 11.3, 11.6, 11.8]
                        },
                        exponential: {
                            nextQuarter: 9.8,
                            nextYear: 13.2,
                            confidence: 82,
                            data: [8.2, 8.4, 8.7, 9.1, 9.5, 9.9, 10.4, 10.9, 11.4, 11.9, 12.5, 12.8, 13.2]
                        },
                        polynomial: {
                            nextQuarter: 8.9,
                            nextYear: 10.5,
                            confidence: 91,
                            data: [8.2, 8.3, 8.5, 8.7, 8.8, 8.9, 9.0, 9.1, 9.2, 9.3, 9.4, 9.5, 10.5]
                        }
                    },
                    seasonalData: {
                        monthly: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                            data: [85, 78, 92, 88, 95, 98, 102, 105, 108, 112, 125, 128],
                            insights: "Q4 shows 23% higher performance due to holiday season. Q2 is typically the weakest quarter with 8% below average."
                        },
                        quarterly: {
                            labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                            data: [85, 94, 105, 122],
                            insights: "Strong Q4 performance with 22% above average. Q1 shows seasonal weakness with 15% below Q4 levels."
                        },
                        yearly: {
                            labels: ['2020', '2021', '2022', '2023', '2024'],
                            data: [75, 82, 88, 95, 102],
                            insights: "Consistent year-over-year growth with 8.2% average annual increase. 2024 showing strongest performance to date."
                        }
                    },
                    segmentData: {
                        revenue: {
                            labels: ['Technology', 'Healthcare', 'Finance', 'Retail', 'Manufacturing', 'Education'],
                            data: [450, 320, 280, 180, 150, 120],
                            leadingSegment: 'Technology',
                            growthLeader: 'Healthcare'
                        },
                        growth: {
                            labels: ['Technology', 'Healthcare', 'Finance', 'Retail', 'Manufacturing', 'Education'],
                            data: [12.5, 15.2, 8.7, 6.3, 4.8, 3.2],
                            leadingSegment: 'Healthcare',
                            growthLeader: 'Healthcare'
                        },
                        profit: {
                            labels: ['Technology', 'Healthcare', 'Finance', 'Retail', 'Manufacturing', 'Education'],
                            data: [18.5, 22.3, 15.7, 8.2, 12.1, 6.8],
                            leadingSegment: 'Healthcare',
                            growthLeader: 'Technology'
                        }
                    },
                    geographicData: {
                        revenue: {
                            labels: ['North America', 'Europe', 'Asia Pacific', 'Latin America', 'Middle East & Africa'],
                            data: [850, 420, 380, 180, 120],
                            insights: "North America shows highest revenue potential with 45% market penetration. Europe offers growth opportunities with 32% penetration."
                        },
                        market: {
                            labels: ['North America', 'Europe', 'Asia Pacific', 'Latin America', 'Middle East & Africa'],
                            data: [1200, 800, 950, 400, 250],
                            insights: "Asia Pacific represents largest addressable market with 950M potential customers. North America has highest penetration rate."
                        },
                        penetration: {
                            labels: ['North America', 'Europe', 'Asia Pacific', 'Latin America', 'Middle East & Africa'],
                            data: [45, 32, 28, 18, 12],
                            insights: "North America leads in market penetration at 45%. Significant growth opportunities in Asia Pacific and Latin America."
                        }
                    },
                    competitiveData: {
                        companies: [
                            { name: 'Alpha Corp', marketShare: 24.5, growth: 8.2, revenue: 2100, threat: 'high' },
                            { name: 'Beta Industries', marketShare: 18.2, growth: 5.7, revenue: 1600, threat: 'medium' },
                            { name: 'Your Company', marketShare: 3.2, growth: 12.5, revenue: 280, threat: 'growing' }
                        ]
                    }
                };
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.initializeCharts();
                this.loadMarketData();
                this.setupProgressiveDisclosure();
            }

            setupEventListeners() {
                document.getElementById('refreshData').addEventListener('click', () => {
                    this.refreshData();
                });

                document.getElementById('exportReport').addEventListener('click', () => {
                    this.exportReport();
                });

                document.getElementById('helpBtn').addEventListener('click', () => {
                    this.showHelp();
                });

                // Benchmark type buttons
                document.getElementById('benchmarkRevenue').addEventListener('click', () => {
                    this.switchBenchmarkType('revenue');
                });
                document.getElementById('benchmarkProfit').addEventListener('click', () => {
                    this.switchBenchmarkType('profit');
                });
                document.getElementById('benchmarkGrowth').addEventListener('click', () => {
                    this.switchBenchmarkType('growth');
                });
                document.getElementById('benchmarkEfficiency').addEventListener('click', () => {
                    this.switchBenchmarkType('efficiency');
                });

                // Performance chart type buttons
                document.getElementById('performanceBar').addEventListener('click', () => {
                    this.switchPerformanceType('bar');
                });
                document.getElementById('performanceDoughnut').addEventListener('click', () => {
                    this.switchPerformanceType('doughnut');
                });

                // Position chart type buttons
                document.getElementById('positionScatter').addEventListener('click', () => {
                    this.switchPositionType('scatter');
                });
                document.getElementById('positionBubble').addEventListener('click', () => {
                    this.switchPositionType('bubble');
                });

                // Trend period buttons
                document.getElementById('trend6M').addEventListener('click', () => {
                    this.switchTrendPeriod('6M');
                });
                document.getElementById('trend1Y').addEventListener('click', () => {
                    this.switchTrendPeriod('1Y');
                });
                document.getElementById('trend3Y').addEventListener('click', () => {
                    this.switchTrendPeriod('3Y');
                });
                document.getElementById('trend5Y').addEventListener('click', () => {
                    this.switchTrendPeriod('5Y');
                });

                // Forecast type buttons
                document.getElementById('forecastLinear').addEventListener('click', () => {
                    this.switchForecastType('linear');
                });
                document.getElementById('forecastExponential').addEventListener('click', () => {
                    this.switchForecastType('exponential');
                });
                document.getElementById('forecastPolynomial').addEventListener('click', () => {
                    this.switchForecastType('polynomial');
                });

                // Seasonal type buttons
                document.getElementById('seasonalMonthly').addEventListener('click', () => {
                    this.switchSeasonalType('monthly');
                });
                document.getElementById('seasonalQuarterly').addEventListener('click', () => {
                    this.switchSeasonalType('quarterly');
                });
                document.getElementById('seasonalYearly').addEventListener('click', () => {
                    this.switchSeasonalType('yearly');
                });

                // Volatility period buttons
                document.getElementById('volatility30D').addEventListener('click', () => {
                    this.switchVolatilityPeriod('30D');
                });
                document.getElementById('volatility90D').addEventListener('click', () => {
                    this.switchVolatilityPeriod('90D');
                });
                document.getElementById('volatility1Y').addEventListener('click', () => {
                    this.switchVolatilityPeriod('1Y');
                });

                // Momentum type buttons
                document.getElementById('momentumRSI').addEventListener('click', () => {
                    this.switchMomentumType('rsi');
                });
                document.getElementById('momentumMACD').addEventListener('click', () => {
                    this.switchMomentumType('macd');
                });
                document.getElementById('momentumBollinger').addEventListener('click', () => {
                    this.switchMomentumType('bollinger');
                });

                // Opportunity filter buttons
                document.getElementById('opportunityAll').addEventListener('click', () => {
                    this.filterOpportunities('all');
                });
                document.getElementById('opportunityHigh').addEventListener('click', () => {
                    this.filterOpportunities('high');
                });
                document.getElementById('opportunityMedium').addEventListener('click', () => {
                    this.filterOpportunities('medium');
                });
                document.getElementById('opportunityLow').addEventListener('click', () => {
                    this.filterOpportunities('low');
                });

                // Market comparison tool buttons
                // Segment comparison buttons
                document.getElementById('segmentRevenue').addEventListener('click', () => {
                    this.switchSegmentType('revenue');
                });
                document.getElementById('segmentGrowth').addEventListener('click', () => {
                    this.switchSegmentType('growth');
                });
                document.getElementById('segmentProfit').addEventListener('click', () => {
                    this.switchSegmentType('profit');
                });

                // Geographic comparison buttons
                document.getElementById('geoRevenue').addEventListener('click', () => {
                    this.switchGeographicType('revenue');
                });
                document.getElementById('geoMarket').addEventListener('click', () => {
                    this.switchGeographicType('market');
                });
                document.getElementById('geoPenetration').addEventListener('click', () => {
                    this.switchGeographicType('penetration');
                });

                // Competitive view buttons
                document.getElementById('competitiveTable').addEventListener('click', () => {
                    this.switchCompetitiveView('table');
                });
                document.getElementById('competitiveChart').addEventListener('click', () => {
                    this.switchCompetitiveView('chart');
                });
                document.getElementById('competitiveMatrix').addEventListener('click', () => {
                    this.switchCompetitiveView('matrix');
                });
            }

            initializeCharts() {
                this.createBenchmarkChart();
                this.createTrendChart();
                this.createPerformanceChart();
                this.createPositionChart();
                this.createForecastChart();
                this.createSeasonalChart();
                this.createVolatilityChart();
                this.createMomentumChart();
                this.createSegmentChart();
                this.createGeographicChart();
                this.createCompetitiveChart();
                this.createMatrixChart();
            }

            createBenchmarkChart() {
                const ctx = document.getElementById('benchmarkChart').getContext('2d');
                const currentData = this.data.benchmarkData[this.currentBenchmarkType];
                
                this.charts.benchmark = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: currentData.labels,
                        datasets: [{
                            label: 'Your Company',
                            data: currentData.yourData,
                            backgroundColor: 'rgba(59, 130, 246, 0.2)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgba(59, 130, 246, 1)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgba(59, 130, 246, 1)'
                        }, {
                            label: 'Industry Average',
                            data: currentData.industryData,
                            backgroundColor: 'rgba(156, 163, 175, 0.2)',
                            borderColor: 'rgba(156, 163, 175, 1)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgba(156, 163, 175, 1)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgba(156, 163, 175, 1)'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    stepSize: 20
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
            }

            createTrendChart() {
                const ctx = document.getElementById('trendChart').getContext('2d');
                const currentData = this.data.trendData[this.currentTrendPeriod];
                
                this.charts.trend = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: currentData.labels,
                        datasets: [{
                            label: 'Market Growth',
                            data: currentData.marketGrowth,
                            borderColor: 'rgba(59, 130, 246, 1)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }, {
                            label: 'Your Growth',
                            data: currentData.yourGrowth,
                            borderColor: 'rgba(34, 197, 94, 1)',
                            backgroundColor: 'rgba(34, 197, 94, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }, {
                            label: 'Competitor Average',
                            data: currentData.competitorGrowth,
                            borderColor: 'rgba(249, 115, 22, 1)',
                            backgroundColor: 'rgba(249, 115, 22, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Growth Rate (%)'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Period'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
            }

            createPerformanceChart() {
                const ctx = document.getElementById('performanceChart').getContext('2d');
                this.charts.performance = new Chart(ctx, {
                    type: this.currentPerformanceType,
                    data: {
                        labels: ['Revenue Growth', 'Profit Margin', 'Market Share', 'Customer Satisfaction', 'Operational Efficiency'],
                        datasets: [{
                            label: 'Your Company',
                            data: [85, 78, 45, 88, 82],
                            backgroundColor: [
                                'rgba(59, 130, 246, 0.8)',
                                'rgba(34, 197, 94, 0.8)',
                                'rgba(245, 158, 11, 0.8)',
                                'rgba(168, 85, 247, 0.8)',
                                'rgba(239, 68, 68, 0.8)'
                            ],
                            borderColor: [
                                'rgba(59, 130, 246, 1)',
                                'rgba(34, 197, 94, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(168, 85, 247, 1)',
                                'rgba(239, 68, 68, 1)'
                            ],
                            borderWidth: 2
                        }, {
                            label: 'Industry Average',
                            data: [50, 45, 50, 55, 50],
                            backgroundColor: 'rgba(156, 163, 175, 0.3)',
                            borderColor: 'rgba(156, 163, 175, 1)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: this.currentPerformanceType === 'bar' ? {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                title: {
                                    display: true,
                                    text: 'Performance Score'
                                }
                            }
                        } : {},
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
            }

            createPositionChart() {
                const ctx = document.getElementById('positionChart').getContext('2d');
                this.charts.position = new Chart(ctx, {
                    type: this.currentPositionType,
                    data: {
                        datasets: [{
                            label: 'Your Company',
                            data: [{
                                x: 85,
                                y: 78,
                                r: 15
                            }],
                            backgroundColor: 'rgba(59, 130, 246, 0.8)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            borderWidth: 2
                        }, {
                            label: 'Competitors',
                            data: [
                                { x: 45, y: 60, r: 20 },
                                { x: 70, y: 45, r: 18 },
                                { x: 55, y: 70, r: 12 },
                                { x: 80, y: 35, r: 16 },
                                { x: 40, y: 80, r: 14 },
                                { x: 65, y: 55, r: 10 }
                            ],
                            backgroundColor: 'rgba(156, 163, 175, 0.6)',
                            borderColor: 'rgba(156, 163, 175, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Growth Rate (%)'
                                },
                                min: 0,
                                max: 100
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Profit Margin (%)'
                                },
                                min: 0,
                                max: 100
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
            }

            createForecastChart() {
                const ctx = document.getElementById('forecastChart').getContext('2d');
                const currentData = this.data.forecastData[this.currentForecastType];
                
                this.charts.forecast = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Current', 'Q1', 'Q2', 'Q3', 'Q4', 'Q5', 'Q6', 'Q7', 'Q8', 'Q9', 'Q10', 'Q11', 'Q12'],
                        datasets: [{
                            label: 'Historical Data',
                            data: [8.2, 8.5, 8.8, 9.2, 9.5, 9.8, 10.1, 10.4, 10.7, 11.0, 11.3, 11.6, 11.8],
                            borderColor: 'rgba(59, 130, 246, 1)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 2,
                            fill: false
                        }, {
                            label: 'Forecast',
                            data: currentData.data,
                            borderColor: 'rgba(168, 85, 247, 1)',
                            backgroundColor: 'rgba(168, 85, 247, 0.1)',
                            borderWidth: 3,
                            borderDash: [5, 5],
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Growth Rate (%)'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Time Period'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
            }

            createSeasonalChart() {
                const ctx = document.getElementById('seasonalChart').getContext('2d');
                const currentData = this.data.seasonalData[this.currentSeasonalType];
                
                this.charts.seasonal = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: currentData.labels,
                        datasets: [{
                            label: 'Performance Index',
                            data: currentData.data,
                            backgroundColor: 'rgba(59, 130, 246, 0.8)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Performance Index'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Period'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
            }

            createVolatilityChart() {
                const ctx = document.getElementById('volatilityChart').getContext('2d');
                
                this.charts.volatility = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6', 'Week 7', 'Week 8'],
                        datasets: [{
                            label: 'Volatility Index',
                            data: [2.1, 2.3, 2.0, 2.4, 2.2, 2.5, 2.3, 2.3],
                            borderColor: 'rgba(239, 68, 68, 1)',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }, {
                            label: 'Stability Score',
                            data: [7.9, 7.7, 8.0, 7.6, 7.8, 7.5, 7.7, 7.7],
                            borderColor: 'rgba(34, 197, 94, 1)',
                            backgroundColor: 'rgba(34, 197, 94, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 10,
                                title: {
                                    display: true,
                                    text: 'Score'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Time Period'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
            }

            createMomentumChart() {
                const ctx = document.getElementById('momentumChart').getContext('2d');
                
                this.charts.momentum = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7', 'Day 8', 'Day 9', 'Day 10'],
                        datasets: [{
                            label: 'RSI',
                            data: [45, 52, 58, 62, 65, 68, 70, 68, 65, 68],
                            borderColor: 'rgba(59, 130, 246, 1)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4
                        }, {
                            label: 'Overbought (70)',
                            data: [70, 70, 70, 70, 70, 70, 70, 70, 70, 70],
                            borderColor: 'rgba(239, 68, 68, 1)',
                            borderWidth: 1,
                            borderDash: [5, 5],
                            fill: false
                        }, {
                            label: 'Oversold (30)',
                            data: [30, 30, 30, 30, 30, 30, 30, 30, 30, 30],
                            borderColor: 'rgba(34, 197, 94, 1)',
                            borderWidth: 1,
                            borderDash: [5, 5],
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                min: 0,
                                max: 100,
                                title: {
                                    display: true,
                                    text: 'RSI Value'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Time Period'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
            }

            switchBenchmarkType(type) {
                this.currentBenchmarkType = type;
                
                // Update button states
                document.querySelectorAll('.benchmark-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-100', 'text-blue-800');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`benchmark${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.remove('bg-gray-100', 'text-gray-600');
                document.getElementById(`benchmark${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.add('bg-blue-100', 'text-blue-800');
                
                // Update chart data
                const currentData = this.data.benchmarkData[type];
                this.charts.benchmark.data.labels = currentData.labels;
                this.charts.benchmark.data.datasets[0].data = currentData.yourData;
                this.charts.benchmark.data.datasets[1].data = currentData.industryData;
                this.charts.benchmark.update();
                
                // Update percentile and insights
                document.getElementById('yourPercentile').textContent = `${currentData.percentile}th Percentile`;
                document.getElementById('benchmarkInsights').textContent = currentData.insights;
            }

            switchPerformanceType(type) {
                this.currentPerformanceType = type;
                
                // Update button states
                document.querySelectorAll('.performance-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-100', 'text-blue-800');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`performance${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.remove('bg-gray-100', 'text-gray-600');
                document.getElementById(`performance${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.add('bg-blue-100', 'text-blue-800');
                
                // Destroy and recreate chart
                this.charts.performance.destroy();
                this.createPerformanceChart();
            }

            switchPositionType(type) {
                this.currentPositionType = type;
                
                // Update button states
                document.querySelectorAll('.position-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-100', 'text-blue-800');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`position${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.remove('bg-gray-100', 'text-gray-600');
                document.getElementById(`position${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.add('bg-blue-100', 'text-blue-800');
                
                // Destroy and recreate chart
                this.charts.position.destroy();
                this.createPositionChart();
            }

            switchTrendPeriod(period) {
                this.currentTrendPeriod = period;
                
                // Update button states
                document.querySelectorAll('.trend-btn').forEach(btn => {
                    btn.classList.remove('bg-green-100', 'text-green-800');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`trend${period}`).classList.remove('bg-gray-100', 'text-gray-600');
                document.getElementById(`trend${period}`).classList.add('bg-green-100', 'text-green-800');
                
                // Update chart data
                const currentData = this.data.trendData[period];
                this.charts.trend.data.labels = currentData.labels;
                this.charts.trend.data.datasets[0].data = currentData.marketGrowth;
                this.charts.trend.data.datasets[1].data = currentData.yourGrowth;
                this.charts.trend.data.datasets[2].data = currentData.competitorGrowth;
                this.charts.trend.update();
                
                // Update insights and metrics
                document.getElementById('trendInsights').textContent = currentData.insights;
                document.getElementById('marketGrowthRate').textContent = `+${currentData.marketGrowth[currentData.marketGrowth.length - 1]}%`;
                document.getElementById('yourGrowthRate').textContent = `+${currentData.yourGrowth[currentData.yourGrowth.length - 1]}%`;
            }

            switchForecastType(type) {
                this.currentForecastType = type;
                
                // Update button states
                document.querySelectorAll('.forecast-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-100', 'text-blue-800');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`forecast${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.remove('bg-gray-100', 'text-gray-600');
                document.getElementById(`forecast${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.add('bg-blue-100', 'text-blue-800');
                
                // Update chart data
                const currentData = this.data.forecastData[type];
                this.charts.forecast.data.datasets[1].data = currentData.data;
                this.charts.forecast.update();
                
                // Update forecast metrics
                document.getElementById('nextQuarter').textContent = `+${currentData.nextQuarter}%`;
                document.getElementById('nextYear').textContent = `+${currentData.nextYear}%`;
                document.getElementById('forecastConfidence').textContent = `${currentData.confidence}%`;
            }

            switchSeasonalType(type) {
                this.currentSeasonalType = type;
                
                // Update button states
                document.querySelectorAll('.seasonal-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-100', 'text-blue-800');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`seasonal${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.remove('bg-gray-100', 'text-gray-600');
                document.getElementById(`seasonal${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.add('bg-blue-100', 'text-blue-800');
                
                // Update chart data
                const currentData = this.data.seasonalData[type];
                this.charts.seasonal.data.labels = currentData.labels;
                this.charts.seasonal.data.datasets[0].data = currentData.data;
                this.charts.seasonal.update();
                
                // Update insights
                document.getElementById('seasonalInsights').textContent = currentData.insights;
            }

            switchVolatilityPeriod(period) {
                this.currentVolatilityPeriod = period;
                
                // Update button states
                document.querySelectorAll('.volatility-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-100', 'text-blue-800');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`volatility${period}`).classList.remove('bg-gray-100', 'text-gray-600');
                document.getElementById(`volatility${period}`).classList.add('bg-blue-100', 'text-blue-800');
                
                // Update metrics (simplified for demo)
                const volatilityData = {
                    '30D': { index: 2.3, stability: 7.7 },
                    '90D': { index: 2.1, stability: 7.9 },
                    '1Y': { index: 2.5, stability: 7.5 }
                };
                
                document.getElementById('volatilityIndex').textContent = volatilityData[period].index;
                document.getElementById('stabilityScore').textContent = volatilityData[period].stability;
            }

            switchMomentumType(type) {
                this.currentMomentumType = type;
                
                // Update button states
                document.querySelectorAll('.momentum-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-100', 'text-blue-800');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`momentum${type.toUpperCase()}`).classList.remove('bg-gray-100', 'text-gray-600');
                document.getElementById(`momentum${type.toUpperCase()}`).classList.add('bg-blue-100', 'text-blue-800');
                
                // Update insights based on momentum type
                const momentumInsights = {
                    'rsi': "Strong upward momentum with RSI at 68. Market is in bullish territory with potential for continued growth.",
                    'macd': "MACD shows positive divergence with signal line crossover. Bullish momentum confirmed with increasing volume.",
                    'bollinger': "Price trading near upper Bollinger Band indicates strong momentum. Watch for potential reversal signals."
                };
                
                document.getElementById('momentumInsights').textContent = momentumInsights[type];
            }

            createSegmentChart() {
                const ctx = document.getElementById('segmentChart').getContext('2d');
                const currentData = this.data.segmentData[this.currentSegmentType];
                
                if (this.charts.segmentChart) {
                    this.charts.segmentChart.destroy();
                }
                
                this.charts.segmentChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: currentData.labels,
                        datasets: [{
                            label: this.currentSegmentType.charAt(0).toUpperCase() + this.currentSegmentType.slice(1),
                            data: currentData.data,
                            backgroundColor: [
                                'rgba(59, 130, 246, 0.8)',
                                'rgba(16, 185, 129, 0.8)',
                                'rgba(245, 158, 11, 0.8)',
                                'rgba(239, 68, 68, 0.8)',
                                'rgba(139, 92, 246, 0.8)',
                                'rgba(236, 72, 153, 0.8)'
                            ],
                            borderColor: [
                                'rgba(59, 130, 246, 1)',
                                'rgba(16, 185, 129, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(139, 92, 246, 1)',
                                'rgba(236, 72, 153, 1)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }

            createGeographicChart() {
                const ctx = document.getElementById('geographicChart').getContext('2d');
                const currentData = this.data.geographicData[this.currentGeographicType];
                
                if (this.charts.geographicChart) {
                    this.charts.geographicChart.destroy();
                }
                
                this.charts.geographicChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: currentData.labels,
                        datasets: [{
                            data: currentData.data,
                            backgroundColor: [
                                'rgba(59, 130, 246, 0.8)',
                                'rgba(16, 185, 129, 0.8)',
                                'rgba(245, 158, 11, 0.8)',
                                'rgba(239, 68, 68, 0.8)',
                                'rgba(139, 92, 246, 0.8)'
                            ],
                            borderColor: [
                                'rgba(59, 130, 246, 1)',
                                'rgba(16, 185, 129, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(139, 92, 246, 1)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
            }

            createCompetitiveChart() {
                const ctx = document.getElementById('competitiveChartCanvas').getContext('2d');
                const companies = this.data.competitiveData.companies;
                
                if (this.charts.competitiveChart) {
                    this.charts.competitiveChart.destroy();
                }
                
                this.charts.competitiveChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: companies.map(c => c.name),
                        datasets: [{
                            label: 'Market Share (%)',
                            data: companies.map(c => c.marketShare),
                            backgroundColor: [
                                'rgba(239, 68, 68, 0.8)',
                                'rgba(59, 130, 246, 0.8)',
                                'rgba(16, 185, 129, 0.8)'
                            ],
                            borderColor: [
                                'rgba(239, 68, 68, 1)',
                                'rgba(59, 130, 246, 1)',
                                'rgba(16, 185, 129, 1)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }

            createMatrixChart() {
                const ctx = document.getElementById('matrixChart').getContext('2d');
                const companies = this.data.competitiveData.companies;
                
                if (this.charts.matrixChart) {
                    this.charts.matrixChart.destroy();
                }
                
                this.charts.matrixChart = new Chart(ctx, {
                    type: 'scatter',
                    data: {
                        datasets: [{
                            label: 'Competitors',
                            data: companies.map(c => ({
                                x: c.marketShare,
                                y: c.growth
                            })),
                            backgroundColor: [
                                'rgba(239, 68, 68, 0.8)',
                                'rgba(59, 130, 246, 0.8)',
                                'rgba(16, 185, 129, 0.8)'
                            ],
                            borderColor: [
                                'rgba(239, 68, 68, 1)',
                                'rgba(59, 130, 246, 1)',
                                'rgba(16, 185, 129, 1)'
                            ],
                            borderWidth: 2,
                            pointRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Market Share (%)'
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Growth Rate (%)'
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        }
                    }
                });
            }

            switchSegmentType(type) {
                this.currentSegmentType = type;
                
                // Update button states
                document.querySelectorAll('.segment-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-100', 'text-blue-800');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`segment${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.remove('bg-gray-100', 'text-gray-600');
                document.getElementById(`segment${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.add('bg-blue-100', 'text-blue-800');
                
                // Update chart
                this.createSegmentChart();
                
                // Update insights
                const currentData = this.data.segmentData[type];
                document.getElementById('leadingSegment').textContent = currentData.leadingSegment;
                document.getElementById('growthLeader').textContent = currentData.growthLeader;
            }

            switchGeographicType(type) {
                this.currentGeographicType = type;
                
                // Update button states
                document.querySelectorAll('.geo-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-100', 'text-blue-800');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`geo${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.remove('bg-gray-100', 'text-gray-600');
                document.getElementById(`geo${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.add('bg-blue-100', 'text-blue-800');
                
                // Update chart
                this.createGeographicChart();
                
                // Update insights
                const currentData = this.data.geographicData[type];
                document.getElementById('geographicInsights').textContent = currentData.insights;
            }

            switchCompetitiveView(view) {
                this.currentCompetitiveView = view;
                
                // Update button states
                document.querySelectorAll('.competitive-view').forEach(btn => {
                    btn.classList.remove('bg-blue-100', 'text-blue-800');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`competitive${view.charAt(0).toUpperCase() + view.slice(1)}`).classList.remove('bg-gray-100', 'text-gray-600');
                document.getElementById(`competitive${view.charAt(0).toUpperCase() + view.slice(1)}`).classList.add('bg-blue-100', 'text-blue-800');
                
                // Show/hide content
                document.querySelectorAll('.competitive-view-content').forEach(content => {
                    content.classList.add('hidden');
                });
                document.getElementById(`competitive${view.charAt(0).toUpperCase() + view.slice(1)}View`).classList.remove('hidden');
                
                // Initialize charts if needed
                if (view === 'chart') {
                    this.createCompetitiveChart();
                } else if (view === 'matrix') {
                    this.createMatrixChart();
                }
            }

            filterOpportunities(filter) {
                // Update button states
                document.querySelectorAll('.opportunity-filter').forEach(btn => {
                    btn.classList.remove('bg-blue-100', 'text-blue-800');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`opportunity${filter.charAt(0).toUpperCase() + filter.slice(1)}`).classList.remove('bg-gray-100', 'text-gray-600');
                document.getElementById(`opportunity${filter.charAt(0).toUpperCase() + filter.slice(1)}`).classList.add('bg-blue-100', 'text-blue-800');
                
                // Filter opportunity cards
                const cards = document.querySelectorAll('.opportunity-card');
                cards.forEach(card => {
                    const priority = card.getAttribute('data-priority');
                    if (filter === 'all' || priority === filter) {
                        card.style.display = 'block';
                        card.style.animation = 'fadeIn 0.3s ease-in-out';
                    } else {
                        card.style.display = 'none';
                    }
                });
                
                // Update opportunity counts
                this.updateOpportunityCounts();
            }

            updateOpportunityCounts() {
                const visibleCards = document.querySelectorAll('.opportunity-card[style*="block"], .opportunity-card:not([style*="none"])');
                const counts = { high: 0, medium: 0, low: 0 };
                let totalRevenue = 0;
                
                visibleCards.forEach(card => {
                    const priority = card.getAttribute('data-priority');
                    counts[priority]++;
                    
                    // Extract revenue from card (simplified for demo)
                    const revenueText = card.querySelector('.font-semibold').textContent;
                    const revenue = parseFloat(revenueText.replace(/[$,KM]/g, ''));
                    const multiplier = revenueText.includes('M') ? 1000000 : revenueText.includes('K') ? 1000 : 1;
                    totalRevenue += revenue * multiplier;
                });
                
                // Update counts
                document.getElementById('highOpportunityCount').textContent = counts.high;
                document.getElementById('mediumOpportunityCount').textContent = counts.medium;
                document.getElementById('lowOpportunityCount').textContent = counts.low;
                document.getElementById('totalPotential').textContent = this.formatCurrency(totalRevenue);
            }

            loadMarketData() {
                // Simulate loading market data
                this.showLoading();
                
                setTimeout(() => {
                    this.updateMarketMetrics();
                    this.hideLoading();
                }, 1500);
            }

            updateMarketMetrics() {
                // Update market size with animation
                this.animateValue('marketSize', 0, this.data.marketSize, 2000, (value) => {
                    document.getElementById('marketSize').textContent = this.formatCurrency(value);
                });

                // Update growth rate
                this.animateValue('growthRate', 0, this.data.growthRate, 1500, (value) => {
                    document.getElementById('growthRate').textContent = value.toFixed(1) + '%';
                });

                // Update market share
                this.animateValue('marketShare', 0, this.data.marketShare, 1800, (value) => {
                    document.getElementById('marketShare').textContent = value.toFixed(1) + '%';
                });

                // Update competition index
                this.animateValue('competitionIndex', 0, this.data.competitionIndex, 1600, (value) => {
                    document.getElementById('competitionIndex').textContent = value.toFixed(1);
                });
            }

            animateValue(elementId, start, end, duration, callback) {
                const startTimestamp = performance.now();
                const step = (timestamp) => {
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    const value = start + (end - start) * this.easeOutQuart(progress);
                    callback(value);
                    if (progress < 1) {
                        requestAnimationFrame(step);
                    }
                };
                requestAnimationFrame(step);
            }

            easeOutQuart(t) {
                return 1 - Math.pow(1 - t, 4);
            }

            formatCurrency(value) {
                if (value >= 1e12) {
                    return '$' + (value / 1e12).toFixed(1) + 'T';
                } else if (value >= 1e9) {
                    return '$' + (value / 1e9).toFixed(1) + 'B';
                } else if (value >= 1e6) {
                    return '$' + (value / 1e6).toFixed(1) + 'M';
                } else if (value >= 1e3) {
                    return '$' + (value / 1e3).toFixed(1) + 'K';
                }
                return '$' + value.toFixed(0);
            }

            refreshData() {
                this.loadMarketData();
            }

            exportReport() {
                // Simulate report export
                const link = document.createElement('a');
                link.href = 'data:text/plain;charset=utf-8,Market Analysis Report - Generated on ' + new Date().toLocaleDateString();
                link.download = 'market-analysis-report.txt';
                link.click();
            }

            showHelp() {
                alert('Market Analysis Dashboard Help:\n\n' +
                      '• Market Size: Total addressable market value\n' +
                      '• Growth Rate: Year-over-year market growth\n' +
                      '• Market Share: Your company\'s market position\n' +
                      '• Competition Index: Market competitiveness score\n\n' +
                      'Use the charts to analyze trends and benchmark performance.');
            }

            showLoading() {
                document.getElementById('loadingOverlay').classList.remove('hidden');
            }

            hideLoading() {
                document.getElementById('loadingOverlay').classList.add('hidden');
            }

            setupProgressiveDisclosure() {
                const elements = document.querySelectorAll('.progressive-disclosure');
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                        }
                    });
                }, { threshold: 0.1 });

                elements.forEach(element => {
                    observer.observe(element);
                });
            }
        }

        // Initialize dashboard when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new MarketAnalysisDashboard();
        });
    </script>
</body>
</html>
